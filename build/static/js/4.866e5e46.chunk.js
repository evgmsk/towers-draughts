(this["webpackJsonptowers-draughts-client"]=this["webpackJsonptowers-draughts-client"]||[]).push([[4],{91:function(e,t,a){},92:function(e,t,a){},93:function(e,t,a){},94:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t),a.d(t,"PlayerGameBarComponent",(function(){return je}));var n=a(23),o=a(28),i=a(30),r=a(29),s=a(20),c=a(84),l=a(3),m=a.n(l),u=a(31),d=a(79),p=a(0),b=a(6),j=a(76),g=a(9),v=a(7),h=a(19),O=a(42),f=a(81),y=a(83),x=a(78),w={turn:x.a,endGame:j.e,updateIneffectiveMoves:j.j,surrender:j.i},M=Object(u.b)((function(e){return{currentPosition:e.board.currentPosition,engineColor:Object(g.j)(e.game.playerColor),white:e.game.white,black:e.game.black,dificulty:e.gameOptions.rivalLevel,timeToGame:e.gameOptions.timing.timeToGame,time:e.game.playerColor===b.b.w?e.clock.blackClock.timeToGame:e.clock.whiteClock.timeToGame,gameVariant:e.gameOptions.gameVariant,moveOrder:e.game.moveOrder,movesHistory:e.game.history,gameMode:e.game.gameMode}}),w)(function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(n.a)(this,a);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).maxDepth=6,e.getSeekerProps=function(){return{bestMoveCB:e.getMoveCB,maxDepth:e.maxDepth,engineColor:e.props.engineColor,evaluationStarted:!0,game:!0}},e.setMaxDeep=function(t){e.maxDepth=t},e.getMoveCB=function(t){var a=e.props,n=a.surrender,o=a.endGame,i=a.engineColor,r=a.gameMode;"surrender"===t.move?n(i):t.move?t&&"isPlaying"===r&&e.compleateMove(t):o("noMoves")},e.passProps=function(){return{history:e.props.movesHistory,currentPosition:e.props.currentPosition,engineMove:e.props.moveOrder.pieceOrder===e.props.engineColor}},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){console.log("created",this.props)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.moveOrder,o=a.movesHistory,i=a.currentPosition,r=a.gameMode,s=a.engineColor;if("isPlaying"===r&&"isPlaying"!==e.gameMode){console.log("new game",this.props,y.a.evaluationStarted);var c=n.pieceOrder===s;if(y.a.resetProps(this.getSeekerProps()),c){var l={history:o,cP:i};setTimeout((function(){return y.a.setActualMovesBranchAfterMove(l)}),v.a)}}if(n.pieceOrder===s&&e.movesHistory.length!==o.length)if(n.pieceOrder===s){if(console.log("start engine",this.props),"isPlaying"===this.props.gameMode){var m={history:o,cP:i};y.a.setActualMovesBranchAfterMove(m)}}else console.log("stop engine",this.props),y.a.startEvaluation(!1)}},{key:"compleateMove",value:function(e){var t=this.props,a=t.moveOrder,n=t.turn,o=t.white,i=t.black,r=t.currentPosition,s=O.a.getNewOrder({moveOrder:a,white:o,black:i});if(e.move.includes(":")){var c=O.a.getCapturedTowers(e.move.split(":"),r);n({moveToSave:Object(p.a)(Object(p.a)({},e),{},{takenPieces:c}),moveOrder:s})}else n({moveToSave:e,moveOrder:s})}},{key:"render",value:function(){return null}}]),a}(m.a.Component)),k=a(82),C=a(47),N=a(4),T={endGame:j.e,turn:x.a,updateIneffectiveMoves:j.j,updateBoardState:x.c,finishGameSetup:C.c},P=Object(u.b)((function(e){return{gameOptions:e.gameOptions,game:e.game,name:e.user.name,positionsTree:e.board.positionsTree,windowSize:e.app.windowSize,board:e.board,boardOptions:e.boardOptions}}),T)(function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(){var e;Object(n.a)(this,a);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).boardRef=m.a.createRef(),e.makePremoveAction=function(t){var a=e.props,n=a.game.moveOrder.pieceOrder,o=a.endGame,i=a.updateBoardState,r=a.board.currentPosition,s=O.a.lookForMandatoryMoves(n,r);if(!s.length&&!O.a.lookForAllPosibleMoves(n,r).length)return console.log("no moves",e.props),setTimeout((function(){return o("noMoves")}),v.a);i({mandatoryMoves:s,mandatoryMoveStep:0,mouseDown:!1,moveDone:!1})},e.makePlayerMandatoryMoveStep=function(t){var a=e.props.board,n=a.mandatoryMoves,o=a.mandatoryMoveStep,i=a.towerTouched,r=e.props,s=r.game,c=r.turn,l=r.board,m=r.updateBoardState,u=r.gameOptions.gameVariant,d=i.key,p=n.filter((function(e){return e.move.includes("".concat(d,":").concat(t))}));if(p[0].move.split(":").length===2+o){var b={moveToSave:p[0],moveOrder:O.a.getNewOrder(s)},j=p[0].takenPieces,g="towers"===u?[j[o]]:j,v=h.a.updateTowersOnMandatoryMoveStep(d,t,l,g,!0);console.log("towers;",v),m({mandatoryMoves:[],mandatoryMoveStep:0,towerTouched:null,towers:v,lastMoveSquares:b.moveToSave.move.split(":"),currentPosition:b.moveToSave.position,mouseDown:!1,moveDone:!0}),c(b)}else{var f=p[0].takenPieces[o];m({mandatoryMoves:p,mandatoryMoveStep:o+1,towerTouched:null,towers:h.a.updateTowersOnMandatoryMoveStep(d,t,l,[f]),lastMoveSquares:p[0].move.slice(o+1).split(":"),mouseDown:!1})}},e.handleMouseUp=function(t){var a=e.props.board,n=a.towerTouched,o=a.cellSize,i=a.moveDone,r=a.mandatoryMoves,s=a.currentPosition,c=e.props,l=c.board,m=c.game,u=m.moveOrder,d=m.white,b=m.black,j=c.turn;if(n&&!i){var v=e.props.boardOptions.reversedBoard,f="touchend"===t.type?t.changedTouches[0]:t,y=f.clientX,x=f.clientY,w=Object(g.b)({x:y,y:x},n.posibleMoves,o,e.boardRef),M=Object(p.a)(Object(p.a)({},l),{},{reversed:v});if(w){var k=n.key;if(null===r||void 0===r?void 0:r.length)e.makePlayerMandatoryMoveStep(w);else{h.a.finalizeSimpleMove(k,w,l,v);var C={moveOrder:u,white:d,black:b,currentPosition:s};j(O.a.getPropsToMakeFreeMove(k,w,C))}}else h.a.cancelTowerTransition(M)}},e.handleMouseMove=function(t){var a=e.props,n=a.board,o=n.towerTouched,i=n.moveDone,r=n.mouseDown,s=a.updateBoardState;if(o&&!i&&r){var c=o.key,l=o.startCursorPosition,m=o.startTowerPosition,u="touchmove"===t.type?t.changedTouches[0]:t,d=u.clientX,p=u.clientY,b=Object(g.e)(e.props.board.towers),j=b.get(c),v={x:m.x+d-l.x,y:m.y+p-l.y},h=j.positionInDOM;j.positionInDOM=v,Math.abs(h.x-v.x)+Math.abs(h.y-v.y)>=6&&(b.set(c,j),s({towers:b}))}},e.handleMouseDown=function(t){var a=e.props,n=a.game.moveOrder.pieceOrder,o=a.board,i=a.updateBoardState,r=o.mandatoryMoves,s=o.cellsMap,c=o.towers,l=o.currentPosition,m="touchstart"===t.type?t.changedTouches[0]:t,u=m.target,d=m.clientX,p=m.clientY,j=u.classList;if(j.contains("checker-tower")&&j.contains(n)){var v,h=u.getAttribute("data-indexes"),f=c.get(h);if(console.log(f),f){if((v=(null===r||void 0===r?void 0:r.length)?Object(g.k)(e.props.board,h):f.currentType===b.d.m?O.a.manTowerFreeMoves(f,l,s):O.a.kingTowerFreeMoves(h,l,s)).size)i({towerTouched:{key:h,posibleMoves:v,startCursorPosition:{x:d,y:p},startTowerPosition:f.positionInDOM,towerColor:f.currentColor,towerType:f.currentType},mouseDown:!0})}else console.error(h,o)}},e.modeRestrictions=function(){var t=e.props,a=t.game,n=a.moveOrder.playerTurn,o=a.gameMode,i=t.name,r=t.board,s=r.moveDone,c=r.animationStarted;return"isPlaying"!==o||(n!==i||s||c)},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){if(window){var e=this.props,t=e.game.history,a=e.board,n=e.boardOptions,o=e.updateBoardState;if(console.log("created with state:",this.props.board),h.a.setCalBack(o),t.length){var i=h.a.updateTowersToBoard(a.currentPosition),r=Object(p.a)(Object(p.a)({},a),{},{towers:i});h.a.updateCellsPosition(r,n,this.boardRef.current)}else h.a.updateCellsPosition(a,n,this.boardRef.current)}}},{key:"componentWillUnmount",value:function(){}},{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(e)!==JSON.stringify(this.props)||Object(g.c)(e.board.towers,this.props.board.towers)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.game,n=a.history,o=a.gameMode,i=a.moveOrder.pieceOrder,r=a.playerColor,s=t.board,c=t.windowSize,l=t.boardOptions,m=n.length;e.game.history.length!==m&&i===r&&(console.log("updated",this.props.board,this.props.game),this.makePremoveAction(n[n.length-1])),"isPlaying"!==e.game.gameMode&&"isPlaying"===o&&(console.log("new game started",this.props),h.a.updateCellsPosition(s,l,this.boardRef.current)),JSON.stringify(c)!==JSON.stringify(e.windowSize)&&h.a.updateCellsPosition(s,l,this.boardRef.current)}},{key:"render",value:function(){var e=this.props.board,t=e.towers,a=e.towerTouched,n=e.mandatoryMoves,o=e.mandatoryMoveStep,i=e.lastMoveSquares,r=this.props,s=r.boardOptions,c=r.game.gameMode,m={boardOptions:s,posibleMoves:null===a||void 0===a?void 0:a.posibleMoves,lastMove:i},u=(n||[]).map((function(e){return e.move.split(":")[o||0]})),d=s.boardSize,b=s.boardTheme,j="board__wrapper ".concat(b," h").concat(d,"v").concat(d),g=Array.from(t.values()).map((function(e,t){var a="isPlaying"===c&&u.includes(e.onBoardPosition);return Object(l.createElement)(f.a,Object(p.a)(Object(p.a)({},e),{},{key:e.onBoardPosition,mandatory:a}))}));return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("section",{onMouseMove:this.handleMouseMove,onMouseUp:this.handleMouseUp,onMouseDown:this.handleMouseDown,onTouchStart:this.handleMouseDown,onTouchMove:this.handleMouseMove,onTouchEnd:this.handleMouseUp,className:j,ref:this.boardRef,children:[g,Object(N.jsx)(k.a,Object(p.a)({},m))]}),"PC"===this.props.gameOptions.rivalType&&Object(N.jsx)(M,{})]})}}]),a}(m.a.Component)),S=a(38),G=a(34),_=(a(91),{setGameType:C.e}),D=Object(u.b)((function(e){return{language:e.user.language,gameType:e.gameOptions.gameType}}),_)((function(e){var t=e.setGameType,a=e.gameType,n=function(e){return"opponent-variant__b ".concat(a===e?"actual":"")},o=function(e){switch(e){case"ranked":return"ranked game";case"casual":return"casual game";case"tournament":return"Service is not available for now";default:return""}};return Object(N.jsxs)("div",{className:"opponent-variant",onClick:function(e){e.preventDefault();var a=e.target;t(a.value)},children:[Object(N.jsx)("button",{title:o("ranked"),className:n("ranked"),type:"button",value:"ranked",children:"Ranked"}),Object(N.jsx)("button",{title:o("tournament"),className:n("tournament"),type:"button",value:"tournament",children:"Tournament"}),Object(N.jsx)("button",{title:o("casual"),className:n("casual"),type:"button",value:"casual",children:"Casual"})]})})),R={setTiming:C.j},B=Object(u.b)((function(e){return{timing:e.gameOptions.timing}}),R)((function(e){var t=e.timing,a=t.timeToGame,n=t.adds,o=e.setTiming;return Object(N.jsx)("div",{className:"timing-wrapper",onClick:function(e){e.preventDefault();var t=e.target.value.split(":").map((function(e){return parseInt(e)}));o({timeToGame:t[0],adds:t[1]})},children:v.k.map((function(e,t){var o=e[0]===a&&e[1]===n?"timing-menu-item actual":"timing-menu-item";return Object(N.jsx)("button",{title:"time limit: minuts / add per move: seconds",className:o,type:"button",value:e.join(":"),children:"".concat(e[0]," / ").concat(e[1])},t)}))})})),z={setRivalLevel:C.i},L=Object(u.b)((function(e){return{level:e.gameOptions.rivalLevel}}),z)((function(e){var t=e.level,a=e.setRivalLevel;return Object(N.jsx)("div",{className:"level-wrapper",children:[1,2,3,4,5,6,7,8,9].map((function(e){var n=t===e?"level-menu-item actual":"level-menu-item";return Object(N.jsx)("button",{onClick:function(){return a(e)},title:"Choose engine level",className:n,type:"button",value:e,children:e},e)}))})})),F={setGameVariant:C.f},A=Object(u.b)((function(e){return{gv:e.gameOptions.gameVariant}}),F)((function(e){var t=e.gv,a=e.setGameVariant;return Object(N.jsxs)("select",{title:"select game",className:"game-variant",name:"gameVariant",defaultValue:t,onChange:function(e){e.preventDefault();var t=e.target;a(t.value)},children:[Object(N.jsx)("option",{value:"towers",children:"Play Towers"}),Object(N.jsx)("option",{value:"international",children:"Play Internstional"}),Object(N.jsx)("option",{value:"russian",children:"Play Russian"})]})})),U={setPlayerColor:C.h},V=Object(u.b)((function(e){return{color:e.gameOptions.playerColor}}),U),I={setOpponentType:C.g,setGameType:C.e},J=Object(u.b)((function(e){return{rivalType:e.gameOptions.rivalType,gameType:e.gameOptions.gameType}}),I)((function(e){var t=e.rivalType,a=e.setOpponentType,n=e.gameType,o=e.setGameType;return Object(N.jsxs)("select",{title:"select opponent type",className:"rival-type",name:"rivalType",defaultValue:t,onChange:function(e){e.preventDefault();var t=e.target;a(t.value),"PC"===t.value&&"ranked"===n&&o("casual")},children:[Object(N.jsx)("option",{value:"player",children:"VS Player"}),Object(N.jsx)("option",{value:"PC",children:"VS Computer"})]})})),W={setTiming:C.j},q=Object(u.b)((function(e){return{timeToGame:e.gameOptions.timing.timeToGame,adds:e.gameOptions.timing.adds}}),W),H=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(e){var o;return Object(n.a)(this,a),(o=t.call(this,e)).handleClick=function(e){e.preventDefault();var t=e.target;t.classList.contains("time-range")||(t.classList.contains("custom-timing__values")&&o.state.open&&o.setState({open:!1}),t.classList.contains("custom-timing")&&o.setState({open:!o.state.open}))},o.handleChange=function(e){e.preventDefault();var t=e.target;console.log(t.value),"lim"===t.name&&o.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{limit:parseInt(t.value)})})),"adds"===t.name&&o.setState({adds:parseInt(t.value)})},o.handleBlur=function(e){var t=o.state,a=t.limit,n=t.adds;e.preventDefault(),o.props.setTiming({timeToGame:a,adds:n})},o.state={limit:e.timeToGame,adds:e.adds,open:!1},o}return Object(o.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.timeToGame,n=t.adds,o=v.k.map((function(e){return e.join("/")})).includes("".concat(a,"/").concat(n));a===e.timeToGame&&n===e.adds||(this.state.open||o?this.state.open&&o&&this.setState({open:!1}):this.setState({open:!0}),this.setState({limit:a,adds:n}))}},{key:"render",value:function(){var e=this.state,t=e.open,a=e.limit,n=e.adds;return Object(N.jsxs)("div",{className:"custom-timing ".concat(t?"open":"close"),onClick:this.handleClick,children:[Object(N.jsx)("p",{className:"custom-preset-label",children:Object(N.jsx)("span",{children:"Custom Timing"})}),Object(N.jsxs)("div",{className:"custom-timing__menu",children:[Object(N.jsx)("input",{onBlur:this.handleBlur,onChange:this.handleChange,className:"time-range",name:"lim",type:"range",min:"0",step:"1",max:"60",value:a}),Object(N.jsx)("div",{className:"custom-timing__values",children:" ".concat(a," / ").concat(n," ")}),Object(N.jsx)("input",{onBlur:this.handleBlur,onChange:this.handleChange,className:"time-range",name:"adds",type:"range",min:"0",step:"1",max:"60",value:n})]})]})}}]),a}(m.a.Component),E=V((function(e){var t=e.color,a=e.setPlayerColor;return Object(N.jsxs)("div",{className:"select-color-wrapper",onClick:function(e){e.preventDefault();var t=e.target;t.classList.contains("select-color")&&a(t.value)},children:[Object(N.jsx)("button",{title:"play white pieces",className:"select-color".concat(t===b.b.w?" active":""),type:"button",value:b.b.w}),Object(N.jsx)("button",{title:"play random color pieces",className:"select-color".concat("random"===t?" active":""),type:"button",value:"random"}),Object(N.jsx)("button",{title:"play black pieces",className:"select-color".concat(t===b.b.b?" active":""),type:"button",value:b.b.b})]})})),Y=q(H),X={setTiming:C.j,setPlayerColor:C.h,findRival:C.b},K=Object(u.b)((function(e){return{waitingRival:e.gameOptions.waitingRival,language:e.user.language,rivalType:e.gameOptions.rivalType}}),X)((function(e){var t=e.waitingRival,a=e.findRival,n=e.language,o=e.rivalType,i=G.a[n.slice(0,2)],r="preset-game".concat(t?" hidden":"");return Object(N.jsxs)("div",{className:r,children:[Object(N.jsx)("button",{className:"new-game",type:"button",value:"new_game",onClick:a,children:i.newGame}),Object(N.jsx)(D,{}),Object(N.jsxs)("div",{className:"game-type-wrapper",children:[Object(N.jsx)(A,{}),Object(N.jsx)(J,{})]}),"PC"!==o?Object(N.jsx)(B,{}):Object(N.jsx)(L,{}),Object(N.jsx)(Y,{}),Object(N.jsx)(E,{})]})})),Q=function(e){var t=Object(u.c)((function(t){return{clock:t.clock["".concat(e.timeOf,"Clock")],gameConfirmed:t.game.gameConfirmed,pcGame:"PC"===t.gameOptions.rivalType}})),a=t.clock,n=a.timeToFirstMove,o=a.timeToGame,i=t.gameConfirmed,r=t.pcGame,c=Object(l.useState)({min:"",sec:""}),m=Object(s.a)(c,2),d=m[0],p=m[1],b="".concat(e.timeOf,"-time");return Object(l.useEffect)((function(){p(function(e){var t=Math.floor(e/60).toString(),a=(e%60).toString();return a=a.length<2?"0".concat(a):a,{min:t=t.length<2?"0".concat(t):t,sec:a}}(i?o:n))}),[i,n,o]),r?null:Object(N.jsx)("div",{className:"game-clock",children:Object(N.jsx)("div",{className:b,children:"".concat(d.min,": ").concat(d.sec)})})},Z=(a(92),{cancelRivalWaiting:C.a}),$=Object(u.b)((function(e){return{waitingRival:e.gameOptions.waitingRival}}),Z)((function(e){return e.waitingRival?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"waiting-rival-spinner",onClick:function(){return e.cancelRivalWaiting()},children:[Object(N.jsx)("div",{title:"cancel",className:"logo"}),Object(N.jsx)("span",{className:"material-icons",children:"cancel"})]}),Object(N.jsx)(ee,{}),Object(N.jsx)("div",{className:"waiting-rival-back"})]}):null})),ee=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(e){var o;return Object(n.a)(this,a),(o=t.call(this,e)).interval=void 0,o.state={timer:0},o}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval((function(){return e.setState((function(e){return Object(p.a)(Object(p.a)({},e),{},{timer:e.timer+1})}))}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return Object(N.jsxs)("div",{className:"waiting-rival-timer",children:["waiting time: ",this.state.timer]})}}]),a}(m.a.Component),te=a(77),ae=(a(93),a(18)),ne={requestRematch:C.d,findRival:C.b,finishGameSetup:C.c,analyzeLastGame:te.a,setGameMode:j.h},oe=Object(u.b)((function(e){return{gameResult:e.analyze.gameResult,gameOver:"isOver"===e.game.gameMode}}),ne)((function(e){var t,a=e.requestRematch,n=e.findRival,o=e.gameOver,i=e.gameResult,r=i.reason,s=i.winner,c=i.movesHistory,l=e.gameResult.playerColor,m=e.finishGameSetup,u=e.analyzeLastGame,d=e.setGameMode,p=Object(ae.f)(),b=s&&s===l,j=!(r&&r.startsWith("abandon")&&r.includes(l));t=s?"draw"===s?"Draw":"You ".concat(b?"win":"lose"):"Game canceled";var g=Object(N.jsxs)("section",{className:"game-end-popup",children:[Object(N.jsxs)("header",{className:"popup-header ".concat(b?"win-bg":"lose-bg"),children:[Object(N.jsx)("h4",{className:"popup-title",children:t}),Object(N.jsx)("span",{className:"material-icons",onClick:function(){return d("isPreparing")},children:"cancel"})]}),Object(N.jsx)("div",{className:"popup-body"}),Object(N.jsxs)("div",{className:"popup-footer ".concat(b?"win-bg":"lose-bg"),onClick:function(e){d("isPreparing");var t=e.target.classList,o=function(e){return t.contains(e)};o("rematch")?a():o("new-rival")?n():o("game-options")?m(!1):o("analyze-game")&&(u(!0),p.push("/analysis"))},children:[Object(N.jsx)("button",{className:"popup-button rematch",type:"button",children:"rematch"}),Object(N.jsx)("button",{className:"popup-button new-rival",type:"button",children:"new"}),Object(N.jsx)("button",{className:"popup-button game-options",type:"button",children:"options"}),c?Object(N.jsx)("button",{className:"popup-button analyze-game",type:"button",children:"analyze"}):null]})]});return Object(N.jsx)(N.Fragment,{children:o&&j?g:null})})),ie=a(80),re=a(48),se=(a(17),{w:"white",b:"black"});var ce={endGame:j.e,declineDraw:j.d,offerDraw:j.g,cancelGame:j.a,confirmStartGame:j.c,findRival:C.b,finishGameSetup:C.c,setGameMode:j.h,surrender:j.i,undoLastMove:x.b,analyzeLastGame:te.a},le=Object(u.b)((function(e){return{drawOffered:e.game.rivalOfferedDraw,gameConfirmed:e.game.gameConfirmed,playerColor:e.game.playerColor,gameMode:e.game.gameMode,pcGame:"PC"===e.gameOptions.rivalType,historyLength:e.game.history.length>2}}),ce)((function(e){var t=Object(ae.f)(),a=e.surrender,n=e.endGame,o=e.declineDraw,i=e.drawOffered,r=e.offerDraw,s=e.gameConfirmed,c=e.gameMode,l=e.findRival,m=e.finishGameSetup,u=e.setGameMode,d=e.cancelGame,p=e.playerColor,b=e.pcGame,j=e.undoLastMove,g=e.historyLength,v=e.analyzeLastGame,h=p===se.w?"abandonedByWhite":"abandonedByBlack",O=function(e){"isPlaying"===c&&(n(h),u("isAnalyzing")),v(!0),t.push("/analysis")},f=g?"game-menu__item":"game-menu__item hide-undo";return b&&s?Object(N.jsxs)("ul",{className:"game-menu",children:[Object(N.jsx)("li",{title:"undo move",className:f,role:"button",onClick:function(){g&&j()},children:Object(N.jsx)("i",{className:"material-icons",children:"history"})}),Object(N.jsx)("li",{title:"new game",role:"button",className:"game-menu__item",onClick:function(){"isPlaying"===c&&n(h),l()},children:Object(N.jsx)(re.a,{size:13})}),Object(N.jsx)("li",{title:"game options",role:"button",className:"game-menu__item",onClick:function(){"isPlaying"===c&&n(h),m(!1)},children:Object(N.jsx)("i",{className:"material-icons",children:"settings_applications"})}),Object(N.jsx)("li",{title:"analize game",role:"button",className:"game-menu__item",onClick:O,children:Object(N.jsx)("i",{className:"material-icons",children:"zoom_in"})})]}):"isPlaying"!==c||s?"isPlaying"!==c?Object(N.jsxs)("ul",{className:"game-menu",children:[Object(N.jsx)("li",{title:"new game",role:"button",className:"game-menu__item",onClick:l,children:Object(N.jsx)(re.a,{size:13})}),Object(N.jsx)("li",{title:"game options",role:"button",className:"game-menu__item",onClick:function(){return m(!1)},children:Object(N.jsx)("i",{className:"material-icons",children:"settings_applications"})}),Object(N.jsx)("li",{title:"analize game",role:"button",className:"game-menu__item",onClick:O,children:Object(N.jsx)("i",{className:"material-icons",children:"zoom_in"})})]}):Object(N.jsx)("ul",{className:"game-menu",children:i?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("li",{role:"button",title:"accept draw",className:"game-menu__item",onClick:function(){return n("drawByAgreement")},children:Object(N.jsx)("i",{className:"material-icons",children:"thumb_up"})}),Object(N.jsx)("li",{role:"button",title:"decline draw",className:"game-menu__item",onClick:function(){return o(!1)},children:Object(N.jsx)("i",{className:"material-icons",children:"thumb_down"})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("li",{title:"resign",role:"button",className:"game-menu__item",onClick:function(){return a(p)},children:Object(N.jsx)("i",{className:"material-icons",children:"flag"})}),Object(N.jsx)("li",{title:"offer draw",role:"button",className:"game-menu__item",onClick:function(e){e.preventDefault(),r()},children:Object(N.jsx)("i",{className:"offer_draw",children:"1/2"})})]})}):Object(N.jsx)("ul",{className:"game-menu",children:Object(N.jsx)("li",{title:"cancel game",className:"game-menu__item",role:"button",onClick:function(e){d()},children:Object(N.jsx)("i",{className:"material-icons",children:"close"})})})})),me=function(e){var t=e.color,a=Object(u.c)((function(e){return e.game[t]})),n=a.onlineStatus,o=a.name,i=a.rating,r="PC"===Object(u.c)((function(e){return e.gameOptions.rivalType})),s="".concat(t[0].toUpperCase()).concat(t.substring(1));return Object(N.jsxs)("div",{className:"player-info",children:[Object(N.jsx)("h3",{children:s}),!r&&Object(N.jsx)("span",{className:"player-status",children:n}),Object(N.jsx)("h4",{className:"player-name",children:o}),!r&&Object(N.jsx)("span",{className:"palyer-raiting",children:i})]})},ue=Object(u.b)((function(e){return{gv:e.gameOptions.gameVariant,white:e.game.white,black:e.game.black,gt:e.gameOptions.gameType,ot:e.gameOptions.rivalType,ti:e.gameOptions.timing}}),{})((function(e){var t=e.gv,a=e.gt,n=e.ot,o=e.ti,i="PC"===n,r=i?"casual":a,s=i?"":"".concat(o.timeToGame," / ").concat(o.adds),c="".concat(t[0].toUpperCase()).concat(t.substring(1));return Object(N.jsxs)("div",{className:"game-info",children:[Object(N.jsxs)("h2",{className:"game-info_header",children:[c,"\xa0 draughts"]}),Object(N.jsxs)("p",{className:"game-info_type",children:[r,"\xa0",s]}),Object(N.jsx)(me,{color:b.b.w}),Object(N.jsx)(me,{color:b.b.b})]})})),de=(a(94),["children"]),pe=["children"],be={endGame:j.e,declineDraw:j.d},je=Object(u.b)((function(e){return{name:e.game.playerColor===b.b.b?e.game.black.name:e.game.white.name}}),be)((function(e){var t=e.children,a=Object(c.a)(e,de);return Object(N.jsxs)("div",{className:"player-game-bar",children:[t,Object(N.jsx)("h2",{children:a.name}),Object(N.jsx)(le,{})]})})),ge=Object(u.b)((function(e){return{name:e.game.playerColor!==b.b.b?e.game.black.name:e.game.white.name}}),{})((function(e){var t=e.children,a=Object(c.a)(e,pe),n=Object(l.useState)(a.name),o=Object(s.a)(n,1)[0];return Object(N.jsxs)("div",{className:"opponent-game-bar",children:[t,Object(N.jsx)("h2",{children:o})]})})),ve=Object(u.b)((function(e){return{playerColor:e.game.playerColor,gameSetupFinished:e.gameOptions.gameSetupFinished,portrait:e.app.portrait}}),{}),he=function(e){Object(i.a)(a,e);var t=Object(r.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(e)!==JSON.stringify(this.props)}},{key:"render",value:function(){var e=this.props,t=e.portrait,a=e.playerColor,n=e.gameSetupFinished,o=Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("main",{className:"portrait",children:[t?Object(N.jsx)(ge,{children:Object(N.jsx)(Q,{timeOf:Object(g.j)(a)})}):null,Object(N.jsx)(P,{}),t?Object(N.jsx)(je,{children:Object(N.jsx)(Q,{timeOf:a})}):null]}),t?Object(N.jsxs)("div",{className:"bars-wrapper",children:[Object(N.jsx)(d.a,{side:"left",children:Object(N.jsx)(ue,{})}),Object(N.jsx)(d.a,{side:"right",children:Object(N.jsx)(ie.a,{})})]}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(d.a,{side:"left",children:Object(N.jsx)(ue,{})}),Object(N.jsxs)(d.a,{side:"right",children:[Object(N.jsx)(ge,{children:Object(N.jsx)(Q,{timeOf:Object(g.j)(a)})}),Object(N.jsx)(ie.a,{}),Object(N.jsx)(je,{children:Object(N.jsx)(Q,{timeOf:a})})]})]})]});return Object(N.jsx)(l.Suspense,{fallback:Object(N.jsx)(S.a,{}),children:Object(N.jsxs)("div",{className:"game page noselect",children:[n?o:Object(N.jsx)(K,{}),Object(N.jsx)($,{}),Object(N.jsx)(oe,{})]})})}}]),a}(m.a.Component);t.default=ve(he)}}]);
//# sourceMappingURL=4.866e5e46.chunk.js.map