(this["webpackJsonptowers-draughts-client"]=this["webpackJsonptowers-draughts-client"]||[]).push([[0],{78:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"g",(function(){return d}));var a=n(10);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:a.a.CLEAR_HISTORY,payload:e}}function o(e){return{type:a.a.SURRENDER,payload:e}}function i(e){return{type:a.a.SET_GAME_MODE,payload:e}}function s(e){return{type:a.a.CONFIRM_START_GAME,payload:e}}function c(e){return{type:a.a.INEFFECTIVE_MOVE,payload:e}}function l(e){return{type:a.a.END_GAME,payload:e}}function u(e){return{type:a.a.MAKE_MOVE,payload:e}}function v(){return{type:a.a.CANCEL_GAME}}function h(e){return{type:a.a.DECLINE_DRAW,payload:e}}function d(){return{type:a.a.OFFER_DRAW}}},79:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"m",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return g}));var a=n(11);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:a.a.SET_START_POSITION,payload:e}}function o(e){return{type:a.a.MAKE_NEW_MOVE,payload:e}}function i(e){return{type:a.a.UPDATE_ANALYSIS_STATE,payload:e}}function s(e){return{type:a.a.EVALUATE_POSITION,paylaod:e}}function c(e){return{type:a.a.SET_DEPTH,paylaod:e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:a.a.STEP_FORWARD,payload:e}}function u(e){return{type:a.a.REMOVE_PIECE,payload:e}}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return{type:a.a.STEP_BACK,payload:e}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:a.a.PLAY_MOVES,payload:e}}function d(e){return{type:a.a.GO_TO_POSITION,payload:e}}function m(e){return{type:a.a.DOWNLOAD_GAME,payload:e}}function f(e){return{type:a.a.ANALYZE_LAST_GAME,payload:e}}function g(e){return{type:a.a.SETTING_BOARD,payload:e}}},80:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(14);function r(e){return{type:a.a.UPDATE_BOARD_STATE,payload:e}}function o(e){return{type:a.a.TURN,payload:e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:a.a.UNDO_LAST_MOVE,payload:e}}},81:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(3),r=n.n(a),o=n(29),i=n(18),s=n(9),c=n(79),l=(n(87),n(4)),u={analyzeLastGame:c.a,stepBack:c.k,stepForward:c.l,goToPosition:c.d,playMoves:c.f},v=Object(o.b)((function(e){return{movesHistory:e.game.history,gameMode:e.game.gameMode,movesMainLine:e.analyze.movesMainLine,lastMove:e.analyze.lastMove,analyzingLastGame:e.analyze.analyzeLastGame}}),u),h=r.a.memo(v((function(e){var t=r.a.createRef(),n=e.movesHistory,o=e.gameMode,c=e.lastMove,u=e.movesMainLine,v=e.analyzeLastGame,h=e.analyzingLastGame,d=e.stepBack,m=e.stepForward,f=e.goToPosition,g=e.playMoves;Object(a.useEffect)((function(){!function(){var e=t.current;e&&e.scroll(0,e.scrollHeight)}()}),[n,t]);var b=Object(i.f)(),p="isPlaying"===o?n:u,y=null===p||void 0===p?void 0:p.length,j=Object(s.d)(p),w=function(e,t){e.preventDefault(),"isPlaying"!==o&&("/game"===b.location.pathname&&b.push("/analysis"),f({index:t,move:p[t]}))},M=c.index,O="moves-history-menu__item to-start".concat(M<0?" disabled":""),T="moves-history-menu__item step-back".concat(M?"":" disabled"),B="moves-history-menu__item step-forward".concat(M>=y-1?" disabled":""),P="moves-history-menu__item to-end".concat(M>=y-1?" disabled":"");return Object(l.jsxs)("div",{className:"moves-history-wrapper",children:[Object(l.jsx)("div",{className:"moves-history-menu",children:"isPlaying"!==o&&h?Object(l.jsxs)("ul",{onClick:function(e){e.preventDefault();var t=e.target.classList;if(!t.contains("disabled"))switch("/game"===b.location.pathname&&b.push("/analysis"),h||v(!0),!0){case t.contains("to-start"):f({index:-1,move:""});break;case t.contains("step-back"):return d();case t.contains("step-forward"):return m();case t.contains("to-end"):return f({index:y-1,move:p.slice(-1)[0]});case t.contains("play-moves"):return g()}},children:[Object(l.jsx)("li",{className:O,children:Object(l.jsx)("i",{className:"material-icons",children:"first_page"})}),Object(l.jsx)("li",{className:T,children:Object(l.jsx)("i",{className:"material-icons",children:"chevron_left"})}),Object(l.jsx)("li",{className:"moves-history-menu__item play-moves",children:Object(l.jsx)("i",{className:"material-icons",children:"slideshow"})}),Object(l.jsx)("li",{className:B,children:Object(l.jsx)("i",{className:"material-icons",children:"chevron_right"})}),Object(l.jsx)("li",{className:P,children:Object(l.jsx)("i",{className:"material-icons",children:"last_page"})})]}):Object(l.jsx)("p",{children:"moves:"})}),Object(l.jsx)("div",{className:"moves-container",ref:t,children:j.map((function(e,t){var n=(h?M:p.length-1)===2*t,a=(h?M:p.length-1)===2*t+1,r="white-move".concat(n?" current-move":""),o="black-move".concat(a?" current-move":"");return Object(l.jsxs)("div",{className:"move-wrapper",children:[Object(l.jsx)("div",{className:"move-number",children:t+1}),Object(l.jsxs)("div",{className:"move",children:[Object(l.jsx)("div",{className:r,onClick:function(e){return w(e,2*t)},children:e.white}),Object(l.jsx)("div",{className:o,onClick:function(e){return w(e,2*t+1)},children:e.black})]})]},t)}))})]})})))},82:function(e,t,n){"use strict";var a=n(1),r=n(23),o=n(28),i=n(31),s=n(30),c=n(3),l=n.n(c),u=n(29),v=n(7),h=n(6),d=(n(88),n(4)),m=function(e){var t=e.w,n=e.b,a=e.colorW,r=e.king;if(!e.towers){var o="".concat(a?"white-checker":"black-checker").concat(r?" king":"");return Object(d.jsx)("div",{className:o,children:r&&Object(d.jsx)("span",{className:"king-mark",children:"K"})})}var i=new Array(n).fill(0),s=new Array(t).fill(1),c=a?s.concat(i):i.concat(s),l=Math.floor(c.length/2),u=a?Object(d.jsxs)("p",{className:"numbers-on-hover",children:[Object(d.jsx)("span",{className:"white-top",children:t}),Object(d.jsx)("span",{className:"black-down",children:n})]}):Object(d.jsxs)("p",{className:"numbers-on-hover",children:[Object(d.jsx)("span",{className:"black-top",children:n}),Object(d.jsx)("span",{className:"white-down",children:t})]}),v=c.map((function(e,t){var n=Math.abs(t-l),a=e?"white-piece":"black-piece",o=t<=l?"up".concat(n):"down".concat(n),i=r&&!t?" king":"",s="".concat(a," ").concat(o).concat(i);return Object(d.jsx)("div",{className:s,children:Object(d.jsx)("span",{className:"king-mark",children:r&&!t?"K":null})},t)}));return Object(d.jsxs)("div",{className:"tower-wrapper",children:[v,u]})},f=function(e){var t=e.w,n=e.b,a=e.colorW,r=e.king,o=a?t:n,i=a?n:t,s="checker-tower__quantity".concat(r?" with-crown":"");return Object(d.jsxs)("div",{className:s,children:[Object(d.jsx)("span",{children:o}),"\xa0/\xa0",Object(d.jsx)("span",{children:i})]})},g=Object(u.b)((function(e){return{towers:"towers"===e.gameOptions.gameVariant,bs:e.boardOptions.boardSize}}),{}),b=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"shouldComponentUpdate",value:function(e){return JSON.stringify(e)!==JSON.stringify(this.props)}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.positionInDOM,n=e.currentColor,r=e.currentType,o=e.veiw,i=e.wPiecesQuantity,s=e.bPiecesQuantity,c=e.onBoardPosition,l=this.props.mandatory,u=this.props.bs,g=this.props.towers,b=t,p=b.x,y=b.y,j="checker-tower ".concat(r," ").concat(n," ").concat(o," board-").concat(u).concat(l?" mandatory-tower":"").concat(g?" towers":" classic"," ratio-").concat(10*v.d),w={top:"".concat(y,"px"),left:"".concat(p,"px")},M=i+s>1&&"face"!==o,O={w:i,b:s,colorW:n===h.b.w,king:r===h.d.k,towers:g};return Object(d.jsx)("div",{className:j,"data-indexes":c,style:w,children:M?Object(d.jsx)(f,Object(a.a)({},O)):Object(d.jsx)(m,Object(a.a)({},O))})}}]),n}(l.a.Component);t.a=g(b)},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(3);var a=n(6),r=n(7),o=(n(89),n(4)),i=function(e){return Object(o.jsx)("div",{className:e.className,"data-indexes":e.indexes,children:e.children})},s=function(e){var t=e.boardOptions,n=t.boardSize,s=t.boardNotation,c=t.reversedBoard,l=e.lastMove,u=e.posibleMoves,v=void 0===u?new Map:u,h=r.l.slice(0,n),d=r.j.slice(0,n),m=c?d:d.reverse(),f=c?h.reverse():h,g=c?51:0,b=m.map((function(e,t){return f.map((function(n,r){g=c?(t+r)%2?g-1:g:(t+r)%2?g+1:g;var u=(t+r)%2?"dark":"light",h="".concat(n).concat(e),d=v.get(h)?"marked":"",b=l.indexOf(h),p=b>=0?"highlighted".concat(b):"",y="board__cell ".concat(u," ").concat(d," ").concat(p).trim();return Object(o.jsxs)(i,{indexes:h,className:y,children:[s===a.a.i&&(t+r)%2?Object(o.jsx)("span",{className:"board__cell-number",children:g}):null,s!==a.a.r||r?null:Object(o.jsx)("span",{className:"board__label-value ver",children:m[t]}),s===a.a.r&&t+1===m.length?Object(o.jsx)("span",{className:"board__label-value hor",children:f[r]}):null]},t+"-"+r)}))}));return Object(o.jsx)("div",{className:"board__body",children:b})}},84:function(e,t,n){"use strict";var a=n(85),r=n(1),o=n(20),i=n(23),s=n(6),c=n(9),l=n(42),u=["branchValue"],v={international:["d4-e5","d4-e5","d4-e5","d4-c5","d4-c5","h4-g5","h4-i5"],russian:["c3-d4","c3-d4","c3-d4","c3-b4","c3-b4","e3-f4","a3-b4"],towers:["c3-d4","c3-d4","c3-d4","c3-b4","c3-b4","e3-f4","a3-b4"]},h=new function e(){var t=this;Object(i.a)(this,e),this.GV=l.a.GV,this.mmr=l.a,this.engineTowers=0,this.rivalTowers=0,this.engineKings=0,this.enginePieces=0,this.rivalKings=0,this.rivalPieces=0,this.engineMoves=0,this.rivalMoves=0,this.color=s.b.w,this.setEvaluatingColor=function(e){t.color=e},this.handlePieces=function(e){var n=e.currentType,a=e.currentColor,r=t.rivalKings,o=t.engineKings,i=t.rivalPieces,c=t.enginePieces;n===s.d.m?a===t.color?t.enginePieces=c+1:t.rivalPieces=i+1:a===t.color?t.engineKings=o+1:t.rivalKings=r+1},this.bottomTowersValue=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?t*(.2/e):t*(.4/e)},this.calcTowersFactor=function(){return t.engineTowers-t.rivalTowers},this.handleTower=function(e){var n=e.currentColor,a=e.currentType,r=e.wPiecesQuantity,o=void 0===r?0:r,i=e.bPiecesQuantity,c=void 0===i?0:i;t.color===s.b.w?a===s.d.m?n===s.b.w?(t.engineTowers+=o,t.rivalTowers+=t.bottomTowersValue(o,c)):(t.rivalTowers+=c,t.engineTowers+=t.bottomTowersValue(c,o)):n===t.color?(t.engineTowers+=o+1,t.rivalTowers+=t.bottomTowersValue(o,c,!0)):(t.rivalTowers+=c+1,t.engineTowers+=t.bottomTowersValue(c,o,!0)):a===s.d.m?n===s.b.w?(t.rivalTowers+=o,t.engineTowers+=t.bottomTowersValue(o,c)):(t.engineTowers+=c,t.rivalTowers+=t.bottomTowersValue(c,o)):n===s.b.w?(t.rivalTowers+=o,t.engineTowers+=t.bottomTowersValue(o,c,!0)):(t.engineTowers+=c,t.rivalTowers+=t.bottomTowersValue(c,o,!0))},this.setDefault=function(){t.engineTowers=0,t.rivalTowers=0,t.engineKings=0,t.enginePieces=0,t.rivalKings=0,t.rivalPieces=0,t.engineMoves=0,t.rivalMoves=0},this.calcMoves=function(e,n,a){var r=t.engineMoves,o=t.rivalMoves,i=t.mmr.lookForTowerFreeMoves(e,n,a).length;a===t.color?t.engineMoves=r+i:t.rivalMoves=o+i},this.getBoardData=function(e){Object.values(e).forEach((function(n){var a=n.tower,r=n.boardKey;if(a)if(t.calcMoves(r,e,a.currentColor),"towers"===t.GV){var o=a.wPiecesQuantity,i=void 0===o?0:o,s=a.bPiecesQuantity;i+(void 0===s?0:s)===1?t.handlePieces(a):t.handleTower(a)}else t.handlePieces(a)}))},this.calcMovesNumber=function(e,n){return t.mmr.lookForAllPosibleMoves(e,n).length},this.advantageInNumberOfMoves=function(){var e=t.engineMoves,n=t.rivalMoves;return 2*(e-n)/(e+n)},this.caclAdvantageInPieces=function(){return.9*(t.enginePieces-t.rivalPieces)},this.caclAdvantageInKings=function(){var e=t.engineKings,n=t.rivalKings;return e>n?e/(n+1)*2:-n/(e+1)*2},this.checkIfkingsNumberChanged=function(e){return t.getBoardData(e),t.caclAdvantageInKings()},this.evaluateCurrentPosition=function(e){t.setDefault(),t.getBoardData(e);var n=t.advantageInNumberOfMoves(),a=t.caclAdvantageInPieces(),r=t.caclAdvantageInKings();return"towers"!==t.GV?n+a+r:n+a+r+t.calcTowersFactor()}},d=new function e(){var t=this;Object(i.a)(this,e),this.maxDepth=6,this.bestMoveCB=function(){},this.bestLinesCB=function(){},this.evaluator=h,this.moveBranchesTree=new Map,this.actualHistoryString="",this.lastPlayerMove="",this.historyLength=0,this.engineColor=s.b.w,this.lastResult={},this.fullPath=!1,this.evaluationStarted=!0,this.game=!0,this.resetProps=function(e){t.bestMoveCB=e.bestMoveCB,t.maxDepth=e.maxDepth,t.engineColor=e.engineColor||s.b.w,t.game=!!e.game,t.moveBranchesTree=new Map,e.engineColor&&t.evaluator.setEvaluatingColor(e.engineColor),t.moveBranchesTree=new Map,t.actualHistoryString="",t.historyLength=0,t.lastPlayerMove="",t.lastResult={},console.log("engine reseted",e)},this.startEvaluation=function(e){t.evaluationStarted=e},this.setEngieneColor=function(e){t.engineColor=e,t.evaluator.setEvaluatingColor(e)},this.setDepth=function(e){t.maxDepth=e},this.makeMove=function(e,n){if(t.evaluationStarted){if(e.includes(":"))return l.a.makeMandatoryMove(e.split(":"),n);var a=e.split("-"),r=Object(o.a)(a,2),i=r[0],s=r[1];return l.a.makeFreeMove(i,s,n)}},this.debuteResolver=function(e){var n;if(t.historyLength){var a=l.a.lookForAllPosibleMoves(t.engineColor,e);n=a[Math.floor(Math.random()*a.length)]}else{var r=v[l.a.GV];n=r[Math.floor(Math.random()*r.length)]}var i=n.split("-"),s=Object(o.a)(i,2),c=s[0],u=s[1],h={move:n,position:l.a.makeFreeMove(c,u,e)};t.bestMoveCB(h)},this.filterBranches=function(){var e=t.moveBranchesTree,n=t.actualHistoryString,a=t.lastPlayerMove,r=new Map;e.forEach((function(e,o){if(o.startsWith(n)){var i=n.length-a.length,s=o.slice(i);r.set(s,e)}t.moveBranchesTree=r}))},this.getAvaliableMoves=function(e,n){var a,r=null===(a=t.moveBranchesTree.get(e))||void 0===a?void 0:a.moves;return r||(r=l.a.lookForAllMoves(t.engineColor,n).map((function(e){return{move:e.move,branchValue:-100,position:e.position}}))),r.length?r:null},this.setActualMovesBranchAfterMove=function(e){var n=e.history,a=e.cP;if(console.log(e),t.historyLength=n.length,n.length<2&&t.game)return t.debuteResolver(a);t.lastPlayerMove=n.slice(-1)[0]||"sp";var r=t.lastPlayerMove;t.actualHistoryString=t.historyLength>1?n.join("_"):t.lastPlayerMove,t.moveBranchesTree.size&&t.filterBranches();var o=t.moveBranchesTree,i=t.getAvaliableMoves(r,a),s=o.get(r);if(!i)return t.bestMoveCB({move:"",position:{}});var c=t.evaluator.evaluateCurrentPosition(a);if(s?(console.log("look forward"),r=t.lookForUnevaluatedForward(t.lastPlayerMove)):(s={moves:i,board:a,engineMoveLast:!1,value:c,baseValue:c},t.moveBranchesTree.set(r,s),console.log("new branch at",r,o.get(r))),r)t.stepForward(r);else if(s.value<-5)t.bestMoveCB({move:"surrender",position:{}});else{var l=t.getBestForEngine(s.moves),u=l.move,v=l.position;t.bestMoveCB({move:u,position:v})}},this.handleNoMovesBranch=function(e,n,a,r){if(t.evaluationStarted){var o=n.engineMoveLast?-50:50;if(t.moveBranchesTree.set(e,n),t.moveBranchesTree.set(a,r),e!==t.lastPlayerMove)t.updateParentBranches(e.split("_"),o),t.lastResult={movesBranch:e,value:o},o>0?t.stepBackForUnevaluatedBranchPlayer(e.split("_").slice(0,-1)):t.stepBackForUnevaluatedBranchEngine(e.split("_").slice(0,-1));else{var i=n.engineMoveLast||n.pieceOrder===t.engineColor,s=t.getBestMove(n.moves,i),c=s.move,l=s.position;t.bestMoveCB({move:c,position:l})}}},this.stepForward=function(e){if(t.evaluationStarted&&t.moveBranchesTree.get(e)){var n=t.moveBranchesTree.get(e);n||console.error("no branch",e);var a=n,o=a.moves,i=a.engineMoveLast,s=i?t.engineColor:Object(c.j)(t.engineColor),u=o.filter((function(e){return 100===Math.abs(e.branchValue)}))[0],v=u.move,h=u.position,d=t.evaluator.evaluateCurrentPosition(h),m="".concat(e,"_").concat(v),f=l.a.lookForAllMoves(s,h),g=i?-100:100,b={moves:f.map((function(e){return{move:e.move,branchValue:g,position:e.position}})),board:h,engineMoveLast:!i,value:d,baseValue:d};if(!f.length)return t.handleNoMovesBranch(e,n,m,b);if(n=Object(r.a)(Object(r.a)({},n),{},{moves:o.map((function(e){return e.move===v?Object(r.a)(Object(r.a)({},e),{},{branchValue:d}):e}))}),t.moveBranchesTree.set(e,n),t.moveBranchesTree.set(m,b),!i)if(m.split("_").length>=t.maxDepth)return t.lastLineEvaluation(m);t.stepForward(m)}},this.lookForUnevaluatedForward=function(e){var n=t.moveBranchesTree.get(e);if(!n)return"";var a=n,r=a.moves,o=a.engineMoveLast;return r.filter((function(e){return 100===Math.abs(e.branchValue)})).length&&!o?(console.log("unevaluated position found",n),e):r.length?t.lookForUnevaluatedForward("".concat(e,"_").concat(r[0].move)):""},this.stepBackForUnevaluatedBranchPlayer=function(e){var n=e.length,a=e.join("_");if(t.evaluationStarted&&t.moveBranchesTree.get(a)){var r=t.moveBranchesTree.get(a).moves.filter((function(e){return 100===Math.abs(e.branchValue)}));2===n?r.length?setTimeout((function(){return t.stepForward(a)}),0):t.handlePlayerBranchEvaluationEnd(e):n>2?r.length?n<=4?setTimeout((function(){return t.stepForward(a)}),0):t.stepForward(a):t.stepBackForUnevaluatedBranchPlayer(e.slice(0,-2)):console.error("something wrong with back step engine",e,n,t.moveBranchesTree)}},this.handlePlayerBranchEvaluationEnd=function(e){var n=t.moveBranchesTree.get(t.lastPlayerMove);if(t.evaluationStarted&&n){if(!n.moves.filter((function(e){return 100===Math.abs(e.branchValue)})).length){console.log("evaluation finished",n);var a=t.getBestForEngine(n.moves),r=a.move,o=a.position;return t.bestMoveCB({move:r,position:o})}setTimeout((function(){return t.stepForward(t.lastPlayerMove)}),0)}},this.stepBackForUnevaluatedBranchEngine=function(e){var n=e.length,r=e.join("_"),o=t.moveBranchesTree.get(r);if(t.evaluationStarted&&o){var i=o.moves,s=i.filter((function(e){return 100===Math.abs(e.branchValue)}));if(1===n){if(!s.length){var c=t.getBestForEngine(o.moves),l=(c.branchValue,Object(a.a)(c,u));return console.log("evaluation engine move finished",i,t.moveBranchesTree),t.bestMoveCB(l)}setTimeout((function(){return t.stepForward(r)}),0)}else n>1?s.length?n-t.historyLength<=3?setTimeout((function(){return t.stepForward(r)}),0):t.stepForward(r):t.stepBackForUnevaluatedBranchEngine(e.slice(0,-2)):console.error("something wrong with back step engine")}},this.handleCaseValueChangedNotably=function(e){var n=t.moveBranchesTree.get(e);if(!t.evaluationStarted||!n)return!1;if(e===t.lastPlayerMove)return!1;var a=e.split("_"),r=a.slice(0,-1).join("_"),o=t.moveBranchesTree.get(r);if(Math.abs(n.value-o.value)<.5&&r.length>3)return t.handleCaseValueChangedNotably(r);if(r===t.lastPlayerMove)return!1;var i=a.slice(0,-2).join("_");return t.moveBranchesTree.get(i).moves.filter((function(e){return 100===Math.abs(e.branchValue)})).length?(t.stepForward(i),!0):i.length>3&&t.handleCaseValueChangedNotably(i)},this.stepBackward=function(e){var n=e.split("_"),a=t.lastResult.value,r=t.moveBranchesTree,o=r.get(n.slice(0,-1).join("_")),i=r.get(t.lastPlayerMove);t.evaluationStarted&&o&&i&&(i.baseValue<=a?a>o.baseValue?t.stepBackForUnevaluatedBranchPlayer(n.slice(0,-2)):t.stepBackForUnevaluatedBranchEngine(n.slice(0,-1)):(o.baseValue,t.stepBackForUnevaluatedBranchEngine(n.slice(0,-1))))},this.updateMoves=function(e,t,n){var a=e.moves.map((function(e){return e.move===t?Object(r.a)(Object(r.a)({},e),{},{branchValue:n}):Object(r.a)({},e)}));return Object(r.a)(Object(r.a)({},e),{},{moves:a})},this.updateParentBranches=function(e,n){var a=e.slice(0,-1).join("_"),r=e.slice(-1)[0];if(t.evaluationStarted&&t.moveBranchesTree.get(a)){var o=t.moveBranchesTree.get(a),i=t.updateMoves(o,r,n);if(t.moveBranchesTree.set(a,i),a!==t.lastPlayerMove){var s=o.engineMoveLast?t.getBestForPlayer(i.moves).branchValue:t.getBestForEngine(i.moves).branchValue;return t.updateParentBranches(e.slice(0,-1),s)}}},this.lastLineEvaluation=function(e){if(t.evaluationStarted&&t.moveBranchesTree.get(e)){var n=t.moveBranchesTree.get(e),a=n.moves.map((function(n){var a=n.position,o=t.evaluator.evaluateCurrentPosition(a),i="".concat(e,"_").concat(n.move),s={moves:l.a.lookForAllMoves(t.engineColor,a).map((function(e){return{move:e.move,branchValue:100,position:e.position}})),board:a,engineMoveLast:!1,baseValue:o,value:o};return t.moveBranchesTree.set(i,s),Object(r.a)(Object(r.a)({},n),{},{branchValue:o})}));t.lastResult={value:t.getBestForPlayer(a).branchValue,movesBranch:e},t.updateParentBranches(e.split("_"),t.lastResult.value);var o=Object(r.a)(Object(r.a)({},n),{},{moves:a});t.moveBranchesTree.set(e,o),t.stepBackward(e)}},this.getBestMove=function(e,n){return n?t.getBestForPlayer(e):t.getBestForEngine(e)},this.getBestForPlayer=function(e){return e.slice(1).reduce((function(e,t){return t.branchValue<e.branchValue&&(e=t),e}),e[0])},this.getBestForEngine=function(e){return e.slice(1).reduce((function(e,t){return t.branchValue>e.branchValue&&(e=t),e}),e[0])}};t.a=d},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(21);function r(e,t){if(null==e)return{};var n,r,o=Object(a.a)(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},87:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){}}]);
//# sourceMappingURL=0.761273d9.chunk.js.map