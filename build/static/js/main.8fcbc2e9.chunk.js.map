{"version":3,"sources":["store/app-interface.ts","constants/gameConstants.ts","game-engine/gameplay-helper-fuctions.ts","store/game/types.ts","store/gameAnalysis/types.ts","store/board/types.ts","store/gameOptions/types.ts","game-engine/prestart-help-function-constants.ts","game-engine/update-towers-functions.ts","store/boardOptions/types.ts","assets/i18n.ts","page-components/spinners/Spinner.js","game-engine/common-fn-moves-resolver.ts","game-engine/king-mandatory-move-resolver.ts","game-engine/mandatory-move-resolver.ts","store/gameOptions/actions.ts","common/LogoIcon.tsx","assets/game-example.gif","pages/home/Home.tsx","AppRoutes.tsx","store/user/types.ts","page-components/MobileDropdownNav.tsx","page-components/Navbar.tsx","store/user/actions.ts","page-components/Header.tsx","assets/icons8-github.svg","store/app/types.ts","page-components/Footer.tsx","store/app/actions.ts","App.tsx","reportWebVitals.ts","store/game/reducers.ts","store/gameOptions/reducers.ts","store/user/reducer.ts","store/app/reducers.ts","store/clock/types.ts","store/clock/reducers.ts","store/gameAnalysis/reducers.ts","store/board/reducers.ts","store/boardOptions/reducers.ts","store/rootState&Reducer.ts","store/sagas/watcherGame.ts","store/sagas/watcherGamePresets.ts","store/sagas/watcherTimer.ts","store/sagas/watcherGameAnalysis.ts","store/sagas/watcherBoard.ts","store/sagas/sagaRoot.ts","store/index.ts","index.tsx"],"names":["TowerType","PieceColor","BoardNotation","Online","TowerConstructor","props","onBoardPosition","currentColor","wPiecesQuantity","bPiecesQuantity","positionInDOM","currentType","veiw","mandatoryMove","this","m","w","b","x","y","TopLegendValues","SideLegendValues","Array","fill","map","i","j","DefaultTime","BaseBoardSize","StandartTiming","PrestartTimeLimit","Interval","BaseCellSize","AnimationDuration","CellTowerRatio","sampleLink","RoutesPath","home","game","settings","analysis","stats","rules","auth","profile","RoutesTitle","analyze","defaultWhiteTowerCells8x8","defaultBlackTowerCells8x8","board8x8EmptyCells","defaultWhiteTowerCells","concat","defaultBlackTowerCells","filter","includes","board10x10EmptyCells","getDefaultBlackTowersCells","boardSize","getDefaultWhiteTowersCells","splitMove","move","split","oppositColor","color","copyMap","board","nm","Map","forEach","v","k","isArray","set","copyObj","Object","keys","reduce","acc","possibleOutOfMandatory","state","key","posibleMoves","MS","mandatoryMoveStep","mandatoryMoves","cellsMap","step","get","compareMaps","map1","map2","JSON","stringify","entries","filterArrayByLength","arr","maxLength","val","length","cont","push","ended","crossDirections","dir","directions","checkMoveTargetCell","pos","pM","cellSize","ref","possibleCells","size","boardRect","current","querySelector","getBoundingClientRect","targetCell","cellX","cellY","Math","sqrt","pow","checkIfNumberOfKingsChanged","board1","board2","calcKings","values","cell","tower","convertToMovesHistory","result","white","black","getCellSize","refElem","boardHtmlRect","width","left","right","cellWidth","round","GameActions","SET_MOVE_ORDER","SET_GAME_STARTED","MAKE_MOVE","CONFIRM_START_GAME","UPDATE_GAME_STATE","INEFFECTIVE_MOVE","SAVE_MOVE_TO_HISTORY","SET_PLAYER_MOVE_ORDER","SET_GAME","END_GAME","OFFER_DRAW","DECLINE_DRAW","RIVAL_OFFER_DRAW","SURRENDER","SET_PORTRAIT","SET_GAME_MODE","CANCEL_GAME","NEW_GAME_VS_PC","NEW_GAME_VS_PLAYER","CLEAR_HISTORY","GameAnalysisActions","ANALYZE_LAST_GAME","DOWNLOAD_GAME","SAVE_GAME_RESULT","SETTING_BOARD","UPDATE_POSITION","STEP_FORWARD","STEP_BACK","SAVE_POSITION","GO_TO_POSITION","CREATE_POSITION_TREE","UPDATE_ANALYSIS_STATE","EVALUATE_POSITION","SET_DEPTH","PLAY_MOVES","SET_START_POSITION","REMOVE_PIECE","START_NEW_LINE","MAKE_NEW_MOVE","BoardActions","CREATE_GAME_BOARD","CREATE_SETUP_BOARD","CREATE_ANALYSIS_BOARD","UPDATE_BOARD_STATE","UPDATE_BOARD_SIZE","UPDATE_BOARD_MAP","TURN","UPDATE_POSITION_TREE","UNDO_LAST_MOVE","GameOptionActions","CHOOSE_COLOR","SET_TIME_LIMIT","SET_TIME_ADDS","SET_GAME_TIMING","SET_RIVAL","SET_PLAYER","SET_GAME_VARIANT","SET_RIVAL_ONLINE_STATUS","SET_PLAYER_ONLINE_STATUS","SET_GAME_TYPE","SET_RIVAL_LEVEL","FIND_RIVAL","SET_RIVAL_TYPE","FINISH_GAME_SETUP","WAIT_RIVAL","CANCEL_RIVAL_WAITING","REMATCH_REQUEST","createEmptyBoard","GameBoard","boardKey","neighbors","defineNeighborCells","createStartBoardToDraw","boardOptions","reversedBoard","currentPosition","createStartBoard","positionsTree","towers","createDefaultTowers","createCellsMap","animationStarted","moveDone","mouseDown","lastMoveSquares","createEmptyBoardForCustomPosition","createOutBoardTowers","createAnalysisBoard","defineCellDomPosition","reversed","topInd","slice","reverse","sideInd","indexOf","parseInt","updateCellsMap","newMap","topLegend","sideLegend","leftUp","leftDown","rightUp","rightDown","newOnBoardTower","DBTC","DWTC","defaultTowerProps","oBKey","tur","previousPosition","callBack","setCalBack","cb","calcPositionOutboardTowers","boardElem","document","boardHeight","height","towerWidth","dY","bottom","calcTowerPosition","cellPosition","towerElem","console","error","updateTowersPosition","_towers","updateCellsPosition","boardRef","newCellSize","newCellMap","newTowers","from","to","log","checkTowerTypeChanging","delete","towerTouched","last","GV","history","currentPositionKey","join","tP","isTowers","updateTowersAfterMoveAnimation","middlePieceKey","middlePiece","takenTower","cuptureTower","_tower","newMiddleTower","wT","BaseMoveResolver","BoardOptionActions","SET_GAME_BOARD_OPTIONS","REVERSE_BOARD","SET_BOARD_THEME","SET_BOARD_NOTATION","SET_BOARD_SIZE","I18n","en","shortMainTitle","mainTitle","newGame","submitLog","submitReg","logTitle","regTitle","logMess","regMess","modeButtonLog","modeButtonReg","labelPassword","labelNickname","submitButton","about","about_continue","play","ru","Spinner","className","onClick","cancelRivalWaiting","title","setProps","getCapturedPieceKey","getInterval","c","newTower","type","start","end","getMoveDirection","interval","nextCellKey","direction","startCellKey","diagonal","nextCell","preDirected","diagonals","availibleDirections","d","getDiagonal","MoveResolveCommons","lookForTowerFreeMoves","checkNeighborsIsEmpty","lookForKingFreeMoves","lookForAllPosibleMoves","moves","getFromToKeys","moveArr","repetition","lastIndexOf","Error","makeMoveWithoutTakingPieces","_board","nextMoves","fromTower","whiteMove","checkLastLine","getBoardFromTowers","value","getNewOrder","newPieceOrder","moveOrder","pieceOrder","playerTurn","name","getPropsToMakeFreeMove","position","makeFreeMove","moveToSave","manTowerFreeMoves","cellNeighbors","towerLine","neighborLine","kingTowerFreeMoves","moveSteps","cellKey","makeMandatoryMove","nextMove","makeMandatoryMoveStep","newBoard","updateBoardOnMandatoryMoveStep","fN","moveLength","getCapturedTowers","diag","currentLine","getDiagonals","checkDiagonalForKingMove","KingMandatoryMoveResolver","checkFirstKingDiagonals","checkKingNextSteps","firstMove","takenPieces","_moves","checkDiagonalToMadatoryMove","cM","movesToCheckContinue","compleatedMoves","nextStepResult","checkNextMoveStepDirections","_m","startsWith","resultMoves","checkIfDiagonalNotFit","takenPiece","notTaken","nMove","lastCell","MRC","mmr","lookForAllMoves","lookForMandatoryMoves","checkMandatoryMoveNextStep","moveArray","exludedDirection","checkManDirection","checkMandatoryMoveNextSteps","mr","gameVariantMoveContinueRestriction","removeTakenPieces","checkKingMandatoryMoves","checkManMandatoryMoves","nBoard","startProps","checkManFristMandatoryStep","preMove","neighborCell","KMMR","setRivalLevel","payload","setPlayerColor","setOpponentType","setTiming","findRival","finishGameSetup","setGameVariant","requestRematch","setGameType","Logo","Home","language","useSelector","store","user","useHistory","i18n","href","fallback","target","rel","src","gameExample","alt","GameAnalizePage","lazy","GamePage","Router","path","exact","React","memo","UserActions","MobileMenu","useState","dropdown","setDropdown","visible","setVisible","mobileMenuClass","createRef","handleClickOutside","ev","stopPropagation","elem","contains","useEffect","window","addEventListener","removeEventListener","e","preventDefault","setTimeout","mapDispatch","setLanguage","connector","connect","winWidth","app","windowSize","DuoLanguageSwitcher","lang","langs","blur","handleClick","innerWidth","mobile","setMobile","isAuthLogo","logo","event","Header","AppActions","close","setWindowSize","setPortrait","token","portrait","gameMode","handleResize","innerHeight","abs","onClose","referrerPolicy","git","Component","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","InitialGameState","gameConfirmed","gameStarted","playerColor","rivalOfferedDraw","ineffectiveMoves","InitialGameOptionsState","gameVariant","timing","timeToGame","adds","rivalType","rivalLevel","gameSetupFinished","waitingRival","gameType","InitialUserState","userId","rating","navigator","AppDefaultState","commonChat","gameChat","ClockActions","InitialClockState","whiteClock","timeToFirstMove","blackClock","InitialGameAnalysisState","gameResult","analyzeLastGame","settingPosition","movesMainLine","movesCurrentLine","lastMove","depth","evaluate","removePiece","startPosition","InitialBoardState","towerView","InitialBoardOptionsState","boardTheme","withOutLegend","lengendsInside","boardNotation","r","InitialState","gameOptions","clock","AppReducers","action","GM","UA","movesHistory","workerNewGameVSPlayer","workerNewGameVsPC","checkDraw","workerPlayerClockAfterMove","workerMove","workerGameEnd","workerSurrender","resolveEndGame","cancelGameWorker","watcherGame","put","GOA","select","random","BOA","gamePayload","delay","rival","numberOfKingsChanged","draw","winner","reason","PC","date","Date","analysisPayload","index","takeLatest","workerGameVariant","watcherPreGame","GA","workerGameClock","workerStartClock","workerPreTicks","watcherTimer","workerUpdatePosition","workerStepForward","workerGoToPosition","workerPlayMoves","workerStepBack","workerSettingBoard","workerGameAnalysis","workerCurrentLine","workerMainLine","workerNewMove","workerStartPosition","watcherAnalysis","nextLastMove","nextPositionKey","newCurrentLine","updateTowersToBoard","nextIndex","movesLine","_positionsTree","newKey","currentPositoin","_positionTree","clear","paylaod","workerGameBoard","workerSetupBoard","workerBoardSize","workerAnalysisBoard","animateFreeMove","animateMandatoryTowerStep","animateMandatoryStep","animateMandatoryMove","workerTurn","workerUndo","watcherBoard","BA","relocateTower","newState","finalizeSimpleMove","totalSteps","capturedTowerKey","finalizeMandatoryMoveStep","isLast","pKey","boardProps","boardPayload","sagaRoot","all","watcherAnalsis","sagaMiddleware","createSagaMiddleware","storeFactory","data","middleware","composeWithDevTools","applyMiddleware","rootReducer","combineReducers","createStore","run","ReactDOM","render","StrictMode","getElementById","dispatch"],"mappings":"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","file":"static/js/main.8fcbc2e9.chunk.js","sourcesContent":["// app state\nexport interface IApp {\n    windowSize: {width: number, height: number}\n    portrait: boolean\n    theme?: string\n    message?: {content: string, exposition?: string}\n    commonChat: IMessage[]\n    gameChat: IMessage[]\n}\n\nexport interface IMessage {content: string, from: string, to: string, date: Date, emoji: number, }\n\nexport interface IUserState extends IUser{\n    name: string | null\n    token: string | null\n    userId: string | null\n    rating: number\n    language: string\n    notifications: [{[key: string]: any}]\n}\n\n// timer interfaces\nexport interface ITimer {\n    min: string;\n    sec: string;\n}\n\nexport interface IClock {\n    timeToGame: number\n    adds?: number \n    timeToFirstMove?: number\n}\n\nexport interface Timing {\n    timeToGame: number,\n    adds: number\n}\n\nexport interface IError {\n    message: string | null\n};\n\n// boardtodraw\nexport enum TowerType {\n    m = 'man',\n    k = 'king'\n}\n\nexport enum PieceColor {\n    b = 'black',\n    w = 'white'\n}\n\nexport enum BoardNotation {\n    r = 'chess',\n    i = 'international'\n}\n\nexport interface IBoardAndTowers extends IBoardToDraw {\n    lastMoveSquares: string[]\n    towerView: string,\n    currentPosition: IBoardToGame\n    mandatoryMoveStep: number\n    animationStarted: boolean\n    moveDone: boolean\n}\n\nexport interface IAnalysisState {\n    gameResult: IGameResult\n    settingPosition: boolean\n    pieceOrder: PieceColor\n    movesMainLine?: string[]\n    analyzeLastGame: boolean\n    movesCurrentLine: string[]\n    lastMove: {index: number, move: string}\n    depth: number\n    evaluate: boolean\n    removePiece: boolean\n    startPosition: boolean,\n}\n\nexport type CellsMap = Map<string, ITowerPosition>\n\nexport interface IBoardProps {boardOptions: IBoardOptions, posibleMoves?: CellsMap, lastMove: string[]}\n\nexport interface IBoardToDraw {\n    cellsMap: CellsMap\n    cellSize: number\n    towerTouched?: TowerTouched\n    posibleMoves?: CellsMap\n    towers: TowersMap\n    mouseDown: boolean\n    mandatoryMoves?: IMMRResult[]\n    positionsTree?: Map<string, IBoardToGame>\n    lastMoveSquares: string[]\n    currentPosition: IBoardToGame\n}\n\nexport interface IGameBoard extends IBoardToDraw{\n    mandatoryMoveStep?: number;\n    mandatoryMovesChecked?: boolean;\n    animationStarted?: boolean;\n    moveDone?: boolean;\n    currentPosition: IBoardToGame,\n}\n\nexport interface IAnalysisBoard extends IBoardToDraw{\n    mandatoryMoveStep?: number;\n    moveDone?: boolean    \n}\n\nexport interface ICell {\n    type?: 'light' | 'dark';\n    indexes?: string;\n    [propName: string]: any;  \n}\n\n// towers\nexport interface ITowerPosition {\n    x: number;\n    y: number;\n}\n\nexport type TowersMap = Map<string, TowerConstructor>\n\nexport interface IRef<T> {\n    readonly current: T | null\n}\n\nexport type NeighborsKeys = 'leftUp' | 'leftDown' | 'rightUp' | 'rightDown'\n\nexport interface ICheckerTower  {\n    currentType?: TowerType;\n    currentColor: PieceColor;\n    wPiecesQuantity?: number;\n    bPiecesQuantity?: number;\n    positionInDOM?: ITowerPosition;\n    onBoardPosition: string;\n    [key: string]: any;\n}\n\n\nexport interface INewGameProps {\n    gameKey: string\n    white: IPlayer,\n    black: IPlayer,\n    whiteClock: IClock,\n    blackClock: IClock,\n    moveOrder: IMoveOrder\n}\n\nexport class TowerConstructor implements ICheckerTower {\n    onBoardPosition: string;\n    currentColor: PieceColor;\n    wPiecesQuantity: number;\n    bPiecesQuantity: number;\n    positionInDOM?: ITowerPosition;\n    currentType: TowerType;\n    veiw?: string;\n    mandatoryMove?: boolean;\n    constructor(props: ICheckerTower ) {\n        this.currentType = props.currentType || TowerType.m;\n        this.currentColor = props.currentColor;\n        this.wPiecesQuantity = props.wPiecesQuantity || (props.currentColor === PieceColor.w ? 1 : 0);\n        this.bPiecesQuantity = props.bPiecesQuantity || (props.currentColor === PieceColor.b ? 1 : 0);\n        this.positionInDOM = props.positionInDOM || {x: 0, y: 0};\n        this.onBoardPosition = props.onBoardPosition\n        this.veiw = props.veiw || 'face'\n        this.mandatoryMove = props.mandatoryMove || false\n    }\n}\n\nexport type PartialTower = Partial<TowerConstructor>\n\n// game\nexport interface IMoveOrder {\n    pieceOrder: PieceColor\n    playerTurn: string\n}\n\nexport interface IMoveProps {\n    gameKey?: string,\n    moveToSave: IMMRResult,\n    moveOrder: IMoveOrder,\n    recievedAt?: Date,\n    whiteClock?: IClock,\n    blackClock?: IClock\n}\n\nexport type IGameMode = 'isPlaying' | 'isOver' | 'isAnalyzing' | 'isPreparing'\n\nexport interface IGameState {\n    gameKey?: string\n    moveOrder: IMoveOrder\n    gameStarted: boolean\n    gameConfirmed: boolean\n    history: string[]\n    playerColor: PieceColor\n    white: IPlayer\n    black: IPlayer\n    lastGameResult?: IGameResult | null\n    ineffectiveMoves?: number\n    portrait?: boolean\n    gameMode: IGameMode\n    rivalOfferedDraw: boolean,\n    // [key: string]: any\n}\n\nexport type GameType = 'ranked' | 'casual' | 'tournament'\n\nexport interface IGameOptionState {\n    timing: Timing\n    gameType: GameType\n    playerColor: PieceColor | 'random'\n    rivalType: RivalType\n    rivalLevel: number\n    gameVariant: GameVariants\n    gameSetupFinished: boolean\n    waitingRival: boolean\n}\n\nexport interface TowerTouched {\n    key: string\n    posibleMoves: CellsMap\n    startCursorPosition: ITowerPosition\n    startTowerPosition: ITowerPosition\n    towerColor: PieceColor\n    towerType: TowerType\n}\n\nexport type GameVariants = 'towers' | 'russian' | 'international'\nexport type BoardToGame = Map<string, IBoardCell>\n\nexport interface IBoardToGame {\n    [key: string]: IBoardCell\n}\n\nexport interface IBoardOptions {\n    boardSize: number,\n    boardTheme?: string,\n    topLegend?: string[],\n    sideLegend?: number[],\n    withOutLegend?: boolean,\n    lengendsInside?: boolean,\n    boardNotation: BoardNotation,\n    reversedBoard: boolean\n}\n\nexport enum Online {\n    online,\n    offline,\n    reconnecting\n}\n\nexport interface IPlayer {\n    name: string\n    onlineStatus?: Online\n    userId?: string\n    rating?: number\n}\n\nexport type EndGameConditions = 'surrender' \n    | 'outOfTime'\n    | 'noMoves'\n    | 'drawByAgreement' \n    | 'drawByRules'\n    | 'abandonedByWhite'\n    | 'abandonedByBlack'\n\nexport interface IGameResult {\n    gameKey?: string,\n    winner: PieceColor | 'draw'\n    reason: EndGameConditions\n    white: IPlayer\n    black: IPlayer\n    playerColor?: PieceColor\n    movesHistory: string[]\n    gameVariant: GameVariants\n    timing: string\n    boardSize?: number\n    date: Date\n}\n\nexport interface IBoardCell {\n    pos?: ITowerPosition;\n    tower: PartialTower | null\n    neighbors: INeighborCells;\n    boardKey: string\n}\n\nexport interface INeighborCells {\n    [key: string]: string\n}\n\nexport interface IDaigonals {[key: string]: IBoardCell[]}\n\nexport interface IMMRResult {\n    move: string\n    position: IBoardToGame\n    takenPieces?: string[]\n}\n\nexport interface IBoardDiagonal {\n    direction: NeighborsKeys;\n    values: IBoardDiagonalCell[];\n}\n \nexport interface IBoardDiagonalCell {\n    cellIndex: string;\n    towerColor: PieceColor | null\n}\n\nexport type RivalType = 'player' | 'PC' \n\n// user\nexport interface IUser {\n    token: string | null,\n    userId: string | null,\n    name: string | null,\n    rating: number | null\n    language: string\n}\n","export const TopLegendValues = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'k', 'l', 'm'];\nexport const SideLegendValues = new Array(12).fill(0).map((i: undefined, j: number): number => j + 1);\nexport const BoardDirections = ['leftUp', 'leftDown', 'rightUp', 'rightDown'];\nexport const BaseTransform = 'translate(-50%, -50%)';\nexport const DefaultTime = 300;\nexport const Storage = 'chekers';\nexport const BaseBoardSize = 8;\nexport const InternationalBoardSize = 10;\nexport const StandartTiming = [[1,0], [2,1], [3,0], [3,1], [5,0], [5,3], [10, 0], [10, 3], [15, 0]]\nexport const PrestartTimeLimit = 10\nexport const Interval = 1000\nexport const BaseCellSize = 50\nexport const AnimationDuration = 300\nexport const CellTowerRatio = .7\n\n\nexport const sampleLink = \"https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D1%88%D0%BA%D0%B8#%D0%A1%D1%82%D0%BE%D0%BB%D0%B1%D0%BE%D0%B2%D1%8B%D0%B5\"\n\nexport const RoutesPath = {\n    home: '/',\n    game: '/game',\n    settings: '/settings',\n    analysis: '/analysis',\n    stats: '/stats',\n    rules: '/rules',\n    auth: '/auth',\n    profile: '/profile',\n}\n\nexport const RoutesTitle= {\n    home: 'home',\n    game: 'apps',\n    analyze: 'zoom_in',\n    rules: 'import_contacts',\n    stats: 'insert_chart',\n    settings: 'settings',\n    profile: 'person',\n    auth: 'login',\n}\n\nexport const storageName = 'checkers'\n\nexport const defaultWhiteTowerCells8x8 = ['a1', 'a3', 'b2', 'c1', 'c3', 'd2', 'e1', 'e3', 'f2', 'g1', 'g3', 'h2',]\nexport const defaultBlackTowerCells8x8 = ['a7', 'b8', 'b6', 'c7', 'd8', 'd6', 'e7', 'f8', 'f6', 'g7', 'h8', 'h6']\n\nexport const board8x8EmptyCells = ['b4', 'd4', 'f4', 'h4', 'a5', 'c5', 'e5', 'g5']\nexport const boardEmptyCells = board8x8EmptyCells.concat(['k4', 'i5'])\n\n// export const board8x8Cells = defaultBlackTowerCells8x8.concat(board8x8EmptyCells).concat(defaultWhiteTowerCells8x8)\n\nexport const defaultWhiteTowerCells = defaultWhiteTowerCells8x8\n.concat(['i1', 'i3', 'k2', 'b4', 'd4', 'f4', 'h4', 'k4'])\nexport const defaultBlackTowerCells = defaultBlackTowerCells8x8\n.filter((x: string) => !x.includes('6'))\n.concat(['i7', 'k10', 'k8', 'i9', 'a9', 'c9', 'e9', 'g9', 'b10', 'd10', 'f10', 'h10'])\n\nexport const board10x10EmptyCells = board8x8EmptyCells.concat(['k4', 'i5'])\n\nexport const getDefaultBlackTowersCells = (boardSize: number): string[] => {\n    return boardSize === 8 ? defaultBlackTowerCells8x8 : defaultBlackTowerCells\n}\n\nexport const getDefaultWhiteTowersCells = (boardSize: number): string[] => {\n    return boardSize === 8 ? defaultWhiteTowerCells8x8 : defaultWhiteTowerCells\n}\n\nexport const board10x10Cells = defaultBlackTowerCells.concat(defaultWhiteTowerCells).concat(board10x10EmptyCells)\n","import { \n    CellsMap,\n    IBoardCell,\n    IBoardToGame,\n    IGameBoard,\n    IMMRResult,\n    IRef,\n    ITowerPosition,\n    PieceColor,\n    TowerConstructor,\n    TowersMap,\n    TowerType,\n} from \"../store/app-interface\"\n\n//common functions\nexport const splitMove = (move: string) => {\n    if (move.includes(':')) {\n        return move.split(':')\n    }\n    return move.split('-')\n}\n\nexport const oppositColor = (color: PieceColor): PieceColor => (color === PieceColor.w ? PieceColor.b : PieceColor.w)\n\nexport const copyMap = (board: Map<string, any>) => {\n    const nm = new Map()\n    board.forEach((v: any, k: string) => {\n        if (typeof v === 'object') {\n            if (Array.isArray(v)) {\n                nm.set(k, [...v])\n            } else {\n                nm.set(k, {...v})\n            }\n        } else {\n            nm.set(k, v)\n        }\n    })\n    return nm\n}\n\nexport const copyObj = (board: {[key: string]: any}): {[key: string]: any} => {\n    return Object.keys(board).reduce((acc: {[key: string]: any}, k: string) => {\n        const v = board[k]\n        if (typeof v === 'object') {\n            if (Array.isArray(v)) {\n                acc[k] = [...v]\n            } else {\n                acc[k] = {...v}\n            }\n        } else {\n            acc[k] = v\n        }\n        return acc\n    }, {})\n}\n\nexport const possibleOutOfMandatory = (state: Partial<IGameBoard>, key: string):CellsMap => {\n    const posibleMoves = new Map() as CellsMap\n    const {mandatoryMoveStep: MS, mandatoryMoves, cellsMap } = state\n    const availableSteps = mandatoryMoves!\n    .filter((m: IMMRResult) => m.move.includes(key)).map((m: IMMRResult) => m.move.split(':')[MS as number + 1])\n    availableSteps.forEach((step: string) => {\n        posibleMoves.set(step, cellsMap!.get(step) as ITowerPosition)\n    })\n    return posibleMoves\n}\n\nexport const compareMaps = (map1: TowersMap, map2: TowersMap): boolean => {\n    return JSON.stringify([...map1.entries()]) !== JSON.stringify([...map2.entries()])\n}\n\nexport const filterArrayByLength = (arr: IMMRResult[]):  {ended: IMMRResult[], cont: IMMRResult[]} => {\n    const maxLength = arr.reduce((acc: number, val: IMMRResult) => (acc > val.move.length ? acc : val.move.length), 0)\n    return arr.reduce((acc: {ended: IMMRResult[], cont: IMMRResult[]}, val: IMMRResult) => {\n        if(val.move.length === maxLength) {\n            acc.cont.push(val)\n        } else {\n            acc.ended.push(val)\n        }\n        return acc\n    }, {ended: [], cont: []})\n}\n\nexport const crossDirections = (dir: string): {[key: string]: boolean} => {\n    const directions = {} as {[key: string]: boolean}\n    directions[`${dir.includes('left') ? 'left' : 'right'}${dir.includes('Up') ? 'Down' : 'Up'}`] = true\n    directions[`${dir.includes('left') ? 'right' : 'left'}${dir.includes('Up') ? 'Up' : 'Down'}`] = true\n    return directions\n}\n \nexport function checkMoveTargetCell(pos: ITowerPosition, pM: CellsMap, cellSize: number, ref: IRef<any>) {\n    const possibleCells =  pM.entries()\n    const size = cellSize\n    const boardRect = ref.current!.querySelector('.board__body')!.getBoundingClientRect();\n    \n    const [x, y] = [pos.x - boardRect.x, pos.y - boardRect.y]\n    if (x < 0 || y < 0) {\n        return null\n    }\n    const targetCell = [...possibleCells].filter((props) => {\n        const [cellX, cellY] = [props[1].x + size! / 4, props[1].y + size! / 4]\n        const distance = Math.sqrt(Math.pow((cellX - x), 2) + Math.pow((cellY - y), 2))\n        return distance < size!\n    })[0]\n    if (targetCell) {\n        return targetCell[0]\n    }\n    return null\n}\n\nexport const checkIfNumberOfKingsChanged = (board1: IBoardToGame, board2: IBoardToGame) => {\n    const calcKings = (board: IBoardToGame) => Object.values(board).filter((cell: IBoardCell) => \n        cell.tower?.currentType === TowerType.k).length\n        \n    return calcKings(board1) !== calcKings(board2)\n}\n\nexport const convertToMovesHistory = (arr: string[]): {white: string, black: string}[] => {\n    const result: {white: string, black: string}[] = []\n    for (let i = 0; i < arr.length; i += 2) {\n        result.push({white: arr[i], black: arr[i+1] || ''})\n    }\n    return result\n}\n\nexport function getCellSize(refElem: HTMLDivElement, size: number) {\n    const boardHtmlRect = refElem.querySelector('.board__body')!.getBoundingClientRect();\n    const {width, left, right} = boardHtmlRect\n    const cellWidth = (width ? width:  left - right) / size;\n    return Math.round(cellWidth)\n}\n\nexport function checkIfBoardFitTowers(towers: TowersMap, board: IBoardToGame): boolean {\n    let res = true\n    towers.forEach((tower: TowerConstructor, key: string) => {\n        const towerOnBoard = board[key].tower\n        if (tower.onBoardPosition !== towerOnBoard?.onBoardPosition\n            || tower.bPiecesQuantity !== towerOnBoard.bPiecesQuantity\n            || tower.wPiecesQuantity !== towerOnBoard.wPiecesQuantity\n            || tower.currentColor !== towerOnBoard.currentColor\n            || tower.currentType !== towerOnBoard.currentType) {\n                res = false\n                throw new Error(\"board do not fit towers\")\n            }\n    })\n    return res\n}\n\nconst GHF = {\n    checkIfBoardFitTowers,\n    getCellSize,\n    convertToMovesHistory,\n    checkIfNumberOfKingsChanged,\n    checkMoveTargetCell,\n    crossDirections,\n    copyObj,\n    copyMap,\n    oppositColor,\n    compareMaps,\n    filterArrayByLength,\n}\n\nexport default GHF\n","import {EndGameConditions, IBoardToGame, INewGameProps, IGameMode, IGameState, IMoveOrder, IMoveProps, PieceColor} from \"../app-interface\";\n// import { GameOptionActions } from \"../gameOptions/types\";\n\nexport const GameActions = {\n    SET_MOVE_ORDER: 'SET_MOVE_ORDER',\n    SET_GAME_STARTED: 'SET_GAME_STARTED',\n    MAKE_MOVE: 'MAKE_MOVE',\n    CONFIRM_START_GAME: 'CONFIRM_START_GAME',\n    UPDATE_GAME_STATE: 'UPDATE_GAME_STATE',\n    INEFFECTIVE_MOVE: 'INEFFECTIVE_MOVE',\n    SAVE_MOVE_TO_HISTORY: 'SAVE_HISTORY',\n    SET_PLAYER_MOVE_ORDER: 'SET_PLAYER_MOVE_ORDER',\n    SET_GAME: 'SET_GAME',\n    END_GAME: 'END_GAME',\n    OFFER_DRAW: 'OFFER_DRAW',\n    DECLINE_DRAW: 'DECLINE_DRAW',\n    RIVAL_OFFER_DRAW: 'RIVAL_OFFER_DRAW',\n    SURRENDER: 'SURRENDER',\n    SET_PORTRAIT: 'SET_PORTRAIT',\n    SET_GAME_MODE: 'SET_GAME_MODE',\n    CANCEL_GAME: 'CANCEL_GAME',\n    NEW_GAME_VS_PC: 'NEW_GAME_VS_PC',\n    NEW_GAME_VS_PLAYER: 'NEW_GAME_VS_PLAYER',\n    CLEAR_HISTORY: 'CLEAR_HISTORY',\n}\n\ninterface ClearHistoryAction {\n    type: typeof GameActions.CLEAR_HISTORY,\n    payload: null\n}\n\ninterface NewGameVSPCAction {\n    type: typeof GameActions.NEW_GAME_VS_PC,\n    payload: null\n}\n\ninterface NewGameVSPlayerAction {\n    type: typeof GameActions.NEW_GAME_VS_PLAYER,\n    payload: INewGameProps\n}\n\ninterface SurrenderAction {\n    type: typeof GameActions.SURRENDER,\n    payload: PieceColor\n}\n\ninterface CancelGameAction {\n    type: typeof GameActions.CANCEL_GAME,\n    payload: null\n}\n\ninterface SetGameModeAction {\n    type: typeof GameActions.SET_GAME_MODE,\n    payload: IGameMode\n}\n\ninterface SetPortraitAction {\n    type: typeof GameActions.SET_PORTRAIT,\n    payload: boolean\n}\n\ninterface SetGameAction {\n    type: typeof GameActions.SET_GAME,\n    payload: Partial<IGameState>\n}\n\ninterface IneffectiveMoveAction {\n    type: typeof GameActions.INEFFECTIVE_MOVE,\n    payload: number\n}\n\ninterface OpponentOfferDrawAction {\n    type: typeof GameActions.RIVAL_OFFER_DRAW\n    payload: null\n}\n\ninterface SetPlayerMoveOrderAction {\n    type: typeof GameActions.SET_PLAYER_MOVE_ORDER,\n    payload: boolean\n}\n\ninterface DeclineDrawAction {\n    type: typeof GameActions.DECLINE_DRAW,\n    payload?: boolean\n}\n\ninterface SaveHistoryAction {\n    type: typeof GameActions.SAVE_MOVE_TO_HISTORY,\n    payload: string[]\n}\n\ninterface SetMoveOrderAction {\n    type: typeof GameActions.SET_MOVE_ORDER,\n    payload: IMoveOrder\n}\n\ninterface UpdateGameStateAction {\n    type: typeof GameActions.UPDATE_GAME_STATE,\n    payload: IBoardToGame\n}\n\ninterface SetGameStartedAction {\n    type: typeof GameActions.SET_GAME_STARTED,\n    payload: boolean\n}\n\ninterface OfferDrawAction {\n    type: typeof GameActions.OFFER_DRAW,\n    payload: boolean\n}\n\ninterface MakeMoveAction {\n    type: typeof GameActions.MAKE_MOVE,\n    payload: IMoveProps\n}\n\ninterface ConfirmStartGameAction {\n    type: typeof GameActions.CONFIRM_START_GAME,\n    payload: boolean\n}\n\ninterface EndGameAction {\n    type: typeof GameActions.END_GAME,\n    payload: EndGameConditions\n}\n\nexport type GameActionTypes = \n| IneffectiveMoveAction\n| CancelGameAction\n| SetGameStartedAction\n| SetMoveOrderAction\n| UpdateGameStateAction\n| SetPortraitAction\n| SaveHistoryAction\n| SetPlayerMoveOrderAction\n| EndGameAction\n| SetGameAction\n| SurrenderAction\n| MakeMoveAction\n| OfferDrawAction\n| OpponentOfferDrawAction\n| DeclineDrawAction\n| ConfirmStartGameAction\n| SetGameModeAction\n| NewGameVSPCAction\n| NewGameVSPlayerAction\n| CancelGameAction\n| ClearHistoryAction\n","import { IAnalysisState, IBoardToGame, IGameResult, IMoveProps } from \"../app-interface\"\n\nexport const GameAnalysisActions = {\n    ANALYZE_LAST_GAME: 'ANALYZE_LAST_GAME',\n    DOWNLOAD_GAME: \"DOWNLOAD_GAME\",\n    SAVE_GAME_RESULT: 'SAVE_GAME_RESULT',\n    SETTING_BOARD: 'SETTING_BOARD',\n    UPDATE_POSITION: 'UPDATE_POSITION',\n    STEP_FORWARD: 'STEP_FORWARD',\n    STEP_BACK: \"STEP_BACK\",\n    SAVE_POSITION: \"SAVE_POSITION\",\n    GO_TO_POSITION: 'GO_TO_POSITION',\n    CREATE_POSITION_TREE: 'CREATE_POSITION_TREE',\n    UPDATE_ANALYSIS_STATE: 'UPDATE_ANALYSIS_STATE',\n    EVALUATE_POSITION: 'EVALUATE_POSITION',\n    SET_DEPTH: 'SET_DEPTH',\n    PLAY_MOVES: 'PLAY_MOVES',\n    SET_START_POSITION: 'SET_START_POSITION',\n    REMOVE_PIECE: 'REMOVE_PIECE',\n    START_NEW_LINE: 'START_NEW_LINE',\n    MAKE_NEW_MOVE: 'MAKE_NEW_MOVE',\n} \n\nexport interface MakeNewMoveAction {\n    type: typeof GameAnalysisActions.MAKE_NEW_MOVE,\n    payload: Partial<IMoveProps>\n}\n\nexport interface StartNewLineAction {\n    type: typeof GameAnalysisActions.START_NEW_LINE,\n    payload: IMoveProps\n}\n\nexport interface RemovePieceAction {\n    type: typeof GameAnalysisActions.REMOVE_PIECE,\n    payload: boolean\n}\n\nexport interface PlayMovesAction {\n    type: typeof GameAnalysisActions.PLAY_MOVES,\n    payload: null\n}\n\nexport interface SetDepthAction {\n    type: typeof GameAnalysisActions.SET_DEPTH\n    payload: number\n}\n\nexport interface EvaluatePositionhAction {\n    type: typeof GameAnalysisActions.EVALUATE_POSITION\n    payload: boolean\n}\n\nexport interface UpdateAnalysisStateAction {\n    type: typeof GameAnalysisActions.UPDATE_ANALYSIS_STATE,\n    payload: Partial<IAnalysisState>\n}\n\nexport interface CreatePositionTreeAction {\n    type: typeof GameAnalysisActions.CREATE_POSITION_TREE,\n    payload: Map<string, IBoardToGame>\n}\n\nexport interface SavePositionAction {\n    type: typeof GameAnalysisActions.SAVE_POSITION,\n    payload: Map<string, IBoardToGame>\n}\n\nexport interface GoToPositionAction {\n    type: typeof GameAnalysisActions.GO_TO_POSITION\n    payload: {index: number, move: string}\n}\n\nexport interface StepForwardAction {\n    type: typeof GameAnalysisActions.STEP_FORWARD,\n    payload: number\n}\n\nexport interface StepBackdAction {\n    type: typeof GameAnalysisActions.STEP_BACK,\n    payload: number\n}\n\nexport interface UpdatePositionActions {\n    type: typeof GameAnalysisActions.UPDATE_POSITION,\n    payload: Partial<IMoveProps>\n}\n\nexport interface SettingBoardAction {\n    type: typeof GameAnalysisActions.SETTING_BOARD\n    payload: boolean\n}\n\nexport interface AnalyzeLastGame {\n    type: typeof GameAnalysisActions.ANALYZE_LAST_GAME,\n    payload: boolean\n}\n\nexport interface DownloadGame {\n    type: typeof GameAnalysisActions.DOWNLOAD_GAME,\n    payload: IGameResult\n}\n\nexport interface SaveGameResult {\n    type: typeof GameAnalysisActions.SAVE_GAME_RESULT,\n    payload: IGameResult\n}\n\nexport interface SetStartPositionAction {\n    type: typeof GameAnalysisActions.SET_START_POSITION,\n    payload: null\n}\n\nexport type GameAnalysisTypes = AnalyzeLastGame \n| DownloadGame \n| SaveGameResult \n| SettingBoardAction \n| UpdatePositionActions\n| GoToPositionAction\n| StepForwardAction\n| StepBackdAction\n| SavePositionAction\n| CreatePositionTreeAction\n| UpdateAnalysisStateAction\n| RemovePieceAction\n| StartNewLineAction\n| MakeNewMoveAction\n| SetStartPositionAction\n\n","import { IBoardAndTowers, IMoveProps } from \"../app-interface\";\n\nexport const BoardActions = {\n    CREATE_GAME_BOARD: 'CREATE_GAME_BOARD',\n    CREATE_SETUP_BOARD: 'CREATE_SETUP_BOARD',\n    CREATE_ANALYSIS_BOARD: 'CREATE_ANALYSIS_BOARD',\n    UPDATE_BOARD_STATE: 'UPDATE_BOARD_STATE',\n    UPDATE_BOARD_SIZE: 'UPDATE_BOARD_SIZE',\n    UPDATE_BOARD_MAP: 'UPDATE_BOARD_MAP',\n    TURN: 'TURN',\n    UPDATE_POSITION_TREE: 'CREATE_POSITION_TREE',\n    UNDO_LAST_MOVE: 'UNDO_LAST_MOVE',\n}\n\ninterface UndoLastMoveAction {\n    type: typeof BoardActions.UNDO_LAST_MOVE,\n    payload: null\n}\n\ninterface TurnAction {\n    type: typeof BoardActions.TURN,\n    payload: Partial<IMoveProps>\n}\n\ninterface UpdateBoardStateAction {\n    type: typeof BoardActions.UPDATE_BOARD_STATE,\n    payload: Partial<IBoardAndTowers>\n}\n\ninterface CreateGameBoardAction {\n    type: typeof BoardActions.CREATE_GAME_BOARD,\n    payload: null\n}\n\ninterface CreateAnalysisBoardAction {\n    type: typeof BoardActions.CREATE_ANALYSIS_BOARD\n    payload: null\n}\n\ninterface CreateSetupBoardAction {\n    type: typeof BoardActions.CREATE_SETUP_BOARD\n    payload: null\n}\n\ninterface UpdateBoardSizeAction {\n    type: typeof BoardActions.UPDATE_BOARD_SIZE\n    payload: number\n}\n\nexport type BoardActionTypes = UpdateBoardStateAction\n| CreateAnalysisBoardAction\n| CreateGameBoardAction\n| CreateSetupBoardAction\n| UpdateBoardSizeAction\n| TurnAction\n| UndoLastMoveAction\n","import { GameVariants, PieceColor, Online, IPlayer, Timing, RivalType, GameType } from \"../app-interface\";\n\nexport const GameOptionActions = {\n    CHOOSE_COLOR: 'CHOOSE_COLOR',\n    SET_TIME_LIMIT: 'SET_TIME_LIMIT',\n    SET_TIME_ADDS: 'SET_TIME_ADDS',\n    SET_GAME_TIMING: 'SET_GAME_TIMING',\n    SET_RIVAL: 'SET_RIVAL',\n    SET_PLAYER: 'SET_PLAYER',\n    SET_GAME_VARIANT: 'SET_GAME_VARIANT',\n    SET_RIVAL_ONLINE_STATUS: 'SET_RIVAL_ONLINE_STATUS',\n    SET_PLAYER_ONLINE_STATUS: 'SET_PLAYER_ONLINE_STATUS',\n    SET_GAME_TYPE: 'SET_GAME_TYPE',\n    SET_RIVAL_LEVEL: 'SET_RIVAL_LEVEL',\n    FIND_RIVAL: 'FIND_RIVAL',\n    SET_RIVAL_TYPE: 'SET_RIVAL_TYPE',\n    FINISH_GAME_SETUP: 'FINISH_GAME_SETUP',\n    WAIT_RIVAL: 'WAIT_RIVAL',\n    CANCEL_RIVAL_WAITING: 'CANCEL_RIVAL_WAITING',\n    REMATCH_REQUEST: 'REMATCH_REQUEST',\n};\n\ninterface SetGameTypeAction {\n    type: typeof GameOptionActions.SET_GAME_TYPE,\n    payload: GameType\n}\n\ninterface SetRivalLevelAction {\n    type: typeof GameOptionActions.SET_RIVAL_LEVEL\n    payload: number\n}\n\ninterface RequestRematchAction {\n    type: typeof GameOptionActions.REMATCH_REQUEST,\n    payload: null,\n}\n\ninterface CancelRivalWaitingAction {\n    type: typeof GameOptionActions.CANCEL_RIVAL_WAITING,\n    payload: null\n}\n\ninterface FinishGameSetupAcion {\n    type: typeof GameOptionActions.FINISH_GAME_SETUP\n    payload: boolean\n}\n\ninterface SetOpponentTypeAction {\n    type: typeof GameOptionActions.SET_RIVAL_TYPE\n    payload: RivalType\n}\n\ninterface SetGameTimingAction {\n    type: typeof GameOptionActions.SET_GAME_TIMING,\n    payload: Timing\n}\n\ninterface SetOpponentStatusAction {\n    type: typeof GameOptionActions.SET_RIVAL_ONLINE_STATUS,\n    payload: Online\n}\n\nexport interface SetGameVariantAction {\n    type: typeof GameOptionActions.SET_GAME_VARIANT,\n    payload: GameVariants\n}\n\ninterface SetPlayerAction {\n    type: typeof GameOptionActions.SET_RIVAL,\n    payload: IPlayer\n}\n\ninterface SetPlayerStatusAction {\n    type: typeof GameOptionActions.SET_RIVAL_ONLINE_STATUS,\n    payload: Online\n}\n\nexport interface ChooseColorAction {\n    type: typeof GameOptionActions.CHOOSE_COLOR,\n    payload: PieceColor | 'random'\n}\n\ninterface SetRivalAction {\n    type: typeof GameOptionActions.SET_RIVAL,\n    payload: IPlayer\n}\n\nexport interface FindOpponentAction {\n    type: typeof GameOptionActions.FIND_RIVAL\n}\n\nexport interface WaitRivalAction {\n    type: typeof GameOptionActions.WAIT_RIVAL,\n    payload: boolean\n}\n\nexport type GameOptionActionTypes = SetRivalAction\n| ChooseColorAction\n| SetOpponentStatusAction\n| SetPlayerStatusAction\n| SetPlayerAction\n| SetGameVariantAction\n| SetGameTimingAction\n| SetOpponentTypeAction\n| FinishGameSetupAcion\n| WaitRivalAction\n| CancelRivalWaitingAction\n| RequestRematchAction\n| SetGameTypeAction\n| SetRivalLevelAction\n","import { \n    INeighborCells, \n    TowersMap,\n    PieceColor,\n    TowerConstructor,\n    TowerType,\n    ITowerPosition,\n    IBoardToGame,\n    PartialTower,\n    IBoardOptions,\n    IAnalysisBoard,\n    IGameBoard,\n} from \"../store/app-interface\"\nimport {\n    TopLegendValues,\n    SideLegendValues,\n    BaseCellSize,\n    getDefaultBlackTowersCells,\n    getDefaultWhiteTowersCells\n} from '../constants/gameConstants'\n\nexport const oppositColor = (color: PieceColor) => { return color === PieceColor.w ? PieceColor.b : PieceColor.w }\n\nexport const createEmptyBoard = (size: number = 8) => {\n    const GameBoard: IBoardToGame = {}\n    for(let i = 0; i < size; i++) {\n        for(let j = 0; j < size; j++) {\n            if ((i + j + 1) % 2) {\n                const key = `${TopLegendValues[i]}${SideLegendValues[j]}`;\n                GameBoard[key] = {boardKey: key, tower: null, neighbors: defineNeighborCells(i ,j, size)}\n            }\n        }\n    }\n    return GameBoard\n}\n\nexport const createStartBoardToDraw = (props: {boardOptions: IBoardOptions}): IGameBoard => {\n    const { \n        boardOptions,\n    } = props\n    const {boardSize, reversedBoard} = boardOptions \n    const currentPosition = createStartBoard(boardSize)\n    const positionsTree = new Map()\n    positionsTree.set('sp', currentPosition)\n    return {\n        towers: createDefaultTowers(boardSize),\n        cellSize: BaseCellSize,\n        cellsMap: createCellsMap(boardSize, BaseCellSize, reversedBoard),\n        animationStarted: false,\n        mandatoryMoves: [],\n        moveDone: false,\n        mandatoryMoveStep: 0,\n        currentPosition,\n        mouseDown: false,\n        lastMoveSquares: [],\n        positionsTree\n    }\n}\n\nexport const createEmptyBoardForCustomPosition = (props: {[key: string]: any}): IAnalysisBoard => {\n    const {boardSize, reversedBoard} = props.boardOptions\n    const currentPosition = createEmptyBoard(boardSize)\n    const positionsTree = new Map()\n    positionsTree.set('sp', currentPosition)\n    return {\n        towers: createOutBoardTowers(boardSize),\n        cellSize: BaseCellSize,\n        cellsMap: createCellsMap(boardSize, BaseCellSize, reversedBoard),\n        currentPosition,\n        positionsTree,\n        mandatoryMoves: [],\n        mandatoryMoveStep: 0,\n        mouseDown: false,\n        lastMoveSquares: []\n    }\n}\n\nexport const createAnalysisBoard = (props: {boardOptions: IBoardOptions}): Partial<IAnalysisBoard> => { \n    const {boardOptions: {boardSize, reversedBoard}} = props   \n    return {\n        cellSize: BaseCellSize,\n        cellsMap: createCellsMap(boardSize  as number, BaseCellSize, reversedBoard),\n        mandatoryMoves: [],\n        mandatoryMoveStep: 0,\n        mouseDown: false,\n        lastMoveSquares: [],\n    }\n}\n\nexport const defineCellDomPosition = (key: string, cellSize: number, reversed = false, boardSize = 8) => {\n    const topInd = reversed ? TopLegendValues.slice(0, boardSize).reverse() : TopLegendValues.slice(0, boardSize)\n    const sideInd = reversed ? SideLegendValues.slice(0, boardSize) : SideLegendValues.slice(0, boardSize).reverse()\n    const y = sideInd.indexOf(parseInt(key.slice(1))) * cellSize \n    const x = topInd.indexOf(key[0]) * cellSize\n    return {x, y}\n}\n\nexport const createCellsMap = (boardSize: number, cellSize = BaseCellSize, reversed = false) => {\n    const map = new Map<string, ITowerPosition>()\n    Object.keys(createEmptyBoard(boardSize)).forEach((key: string) => {\n        map.set(key, defineCellDomPosition(key, cellSize, reversed, boardSize))\n    })\n    return map\n}\n\nexport const updateCellsMap = (cellsMap: Map<string, ITowerPosition>, cellSize: number, reversed = false) => {\n    const boardSize = cellsMap.size === 50 ? 10 : 8\n    const newMap = new Map<string, ITowerPosition>()\n    cellsMap.forEach((val: ITowerPosition, key: string) => {\n        newMap.set(key, defineCellDomPosition(key, cellSize, reversed, boardSize))\n    })\n    return newMap\n}\n\nexport function defineNeighborCells(i: number, j: number, size: number): INeighborCells {\n    const topLegend = TopLegendValues.slice(0, size)\n    const sideLegend = SideLegendValues.slice(0, size) \n    const neighbors: INeighborCells = {}\n    if (i) {\n        if (j < size - 1) {\n            neighbors.leftUp = `${topLegend[i - 1]}${sideLegend[j + 1]}` \n        }\n        if (j) {\n            neighbors.leftDown = `${topLegend[i - 1]}${sideLegend[j - 1]}`\n        }\n    }\n    if (i < size - 1) {\n        if (j < size - 1) {\n                neighbors.rightUp = `${topLegend[i + 1]}${sideLegend[j + 1]}` \n            }\n        if (j) {\n            neighbors.rightDown = `${topLegend[i + 1]}${sideLegend[j - 1]}`\n        }\n    }\n    return neighbors\n}\n\nexport const newOnBoardTower = (currentColor: PieceColor, currentType = TowerType.m): PartialTower => {\n    const wPiecesQuantity = currentColor === PieceColor.w ? 1 : 0\n    const bPiecesQuantity = currentColor === PieceColor.b ? 1 : 0\n    return {currentColor, currentType, wPiecesQuantity, bPiecesQuantity}\n}\n\nexport function createStartBoard (boardSize: number): IBoardToGame {\n    const board: IBoardToGame = createEmptyBoard(boardSize)\n    const DBTC = getDefaultBlackTowersCells(boardSize)\n    const DWTC = getDefaultWhiteTowersCells(boardSize)\n    for (let key of Object.keys(board)) {\n        board[key].tower = (DBTC.includes(key) && newOnBoardTower(PieceColor.b))\n        || (DWTC.includes(key) ? newOnBoardTower(PieceColor.w) : null)\n    }\n    return board\n}\n\nconst defaultTowerProps = (cell: string, color: PieceColor, ): TowerConstructor => ({\n    currentType: TowerType.m,\n    currentColor: color,\n    onBoardPosition: cell,\n    bPiecesQuantity: color === PieceColor.w ? 0 : 1,\n    wPiecesQuantity: color === PieceColor.w ? 1 : 0,\n})\n\nexport const createDefaultTowers = (boardSize: number): TowersMap => {\n    const towers = new Map() as TowersMap\n    getDefaultBlackTowersCells(boardSize).forEach((key: string) => {\n        towers.set(key, new TowerConstructor(defaultTowerProps(key, PieceColor.b)))\n    })\n    getDefaultWhiteTowersCells(boardSize).forEach((key: string) => {\n        towers.set(key, new TowerConstructor(defaultTowerProps(key, PieceColor.w)))\n    })\n    return towers\n}\n\nexport const createOutBoardTowers = (boardSize: number): TowersMap => {\n    const towers = new Map() as TowersMap\n    getDefaultBlackTowersCells(boardSize).forEach((key: string, i: number) => {\n        const oBKey = `oB b${i}`\n        towers.set(oBKey, new TowerConstructor(defaultTowerProps(oBKey, PieceColor.b)))\n    })\n    getDefaultWhiteTowersCells(boardSize).forEach((key: string, i: number) => {\n        const oBKey = `oW w${i}`\n        towers.set(oBKey, new TowerConstructor(defaultTowerProps(oBKey, PieceColor.w)))\n    })\n    return towers\n}\n","import { CellTowerRatio } from \"../constants/gameConstants\"\nimport {\n    CellsMap,\n    IBoardOptions,\n    IBoardToDraw,\n    IBoardToGame, \n    IGameBoard, \n    ITowerPosition, \n    PartialTower,\n    PieceColor,\n    TowerConstructor,\n    TowersMap,\n    TowerTouched,\n} from \"../store/app-interface\"\n\nimport {BaseMoveResolver} from './common-fn-moves-resolver'\nimport { copyMap, getCellSize } from \"./gameplay-helper-fuctions\"\nimport { createStartBoard, updateCellsMap } from \"./prestart-help-function-constants\"\n\n\nexport class TowersUpdateResolver extends BaseMoveResolver {\n    currentPosition = createStartBoard(this.size) as IBoardToGame\n    previousPosition = createStartBoard(this.size) as IBoardToGame\n    callBack: Function = () => {}\n\n    setCalBack = (cb: Function) => {\n        this.callBack = cb\n    }\n\n    // animateRivalMove(history: string[], board: IBoardToDraw, reversed: boolean) {\n    //     this.setPositions(board.positionsTree!, history)\n    //     const move = history.slice(-1)[0]\n    //     const mandatory = move.includes(':')\n    //     if (mandatory) {\n    //         return this.animateMadatoryMove(move)\n    //     }\n    //     return this.animateSimpleMove(move, board, reversed)\n    // }\n\n    animateMadatoryMove(move: string) {\n\n    }\n\n    animateSimpleMove(move: string, board: IBoardToDraw, reversed: boolean) {\n       \n    }\n\n    relocateTower(from: string, to: string, board: IGameBoard, reversed: boolean) {\n        const {cellSize, cellsMap} = board\n        const towers = copyMap(board.towers)\n        const tower = towers.get(from) as TowerConstructor\n        tower.positionInDOM = this.calcTowerPosition(to, cellsMap, cellSize, reversed)\n        towers.set(from, tower)\n        console.log(tower)\n        this.callBack({towers})\n    }\n\n    finalizeSimpleMove(from: string, to: string, board: IGameBoard, reversed = false) {\n        const {cellSize, cellsMap} = board\n        const towers = copyMap(board.towers)\n        const tower = towers.get(from) as TowerConstructor\n        tower.onBoardPosition = to\n        tower.currentType = this.checkTowerTypeChanging(to, this.size, tower.currentColor, tower.currentType)\n        tower.positionInDOM = this.calcTowerPosition(to, cellsMap, cellSize, reversed)\n        towers.set(to, tower)\n        towers.delete(from)\n        const towerTouched = null as unknown as TowerTouched\n        const lastMoveSquares = [from, to]\n        this.callBack({towers, towerTouched, lastMoveSquares, mouseDown: false, moveDone: true})\n    }\n\n    finalizeMandatoryMoveStep(from: string, to: string, board: IGameBoard, reversed = false, last = false) {\n        const towers = copyMap(board.towers)\n        const {cellSize, cellsMap} = board\n        const tower = towers.get(from) as TowerConstructor\n        tower.onBoardPosition = to\n        if (this.GV === 'towers') {\n            if (tower!.currentColor === PieceColor.w) {\n                tower.bPiecesQuantity = (tower.bPiecesQuantity as number) + 1\n            } else {\n                tower.wPiecesQuantity = (tower.wPiecesQuantity as number) + 1\n            }\n        }\n        if (this.GV !== 'international' || last) {\n            tower.currentType = this.checkTowerTypeChanging(to, this.size, tower.currentColor, tower.currentType)\n        }\n        tower.positionInDOM = this.calcTowerPosition(to, cellsMap, cellSize, reversed)\n        towers.set(to, tower)\n        towers.delete(from)\n        console.log(tower)\n        return towers\n    }\n\n    setPositions(positionsTree: Map<string, IBoardToGame>, history: string[]) {\n        let currentPositionKey\n        currentPositionKey = history.join('_')\n        const currentPosition = positionsTree?.get(currentPositionKey)!\n        this.previousPosition = {...this.currentPosition}\n        this.currentPosition = currentPosition\n    }\n\n    updateTowersOnMandatoryMoveStep(from: string, to: string, state: IGameBoard, tP: string[], last=false) {\n        const isTowers = this.GV === 'towers'\n        const towers = this.updateTowersAfterMoveAnimation(from, to, state, isTowers, last)\n        if (isTowers) {\n            const middlePieceKey = tP[0]\n            const middlePiece = towers.get(middlePieceKey) as PartialTower\n            const takenTower = this.cuptureTower(middlePiece) as TowerConstructor\n            if (!takenTower) {\n                towers.delete(middlePieceKey)\n            } else {\n                towers.set(middlePieceKey, takenTower)\n            }\n            return towers\n        } else if (last) {\n            console.log(towers, tP)\n            tP.forEach((key: string) => {\n                towers.delete(key)\n            })\n            return towers\n        }\n        return towers\n    }\n\n    updateTowersToBoard(board: IBoardToGame): TowersMap {\n        const towers = new Map() as TowersMap\n        Object.keys(board).forEach((key: string) => {\n            let tower = board[key].tower as TowerConstructor\n            if (tower) {\n                const _tower = new TowerConstructor(tower)\n                _tower.onBoardPosition = key\n                towers.set(key, _tower)\n            }\n        })\n        return towers\n    }\n    \n    updateMiddleTowerOnOpponentMove(key: string, state: IGameBoard, board: IBoardToGame) {\n        const towers = copyMap(state.towers) as TowersMap\n        const takenTower = board[key]!.tower as PartialTower\n        if (takenTower) {\n            const newMiddleTower = {...towers.get(key), ...takenTower} as TowerConstructor;\n            towers.set(key, newMiddleTower)\n        } else {\n            towers.delete(key)\n        }\n        console.log('middle update', key, towers, board, takenTower)\n        return towers\n    }\n\n    updateTowersAfterMoveAnimation(from: string, to: string, board: IBoardToDraw, wT=false, last=false): TowersMap {\n        const {cellSize, cellsMap} = board\n        const towers = copyMap(board.towers!) as TowersMap\n        const tower = towers.get(from) as TowerConstructor\n        if (wT) {\n            if (tower!.currentColor === PieceColor.w) {\n                tower.bPiecesQuantity = (tower.bPiecesQuantity as number) + 1\n            } else {\n                tower.wPiecesQuantity = (tower.wPiecesQuantity as number) + 1\n            }\n        }\n        tower!.onBoardPosition = to\n        tower!.positionInDOM = this.calcTowerPosition(to, cellsMap!, cellSize!)\n        if (this.GV !== 'international' || last) {\n            tower.currentType = this.checkTowerTypeChanging(to, this.size, tower.currentColor, tower.currentType)\n        }\n        towers.set(to, tower)\n        towers.delete(from)\n        return towers\n    }\n\n    animateRivalTowerMove(from: string, to: string, state: IGameBoard) {\n        const {cellsMap, cellSize} = state\n        const towers = copyMap(state.towers)\n        const opponentTower = towers.get(from) as TowerConstructor\n        opponentTower.positionInDOM = this.calcTowerPosition(to, cellsMap, cellSize)\n        return {...state, towers}\n    }\n\n    calcPositionOutboardTowers = (key: string, cellSize: number, reversed: boolean) => {\n        const boardElem = document.querySelector('.board__body')\n        const boardHeight = Math.round(boardElem!.getBoundingClientRect().height)\n        const towerWidth = CellTowerRatio * cellSize\n        const dY = Math.round(cellSize / 2 - towerWidth / 2)\n        const bottom = Math.round(boardHeight - cellSize / 2 - towerWidth / 2)\n        const x = Math.round(-5 - cellSize + dY)\n        return (reversed && key.includes('oB')) || (!reversed && key.includes('oW'))\n                ? {x, y: bottom}\n                : {x, y: dY}\n    }\n\n    calcTowerPosition = (key: string, map: CellsMap, cellSize: number, reversed = false): ITowerPosition => {\n        if (key.includes('oB') || key.includes('oW')) {\n            return this.calcPositionOutboardTowers(key, cellSize, reversed) as ITowerPosition\n        }\n        const cellPosition = map.get(key) as ITowerPosition\n        if (!cellPosition) return  {x: 0, y: 0}\n        const {x, y} = cellPosition\n        const towerElem = document.querySelector('.checker-tower')\n        if (!towerElem) {\n            console.error(towerElem)\n        }\n        const {width} = towerElem!.getBoundingClientRect()\n        return {x: Math.round(x - width / 2 + cellSize / 2), y: Math.round(y - width / 2  + cellSize/2)}\n    }\n\n    cancelTowerTransition(props: IGameBoard & {reversed?: boolean}) { \n        const {key} = props.towerTouched as TowerTouched\n        const {cellSize, cellsMap, reversed = false} = props\n        const towers = copyMap(props.towers) as TowersMap\n        const tower = towers.get(key) as TowerConstructor\n        tower.positionInDOM = this.calcTowerPosition(key, cellsMap, cellSize, reversed)\n        towers.set(key, tower)\n        this.callBack({...props, towers, towerTouched: null as unknown as TowerTouched, mouseDown: false})\n    }\n\n    updateTowersPosition = (cellSize: number, towers: TowersMap, map: CellsMap, reversed = false): TowersMap => {\n        const _towers = copyMap(towers)\n        towers.forEach((val: TowerConstructor, key: string) => {\n            const positionInDOM = this.calcTowerPosition(key, map, cellSize, reversed)\n            const tower = {...val, positionInDOM, onBoardPosition: key}\n            _towers.set(key, tower)\n        })\n        return _towers\n    }\n\n    updateCellsPosition = (board: IBoardToDraw, boardOptions: IBoardOptions, boardRef: HTMLDivElement) => {\n        const {cellsMap, cellSize, towers} = board\n        const {reversedBoard, boardSize} = boardOptions\n        const newCellSize = getCellSize(boardRef, boardSize);\n        if (cellSize === newCellSize) return\n        const newCellMap = updateCellsMap(cellsMap as CellsMap, newCellSize, reversedBoard)\n        const newTowers = this.updateTowersPosition(newCellSize, towers, newCellMap, reversedBoard)\n        // console.log(newTowers, towers)\n        this.callBack({towers: newTowers, cellsMap: newCellMap, cellSize: newCellSize})\n    }\n}\n\nconst tur = new TowersUpdateResolver()\n\nexport default tur\n","import { BoardNotation, IBoardOptions } from \"../app-interface\";\n\nexport const BoardOptionActions = {\n    SET_GAME_BOARD_OPTIONS: 'SET_GAME_BOARD_OPTIONS',\n    REVERSE_BOARD: 'REVERSE_BOARD',\n    SET_BOARD_THEME: 'SET_BOARD_THEME',\n    SET_BOARD_NOTATION: 'SET_BOARD_NOTATION',\n    SET_BOARD_SIZE: 'SET_BOARD_SIZE'\n}\n\ninterface SetBoardSizeAction {\n    type: typeof BoardOptionActions.SET_GAME_BOARD_OPTIONS\n    payload: number\n}\n\ninterface UpdateBoardOptionsAction {\n    type: typeof BoardOptionActions.SET_GAME_BOARD_OPTIONS\n    payload: Partial<IBoardOptions>\n}\n\nexport interface ReverseBoardAction {\n    type: typeof BoardOptionActions.REVERSE_BOARD\n    payload: boolean\n}\n\ninterface SetBoardThemeAction {\n    type: typeof BoardOptionActions.SET_BOARD_THEME\n    payload: string\n}\n\ninterface SetBoardNotationAction {\n    type: typeof BoardOptionActions.SET_BOARD_THEME\n    payload: BoardNotation\n}\n\nexport type BoardOptionActionTypes = UpdateBoardOptionsAction\n| SetBoardThemeAction\n| ReverseBoardAction\n| SetBoardNotationAction\n| SetBoardSizeAction\n","export const I18n: {[key:string]: any} = {\n    en: {\n        shortMainTitle: 'Draughts',\n        mainTitle: 'Tower Draughts',\n        newGame: 'New game',\n        submitLog: 'Login',\n        submitReg: 'Registration',\n        logTitle: 'Login',\n        regTitle: 'Registration in',\n        logMess: 'Please enter Nikname or email and password',\n        regMess : 'Please fiil registration form',\n        modeButtonLog: 'Do not have registred yet?',\n        modeButtonReg: 'Login',\n        labelPassword: 'Password',\n        labelNickname: 'Nickname or email',\n        submitButton: 'Submit',\n        about: 'Welcom to Tower-Draughts where, in addition to the classic Russian and international draughts, for the first time, the opportunity to play tower draughts has been implemented - one of the most interesting variants of the checkers game.',\n        about_continue: \"The rules of tower's draughts coincide in many respects with the rules of the Russians. The most important difference is that the knocked down checker is not removed from the board but is covered with a hitting checker (a tower of checkers) .In the case when a tower is under attack, one return checker is removed from its top and, if it is the only one of its color, the tower changes color and becomes the enemy's tower. In case of turning into a king, only the top man becomes the king. Another important difference from Russian draughts is the lack of restrictions on capture on previously passed fields (Turkish strike). You can find more information about the game on Wikipedia by clicking on the picture above.\",\n        play: \"Play\"\n    },\n    ru: {\n        shortMainTitle: '',\n        mainTitle: ' ',\n        newGame: ' ',\n        submitLog: '',\n        submitReg: '',\n        logTitle: '  ',\n        regTitle: '  ',\n        logMess: '     email  ',\n        regMess : '   ',\n        modeButtonLog: '  ?',\n        modeButtonReg: '  ',\n        labelPassword: '',\n        labelNickname: '   email',\n        submitButton: '',\n        about: '   Tower Draughts,   :    ,         -       .',\n        about_continue: '        .     ,            (  )  ,     ,       ,     ,        .     ,     .                 ( ).             .',\n        play: \"\"\n    }\n}","import React from 'react';\nimport './spinner.scss';\n/**\n * This component designed to show to user, that game data loading is in process\n * and used in the landing page and game.\n * Spinner's animation implemented with css.\n */\n\nconst Spinner = props => {\n    return (\n        <div className=\"waiting-rival-spinner\" onClick={() => props.cancelRivalWaiting()}>\n            <div title=\"cancel\" className=\"logo\"></div>\n        </div>\n    );\n};\n\nexport default Spinner;\n","import { BaseBoardSize } from \"../constants/gameConstants\";\nimport { \n    CellsMap,\n    GameVariants,\n    IBoardCell,\n    IBoardToGame,\n    IDaigonals,\n    IGameState,\n    IMoveOrder,\n    IMoveProps,\n    ITowerPosition,\n    PartialTower,\n    PieceColor,\n    TowerConstructor,\n    TowersMap,\n    TowerType \n} from \"../store/app-interface\"\nimport {  copyObj, crossDirections, oppositColor } from \"./gameplay-helper-fuctions\";\nimport { createEmptyBoard } from \"./prestart-help-function-constants\";\n\nexport class BaseMoveResolver {\n    GV: GameVariants = 'towers'\n    size: number = BaseBoardSize\n\n    setProps = (props: {GV: GameVariants, size: number}) => {\n        this.GV = props.GV\n        this.size = props.size\n    }\n\n    checkTowerTypeChanging(to: string, boardSize: number, color: PieceColor, type: TowerType): TowerType {\n        if ((parseInt(to.slice(1)) === boardSize && color === PieceColor.w)\n            || (parseInt(to.slice(1)) === 1 && color === PieceColor.b)) {\n            return TowerType.k\n        } \n        return type\n    }\n\n    getCapturedPieceKey = (from: string, to: string, board: IBoardToGame): string => {\n        const interval = this.getInterval(from, to, board)\n        const key = interval.filter(c => c.tower)[0]\n        if (key) return key.boardKey\n        console.error(`invalid move - tower to take did not find ${from}:${to}`, board);\n        return ''\n    }\n\n    getInterval(start: string, end: string, board: IBoardToGame): IBoardCell[] {\n        if (board[end].tower) {\n            console.error('board', board, start, end)\n        }\n        const dir = this.getMoveDirection([start, end])\n        let cell = board[start]\n        const interval = []\n        while(true) {\n            const nextCellKey = cell!.neighbors[dir]\n            if (!nextCellKey || nextCellKey === end) break\n            cell = board[nextCellKey]\n            interval.push(cell)\n        } \n        return interval\n    }\n\n    getDiagonal(direction: string, startCellKey: string, board: IBoardToGame): IBoardCell[] {\n        let cell = board[startCellKey]\n        const diagonal = [cell]\n        while (cell) {\n            const nextCellKey = cell!.neighbors[direction]\n            if (nextCellKey) {\n                const nextCell = board[nextCellKey]\n                diagonal.push(nextCell)\n                cell = nextCell\n            } else {\n                break\n            }\n        }\n        return diagonal;\n    }\n\n    getDiagonals(cell: string, board:  IBoardToGame, preDirected = ''): IDaigonals {\n        const neighbors = board[cell]!.neighbors\n        const diagonals = {} as IDaigonals\n        const availibleDirections = (d: string) => (!!preDirected ? crossDirections(preDirected)[d] : true)\n        Object.keys(neighbors).filter((d: string) => availibleDirections(d)).forEach((dir: string) => {\n            diagonals[dir] = this.getDiagonal(dir, cell, board)\n        })\n        return diagonals\n    }\n\n    getMoveDirection(move: string[]): string {\n        const [from, to] = move\n        if (from[0] > to[0]) {\n            if (parseInt(from.slice(1)) > parseInt(to.slice(1))) {\n                return 'leftDown'\n            }else {\n                return 'leftUp'\n            }\n        } else {\n            if (parseInt(from.slice(1)) > parseInt(to.slice(1))) {\n                return 'rightDown'\n            } else {\n                return 'rightUp'\n            }\n        }\n    }\n\n    cuptureTower = (tower: PartialTower): PartialTower | null => {\n        if (this.GV !== 'towers') {\n            return null as unknown as PartialTower\n        }\n        const {currentColor, bPiecesQuantity, wPiecesQuantity} = tower\n        const white = currentColor === PieceColor.w\n        const newTower = {\n           ...tower,\n            currentType: TowerType.m,\n            wPiecesQuantity: white ? (wPiecesQuantity as number) - 1 : wPiecesQuantity,\n            bPiecesQuantity: white ? bPiecesQuantity : (bPiecesQuantity as number) - 1,\n        }\n        if (!newTower.bPiecesQuantity && !newTower.wPiecesQuantity) {\n            return null as unknown as PartialTower\n        } else {\n            if (white && !newTower.wPiecesQuantity) {\n                newTower.currentColor = PieceColor.b\n            } else if (!white && !newTower.bPiecesQuantity) {\n                newTower.currentColor = PieceColor.w\n            }\n        }\n        return newTower\n    }\n}\n\nexport class MoveResolveCommons extends BaseMoveResolver {\n\n    checkNeighborsIsEmpty(key: string, board: IBoardToGame, color: PieceColor): string[] {\n        return Object.values(board[key].neighbors).filter((cellKey: string) => {\n            const condition = color === PieceColor.w\n                ? parseInt(key.slice(1)) < parseInt(cellKey.slice(1)) \n                : parseInt(key.slice(1)) > parseInt(cellKey.slice(1))\n            return condition  && !board[cellKey]!.tower\n        }).map((fN: string) => `${key}-${fN}`)\n    }\n\n    lookForTowerFreeMoves = (boardKey: string, board: IBoardToGame, color: PieceColor): string[] => { \n        const tower = board[boardKey].tower\n        if (tower!.currentType === TowerType.m) {\n            return this.checkNeighborsIsEmpty(boardKey, board, color)\n        } else {\n            return this.lookForKingFreeMoves(boardKey, board)\n        }\n    }\n\n    lookForAllPosibleMoves = (color: PieceColor, board: IBoardToGame): string[] => {\n        let result: string[] = []\n        for (let key of Object.keys(board)) {\n            const cell = board[key]\n            if(cell.tower?.currentColor === color) {\n                const moves = this.lookForTowerFreeMoves(key, board, color)\n                if (moves.length) {\n                    result = [...result, ...moves]\n                }\n            }\n        }\n        return result\n    }\n\n    getCapturedTowers(move: string[], position: IBoardToGame, tP: string[] = [], i = 0): string[] {\n        const moveLength = move.length\n        if (moveLength < 2) return tP\n        tP.push(this.getCapturedPieceKey(move[i], move[i+1], position))\n        if (moveLength === 2 || i === moveLength - 2) {\n            return tP\n        }\n        i += 1\n        return this.getCapturedTowers(move, position, tP, i)\n    }\n\n    getFromToKeys = (moveArr: string[], board: IBoardToGame): string[] => {\n        let i = 0\n        while(i < moveArr.length) {\n            if(board[moveArr[i]].tower) {\n                const repetition = moveArr.lastIndexOf(moveArr[i])\n                if (repetition  < 0) {\n                    return moveArr.slice(i)\n                } else if (moveArr.slice(repetition).length > 1) {\n                    return moveArr.slice(repetition)\n                } else {\n                    return []\n                }\n            }\n            i++\n        }\n        throw Error('start tower in move not found')\n    }\n\n    makeMoveWithoutTakingPieces = (move: string[], board: IBoardToGame): IBoardToGame => {\n        const _board = copyObj(board)\n        const nextMoves = this.getFromToKeys(move, board)\n        const [from, to] = [nextMoves[0], nextMoves.slice(-1)[0]]\n        if (from !== to) {\n            const fromTower = {..._board[from].tower}\n            const whiteMove = fromTower.currentColor === PieceColor.w\n            if (this.checkLastLine(to, whiteMove) && this.GV !== 'international') {\n                fromTower.currentType = TowerType.k\n            }\n            _board[to].tower = fromTower\n            _board[from].tower = null\n        }\n\n        if (!_board[to]?.tower) {\n            console.error('error on board', move, _board, board)\n        }\n        if (_board[from].tower && !_board[to].tower?.currentColor) {\n            console.error('board was updated incorrectly whithout taken', move, _board, board)\n        }\n        return _board\n    }\n\n    getBoardFromTowers = (towers: TowersMap): IBoardToGame => {\n        const board = createEmptyBoard(this.size)\n        towers.forEach((value: TowerConstructor, key: string) => {\n            const {wPiecesQuantity, bPiecesQuantity, currentColor, currentType} = value\n            if (!key.includes(' ')) {\n                 board[key].tower = {wPiecesQuantity, bPiecesQuantity, currentColor, currentType}\n            }\n        })\n        return board\n    }\n    \n    getNewOrder = (props: Partial<IGameState>): IMoveOrder => {\n        const newPieceOrder = oppositColor(props.moveOrder!.pieceOrder)\n        const moveOrder = {\n            pieceOrder:  newPieceOrder,\n            playerTurn: props[newPieceOrder]!.name,\n        }\n        return moveOrder\n    }\n\n    getPropsToMakeFreeMove = (from: string, to: string, props: {[key: string]: any}): IMoveProps => {\n        const newPieceOrder = oppositColor(props.moveOrder!.pieceOrder)\n        const moveOrder = {\n            pieceOrder:  newPieceOrder,\n            playerTurn: props[newPieceOrder]!.name,\n        }\n        const position = this.makeFreeMove(from, to, props.currentPosition!)\n        return {moveOrder, moveToSave: {move: `${from}-${to}`, position}}\n    }\n\n    makeFreeMove(from: string, to: string, board: IBoardToGame): IBoardToGame {\n        const newBoard = copyObj(board)\n        if (!newBoard[from]) {\n            console.error('makeFreeMove invalid props', from, to, board)\n        }\n        const tower = {...newBoard[from].tower as TowerConstructor}\n        const boardSize = Math.sqrt(Object.keys(board).length * 2)\n        tower.currentType = this.checkTowerTypeChanging(to, boardSize, tower.currentColor, tower.currentType)\n        newBoard[to].tower = tower\n        newBoard[from].tower = null\n        return newBoard\n    }\n\n    checkDiagonalForKingMove(diag: IBoardCell[]) {\n        const startCellKey = diag[0].boardKey\n        const moves = [] as string[]\n        for (let cell of diag.slice(1)) {\n            if (cell.tower) break\n            moves.push(`${startCellKey}-${cell.boardKey}`)\n        }\n        return moves\n    }\n\n    manTowerFreeMoves = (tower: TowerConstructor, board: IBoardToGame, cellsMap: CellsMap) => {\n        const key = tower.onBoardPosition\n        const color = tower.currentColor\n        const posibleMoves =  new Map() as CellsMap\n        const cellNeighbors = board![key]!.neighbors\n        Object.values(cellNeighbors!).forEach((k: string) => {\n            const cell = board![k] \n            const [towerLine, neighborLine] = [parseInt(key.slice(1)), parseInt(k.slice(1))]\n            if ((color === PieceColor.b && !cell!.tower && towerLine > neighborLine)\n                || (color === PieceColor.w && !cell!.tower && towerLine < neighborLine)) {\n                posibleMoves.set(k, cellsMap!.get(k) as ITowerPosition)\n            }\n        })\n        return posibleMoves\n    }\n\n    checkLastLine(to: string, whiteMove: boolean): boolean {\n        const currentLine = parseInt(to.slice(1))\n        return (whiteMove && currentLine === this.size) || (!whiteMove && currentLine === 0)\n    }\n\n    lookForKingFreeMoves(cellKey: string, board: IBoardToGame): string[] {\n        const diagonals = this.getDiagonals(cellKey, board)\n        let moves = [] as string[]\n        Object.values(diagonals).forEach((diag: IBoardCell[]) => {\n            moves = moves.concat(this.checkDiagonalForKingMove(diag))\n        })\n        return moves\n    }\n\n    kingTowerFreeMoves = (key: string, board: IBoardToGame, cellsMap: CellsMap): CellsMap => {\n        const moves = this.lookForKingFreeMoves(key, board)\n        const posibleMoves = new Map() as CellsMap\n        moves.forEach((m: string) => {\n            const moveSteps = m.split('-')\n            const cellKey = moveSteps[moveSteps.length - 1]\n            posibleMoves.set(cellKey, cellsMap.get(cellKey) as ITowerPosition)\n        })\n        return posibleMoves\n    }\n\n    makeMandatoryMove = (move: string[], board: IBoardToGame): IBoardToGame => {\n        if (move.length < 2) console.error(`makeObligatedMove: incorrect move length`)\n        const nextMove = this.getFromToKeys(move, board)\n        if (!nextMove.length) {\n            return board\n        }\n        if (nextMove.length === 2) {\n            return this.makeMandatoryMoveStep(nextMove, board, true)\n        }\n        const newBoard = this.makeMandatoryMoveStep(nextMove as string[],board)\n        return this.makeMandatoryMove(nextMove.slice(1), newBoard)\n    }\n\n    updateBoardOnMandatoryMoveStep = (move: string[], board: IBoardToGame): IBoardToGame => {\n        if (this.GV === 'towers') {\n            return this.makeMandatoryMove(move, board)\n        }\n        return this.makeMoveWithoutTakingPieces(move, board)\n    }\n\n    makeMandatoryMoveStep = (move: string[], board: IBoardToGame, last=false): IBoardToGame => {\n        const newBoard = copyObj(board)\n        const [from, to] = move\n        if (from === to || !to || !from) {\n            console.error('error in step', move, board)\n        }\n        const tower = copyObj(board[from])!.tower as TowerConstructor\n        let middlePieceKey = this.getCapturedPieceKey(from, to, board)\n        const newMiddleTower = this.cuptureTower(newBoard[middlePieceKey].tower)\n        if (!tower || !middlePieceKey) {\n            console.error('invalid board:', JSON.stringify(board), 'move:', move)\n            return board\n        }\n        if (this.GV === 'towers') {\n            if (tower.currentColor === PieceColor.w) {\n                tower.bPiecesQuantity! += 1\n            } else {\n                tower.wPiecesQuantity! += 1\n            }\n        }\n        newBoard[from]!.tower = null\n        newBoard[middlePieceKey].tower = newMiddleTower\n        if (this.GV !== 'international' || last) {\n            tower.currentType = this.checkTowerTypeChanging(to, this.size, tower.currentColor, tower.currentType)\n           \n        }\n        newBoard[to]!.tower = tower as PartialTower\n        if (newBoard[move[0]].tower || !newBoard[move[1]].tower?.currentColor) {\n            console.error('board was updated incorrectly', move, newBoard, board)\n        }\n        return newBoard\n    }\n}\n","import { IBoardToGame, IBoardCell, IDaigonals, IMMRResult, PieceColor } from \"../store/app-interface\"\nimport {MoveResolveCommons as MRC} from \"./common-fn-moves-resolver\" \n\n\nexport class KingMandatoryMoveResolver extends MRC {\n\n    checkKingMandatoryMoves(cell: IBoardCell, board: IBoardToGame): IMMRResult[] {\n        let moves = [] as IMMRResult[]\n        moves = this.checkFirstKingDiagonals(cell, board)\n        if (!moves.length) {\n            return moves\n        }\n        return this.checkKingNextSteps(moves)\n    }\n\n    checkFirstKingDiagonals(cell: IBoardCell, board: IBoardToGame): IMMRResult[] {\n        let moves = [] as IMMRResult[]\n        const diagonals = this.getDiagonals(cell!.boardKey, board)\n        Object.values(diagonals)\n        .forEach((diag: IBoardCell[]) => {\n            const firstMove = {move: `${cell.boardKey}`, position: board, takenPieces: []}\n            const _moves = this.checkDiagonalToMadatoryMove(diag, firstMove)\n            if (_moves.length) {\n                moves = [...moves, ..._moves]\n            }\n        })\n        return moves\n    }\n\n    checkKingNextSteps(moves: IMMRResult[], cM: IMMRResult[] = []): IMMRResult[] {\n        let movesToCheckContinue: IMMRResult[] = []\n        let compleatedMoves = cM\n        moves.forEach((m: IMMRResult) => {\n            const nextStepResult = this.checkNextMoveStepDirections(m)\n            if (nextStepResult.length) {\n                movesToCheckContinue = movesToCheckContinue.concat(nextStepResult)\n            } else if (moves.filter(_m => _m.move.startsWith(m.move)).length === 1) {\n                compleatedMoves = compleatedMoves.concat(m)\n            }\n        })\n        // console.log(movesToCheckContinue)\n        if (!movesToCheckContinue.length) {\n            return compleatedMoves\n        } else {\n            return this.checkKingNextSteps(movesToCheckContinue, compleatedMoves)\n        }\n    }\n\n    checkIfDiagonalNotFit(diag: IBoardCell[], color: PieceColor): boolean {\n        return diag.length < 3\n            || !diag.filter((cell: IBoardCell) => cell.tower?.currentColor !== color).length\n            || diag[1].tower?.currentColor === color\n            || diag[2].tower?.currentColor === color\n    }\n\n    checkDiagonalToMadatoryMove(diag: IBoardCell[], move: IMMRResult): IMMRResult[] {\n        const color = diag[0].tower!.currentColor\n        let resultMoves = [] as IMMRResult[]\n        if (this.checkIfDiagonalNotFit(diag, color as PieceColor)) {\n            return resultMoves\n        }\n        let i = 1\n        while (i <  diag.length - 1) {\n            const tower = diag[i].tower\n            const nextCell = diag[i+1]\n            if (tower?.currentColor === color || (tower && nextCell.tower)) {\n                break\n            } \n            const takenPiece = diag[i].boardKey\n            const to = nextCell.boardKey\n            const notTaken = !move.takenPieces?.includes(takenPiece)\n            if (tower && !nextCell.tower && tower.currentColor !== color && notTaken) {\n                if (!resultMoves.length) {\n                    const nMove = `${move.move}:${to}`\n                    const position = this.updateBoardOnMandatoryMoveStep(nMove.split(':'), move.position)\n                    const takenPieces = [...move.takenPieces!, takenPiece]\n                    resultMoves.push({ move: nMove, position, takenPieces})\n                } else {\n                    const last = resultMoves.slice(-1)[0]\n                    const takenPieces = [...last.takenPieces!, takenPiece]\n                    const nMove = `${last.move}:${to}`\n                    const position = this.updateBoardOnMandatoryMoveStep(nMove.split(':'), last.position)\n                    resultMoves.push({move: nMove, position, takenPieces})\n                }\n                i += 2 \n            } else {\n                if (!tower && resultMoves.length) {\n                    const start = resultMoves[0].move!.split(':').slice(0, -1).join(':')\n                    const takenPieces = resultMoves[0].takenPieces\n                    const nMove = `${start}:${diag[i].boardKey}`\n                    const position = this.updateBoardOnMandatoryMoveStep(nMove.split(':'), move.position)\n                    resultMoves.push({move: nMove, position, takenPieces})\n                }\n                i += 1\n            }\n        }\n        const lastCell = diag[i]\n        if (i === diag.length - 1 && !lastCell.tower && resultMoves.length) {\n            if (!resultMoves.filter((m: IMMRResult) => m.move.includes(lastCell.boardKey)).length) {\n                const start = resultMoves[0].move!.split(':').slice(0, -1).join(':')\n                const takenPieces = resultMoves[0].takenPieces\n                const nMove = `${start}:${lastCell.boardKey}`\n                const position = this.updateBoardOnMandatoryMoveStep(nMove.split(':'), move.position)\n                resultMoves.push({move: nMove, position, takenPieces})\n            }\n        }\n       \n        return resultMoves\n    }\n\n    checkNextMoveStepDirections(move: IMMRResult): IMMRResult[] {\n        const moveArr = move.move.split(':').slice(-2)\n        const cellKey = moveArr[1]\n        const direction = this.getMoveDirection(moveArr)\n        const board = move.position\n        if (!board || !board[move.move.split(':').slice(-1)[0]].tower) {\n            console.error('error in move', move)\n        }\n        const diagonals = this.getDiagonals(cellKey, board, direction) as IDaigonals\n        let result = [] as IMMRResult[]\n        Object.values(diagonals).forEach((diag: IBoardCell[]) => {\n            if (!diag[0].tower) {\n                console.error('invalid diagonal', diag, move)\n            }\n            const moves = this.checkDiagonalToMadatoryMove(diag, move)\n            if (moves.length) {\n                result = [...result, ...moves]\n            }\n        })\n        return result \n    }\n}\n\nconst kmmr = new KingMandatoryMoveResolver()\n\nexport default kmmr\n","import { PieceColor, IBoardToGame, TowerType, IBoardCell, IMMRResult } from '../store/app-interface'\nimport { filterArrayByLength, copyObj, oppositColor } from './gameplay-helper-fuctions'\nimport { KingMandatoryMoveResolver as KMMR} from './king-mandatory-move-resolver'\nimport { createStartBoard } from './prestart-help-function-constants'\n\n\nexport class MandatoryMovesResolver extends KMMR{\n    gameVariantMoveContinueRestriction() {\n        if (this.GV === 'international') return false\n        return true\n    }\n\n    makeMoves(moves: string[], board = createStartBoard(this.size)): IBoardToGame {\n        let nBoard: IBoardToGame = copyObj(board)\n        let step = 0\n        while(step < moves.length) {\n            const move = moves[step]\n            if (move.includes('-')) {\n                const [from, to] = move.split('-')\n                nBoard[to].tower = board[from].tower\n                nBoard[from].tower = null\n            } else if (move.includes(':')) {\n                nBoard = this.makeMandatoryMove(move.split(':'), board)\n            }\n            step += 1\n        }\n        return nBoard\n    }\n\n    lookForAllMoves = (color: PieceColor, board: IBoardToGame): IMMRResult[] => {\n        const mandatoryMoves = this.lookForMandatoryMoves(color, board)\n        if (mandatoryMoves.length) {\n            return mandatoryMoves\n        } \n        return this.lookForAllPosibleMoves(color, board).map((m: string) => {\n            const [from, to] = m.split('-')\n            return {move: m, position: this.makeFreeMove(from, to, board)}\n        })\n    }\n\n    checkMandatoryMoveNextStep = (move: IMMRResult): IMMRResult[] => {\n        // console.log('move', move.move)\n        const moveArray = move.move.split(':')\n        const [from, to] = moveArray.slice(moveArray.length - 2)\n        const board = move.position\n        const cell = board[to]\n        const neighbors = cell.neighbors\n        const nextMoves: IMMRResult[] = []\n        const exludedDirection = this.getMoveDirection([to, from])\n        Object.keys(neighbors).filter((dir: string) => (\n                dir !== exludedDirection\n        )).forEach((dir: string) => {\n            if (!cell.tower) {\n                console.error('checkManMoveNextStep invalid start cell', move, board, cell, dir)\n            }\n            const nMove = this.checkManDirection(cell, dir, move)\n            if (nMove) {\n                nextMoves.push(nMove)\n            }\n        })\n        return nextMoves\n    }\n\n    checkManFristMandatoryStep(cell: IBoardCell, board: IBoardToGame): IMMRResult[] {\n        const moves = [] as IMMRResult[]\n        Object.keys(cell!.neighbors).forEach((dir: string) => {\n            const startProps = {move: '', position: board, takenPieces: [], currentPosition: cell.boardKey}\n            const move = this.checkManDirection(cell, dir, startProps)\n            if (move) {\n                moves.push(move)\n            }\n        })\n        // console.log(moves)\n        return moves\n    }\n\n    checkManMandatoryMoves(cell: IBoardCell, board: IBoardToGame): IMMRResult[] {\n        let result = [] as IMMRResult[]\n        result = this.checkManFristMandatoryStep(cell, board)\n        if (!result.length) {\n            return result\n        }\n        return this.checkMandatoryMoveNextSteps(result)\n    }\n\n    checkManDirection(cell: IBoardCell, dir: string, preMove: IMMRResult): IMMRResult {\n        if (!cell.tower) {\n            console.error('cod invalid start cell', cell, preMove, dir)\n        }\n        const board = preMove.position\n        const neighborCell = board[cell!.neighbors[dir]]\n        const takenPiece = neighborCell.boardKey\n        if (this.GV !== 'towers' && preMove.move.length && preMove.takenPieces!.includes(takenPiece)) {\n            return null as unknown as IMMRResult\n        } else if (neighborCell?.tower?.currentColor === oppositColor(cell!.tower!.currentColor!)) {\n            const nextCellKey = neighborCell.neighbors[dir]\n            if(nextCellKey && !board[nextCellKey].tower) {\n                const move = !preMove.move.length \n                    ? `${cell?.boardKey}:${nextCellKey}` \n                    : `${preMove.move}:${nextCellKey}`\n                if (move.split(':').length < 2) {\n                    console.error('move too short', move)\n                }\n                const position = this.updateBoardOnMandatoryMoveStep(move.split(':'), board)\n                const takenPieces = [...preMove.takenPieces!, takenPiece]\n                return {move, takenPieces, position}\n            }\n        }\n        return null as unknown as IMMRResult\n    }\n\n    checkMandatoryMoveNextSteps = (moves: IMMRResult[], cM = [] as IMMRResult[]): IMMRResult[] => {\n        let compleatedMoves = cM as IMMRResult[]\n        let movesToCheckContinue = [] as IMMRResult[]\n        moves.forEach((mr: IMMRResult) => {\n            const board = mr.position\n            const currrentSquare = mr.move.split(':').slice(-1)[0]\n            if (board[currrentSquare].tower?.currentType === TowerType.k \n                && this.gameVariantMoveContinueRestriction()) {\n                const nextMoves = this.checkKingNextSteps([mr])\n                if (nextMoves.length) {\n                    compleatedMoves = compleatedMoves.concat(nextMoves)\n                } else {\n                    compleatedMoves.push(mr) \n                }\n            } else {\n                const nextMoves = this.checkMandatoryMoveNextStep(mr)\n                if (nextMoves.length) { \n                    movesToCheckContinue = movesToCheckContinue.concat(nextMoves)\n                } else if (this.GV !== 'international') {\n                    if (!compleatedMoves.filter(m => m.move.startsWith(mr.move)).length) {\n                        compleatedMoves.push(mr)\n                    }\n                    \n                }\n            }\n        })\n        if (!movesToCheckContinue.length) {\n            return compleatedMoves\n        } else {\n            return this.checkMandatoryMoveNextSteps(movesToCheckContinue, compleatedMoves)\n        }\n    }\n\n    removeTakenPieces = (move: IMMRResult) => {\n        const {takenPieces} = move\n        const position = copyObj(move.position)\n        takenPieces!.forEach(key => {\n            position[key].tower = null\n        })\n        return {...move, position}\n    }\n\n    lookForMandatoryMoves = (color: PieceColor, board: IBoardToGame): IMMRResult[] => {\n        let result = [] as IMMRResult[]\n        for (let cell of Object.values(board)) {\n            if (cell.tower?.currentColor !== color) continue\n            if (cell.tower?.currentType === TowerType.k) {\n                const moves = this.checkKingMandatoryMoves(cell, board)\n                if (moves.length) {\n                    result =  result.concat(moves)\n                }\n            } else {\n                const moves = this.checkManMandatoryMoves(cell, board)\n                if (moves.length) {\n                    result = result.concat(moves)\n                }\n            }\n        }\n        result = this.GV === 'towers'\n            ? result \n            : result.map((m: IMMRResult) => (this.removeTakenPieces(m)))\n        return this.GV ===  'international' ? filterArrayByLength(result).cont : result\n    }\n}\n\nconst mmr = new MandatoryMovesResolver()\n\nexport default mmr\n","import { IPlayer, Online, RivalType, PieceColor, Timing, GameVariants, GameType } from '../app-interface';\nimport {GameOptionActionTypes, GameOptionActions, FindOpponentAction} from './types'\n\n\nexport function setRivalLevel(payload: number): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.SET_RIVAL_LEVEL,\n        payload\n    }\n}\n\nexport function setPlayerColor(payload: PieceColor | 'random'): GameOptionActionTypes {\n    return ({\n        type: GameOptionActions.CHOOSE_COLOR,\n        payload\n    });\n};\n\nexport function setPlayer(payload: IPlayer): GameOptionActionTypes {\n    return ({\n        type: GameOptionActions.SET_PLAYER,\n        payload\n    });\n};\n\nexport function setOpponent(payload: IPlayer): GameOptionActionTypes {\n    return ({\n        type: GameOptionActions.SET_RIVAL,\n        payload\n    });\n};\n\nexport function setOpponentType(payload: RivalType): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.SET_RIVAL_TYPE,\n        payload\n    }\n}\n\nexport function setOpponentStatus(payload: Online): GameOptionActionTypes {\n    return ({\n        type: GameOptionActions.SET_RIVAL_ONLINE_STATUS,\n        payload\n    });\n};\n\nexport function setTiming(payload: Timing): GameOptionActionTypes {\n    return ({\n        type: GameOptionActions.SET_GAME_TIMING,\n        payload\n    });\n};\n\nexport function setPlayerStatus (payload: Online): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.SET_RIVAL_ONLINE_STATUS,\n        payload\n    }\n}\n\nexport function findRival(): FindOpponentAction  {\n    return {type: GameOptionActions.FIND_RIVAL}\n}\n\nexport function finishGameSetup(payload: boolean): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.FINISH_GAME_SETUP,\n        payload\n    }\n}\n \nexport function waitingRival(payload: boolean): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.WAIT_RIVAL,\n        payload\n    }\n}\n\nexport function setGameVariant(payload: GameVariants): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.SET_GAME_VARIANT,\n        payload\n    }\n}\n\nexport function cancelRivalWaiting(payload = null): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.CANCEL_RIVAL_WAITING,\n        payload\n    }\n}\n\nexport function requestRematch(payload = null): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.REMATCH_REQUEST,\n        payload\n    }\n}\n\nexport function setGameType(payload: GameType): GameOptionActionTypes {\n    return {\n        type: GameOptionActions.SET_GAME_TYPE,\n        payload\n    }\n}\n","import React from 'react'\n\nimport './logoIcon.scss'\n\nexport const Logo: React.FC<{size?: number}> = ({size = 16}) => {\n    return <i className={`logo s-${size}`}></i>\n}\n","export default __webpack_public_path__ + \"static/media/game-example.329613c8.gif\";","import React, { Suspense } from 'react'\n\nimport Spinner from '../../page-components/spinners/Spinner'\nimport gameExample from '../../assets/game-example.gif'\nimport { sampleLink } from '../../constants/gameConstants'\nimport {I18n} from '../../assets/i18n'\n\nimport './home.scss'\nimport { useSelector } from 'react-redux'\nimport { IRootState } from '../../store/rootState&Reducer'\nimport { useHistory } from 'react-router-dom'\n\nexport const Home: React.FC = () => {\n    const language = useSelector((store: IRootState) => store.user.language)\n    const history = useHistory()\n    const i18n = (I18n as {[key: string]: any})[language.slice(0, 2)]\n    const href = sampleLink\n    const handleClick = () => {\n        history.push(\"game\")\n    }\n    return (\n        <Suspense fallback={<Spinner />}>\n            <div className=\"page home-page\">\n                <div className=''></div>\n                <section className=\"home-page_content\">\n                    <span>{i18n.about}</span>\n                        <figure className=\"game-example-wrapper\">\n                            <a href={href} target=\"_blank\" rel=\"author noreferrer\">\n                                <figcaption><p>Tower's draughts game example.</p><p>Created by Sergey Ivanov.</p></figcaption>\n                                <img width=\"200px\" src={gameExample} alt=\"Tower's Checkers game example\"></img>\n                            </a>   \n                        </figure>\n                    <span>&nbsp;{i18n.about_continue}</span>\n                    <p className=\"home-page_to-game_button\">\n                        <button className='new-game' onClick={handleClick} type=\"button\">{i18n.play}</button>\n                    </p>\n                </section>\n            </div>\n        </Suspense>\n    )\n}\n    \nexport default Home\n","import React, { lazy, Suspense } from 'react'\nimport {Switch, Route} from 'react-router-dom'\n\nimport Home from './pages/home/Home'\nimport Spinner from './page-components/spinners/Spinner'\nimport {RoutesPath} from './constants/gameConstants'\n\n\nconst GameAnalizePage =  lazy(() => import( './pages/gameAnalize/GameAnalyzePage'));\nconst GamePage = lazy(() => import( './pages/game/GamePage'));\n\nconst Router = () => {\n    return (\n        <Suspense fallback={<Spinner />}>\n            <Switch>\n               <Route path={RoutesPath.home} exact>\n                    <Home />\n                </Route>\n                <Route path={RoutesPath.game}>\n                    <GamePage />\n                </Route>\n                <Route path={RoutesPath.analysis}>\n                    <GameAnalizePage />\n                </Route>               \n            </Switch>\n        </Suspense> \n    )    \n}\n\nexport default React.memo(Router)\n","import { IUser } from \"../app-interface\"\n\nexport const UserActions = {\n    LOGIN_SUCCEED: 'LOGIN_SUCCEED',\n    REGISTER_USER: 'REGISTERE_USER',\n    SAVE_USER_STORAGE: 'SAVE_USER_STORAGE',\n    GET_USER_FROM_STORAGE: 'GET_USER_FROM_STORAGE',\n    CHECK_TOKEN_EXPIRATION: 'CHECK_TOKEN_EXPIRATION',\n    EXPIRE_TOKEN: 'TOKEN_EXPEXPIRE',\n    DELETE_USER_FROM_STORAGE: 'DELETE_USER_FROM_STORAGE',\n    LOGOUT: 'LOGOUT',\n    SEND_AUTH_REQUEST: 'SEND_AUTH_REQUEST',\n    SET_PREFERABLE_LANGUAGE: 'SET_PREFERABLE_LANGUAGE',\n    CHECK_STORAGE: 'CHECK_STORAGE',\n}\n\ninterface CheckStorageAction {\n    type: typeof UserActions.CHECK_STORAGE,\n    payload: null\n}\n\ninterface LoginUserAction {\n    type: typeof UserActions.LOGIN_SUCCEED,\n    payload: IUser\n}\n\ninterface SetPreferableLangaugeAction {\n    type: typeof UserActions.SET_PREFERABLE_LANGUAGE,\n    payload: string\n}\n\ninterface LogoutUserAction {\n    type: typeof UserActions.LOGIN_SUCCEED,\n    payload: null\n}\n\ninterface RegisterUserAction {\n    type: typeof UserActions.REGISTER_USER,\n    payload: boolean\n}\n\ninterface SaveUserStorageAction {\n    type: typeof UserActions.SAVE_USER_STORAGE,\n    payload: IUser\n}\n\ninterface GetUserStorageAction {\n    type: typeof UserActions.GET_USER_FROM_STORAGE,\n    payload: IUser\n}\n\ninterface DeleteUserStorageAction {\n    type: typeof UserActions.DELETE_USER_FROM_STORAGE,\n    payload: null\n}\n\nexport type UserActionTypes = GetUserStorageAction \n    | SaveUserStorageAction \n    | RegisterUserAction \n    | LoginUserAction\n    | LogoutUserAction\n    | DeleteUserStorageAction \n    | SetPreferableLangaugeAction\n    | CheckStorageAction\n","import React, { useEffect, useState } from 'react'\nimport { NavLink } from 'react-router-dom'\n\nimport { RoutesPath, RoutesTitle } from '../constants/gameConstants'\nimport { IRef } from '../store/app-interface'\n\n\nexport const MobileMenu = () => {\n    const [dropdown, setDropdown] = useState(false)\n    const [visible, setVisible] = useState(false)\n    const mobileMenuClass = `mobile-nav${visible ? ' visible' : ' hidden'}${!dropdown ? ' display-none' : ' display'}`\n    const timeout = 300\n    const ref: IRef<HTMLUListElement> = React.createRef() \n    const handleDropdown = (e: React.MouseEvent) => {\n        e.preventDefault() \n        if (!dropdown) {\n            setDropdown(true)\n            setTimeout(() => setVisible(true), timeout)\n        } else {\n            setVisible(false)\n            setTimeout(() => setDropdown(false), timeout)\n        }\n    }\n    const handleClickOutside = (ev: any) => {\n        ev.stopPropagation()\n        const elem = ref.current as HTMLElement\n        if (!dropdown || !elem) {\n            return\n        }\n        const target = ev.target as HTMLElement\n        if (!elem.contains(target)) {\n            setDropdown(false)\n        }\n    }\n\n    useEffect(() => {\n        if(!window) return\n        window.addEventListener('click', handleClickOutside)\n        if (!dropdown) {\n            return window.removeEventListener('click', handleClickOutside)\n        }\n        // return window.removeEventListener('click', handleClickOutside)\n    })\n    \n    return (\n        <div onClick={handleDropdown}>\n            <button  className=\"mobile-nav-dropdown-btn\" >\n                <i className=\"material-icons\">menu</i>\n            </button>\n            <ul className={mobileMenuClass} ref={ref}>\n                <li>\n                    <NavLink exact={true} className=\"navlink mobile\" to={RoutesPath.home}>\n                        <i className=\"large material-icons\">{RoutesTitle.home}</i>\n                    </NavLink>\n                </li>\n                <li>\n                    <NavLink className=\"navlink mobile\" to={RoutesPath.game}>\n                        <i className=\"large material-icons\">{RoutesTitle.game}</i>\n                    </NavLink>\n                </li>\n                <li title=\"game analize\">\n                    <NavLink className=\"navlink\" to={RoutesPath.analysis}>\n                        <i className=\"large material-icons\">{RoutesTitle.analyze}</i>\n                    </NavLink>\n                </li>\n                <li title=\"settings\">\n                    <NavLink className=\"navlink\" to={RoutesPath.settings}>\n                        <i className=\"large material-icons\">{RoutesTitle.settings}</i>\n                    </NavLink>\n                </li>\n            </ul>\n        </div>\n       \n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport {useHistory} from 'react-router-dom'\nimport {NavLink} from 'react-router-dom'\nimport {connect, ConnectedProps} from 'react-redux'\n\nimport {RoutesPath, RoutesTitle} from '../constants/gameConstants'\nimport {IRootState} from '../store/rootState&Reducer'\nimport {findRival} from '../store/gameOptions/actions'\nimport {setLanguage} from '../store/user/actions'\nimport {MobileMenu} from './MobileDropdownNav'\nimport { Logo } from '../common/LogoIcon'\nimport {I18n} from '../assets/i18n'\n\n\nconst mapState = (state: IRootState) => ({\n    language: state.user.language,\n    winWidth: state.app.windowSize.width\n})\n\nconst mapDispatch = {\n   setLanguage, findRival\n}\n\nconst connector = connect(mapState, mapDispatch)\n\ntype Props = ConnectedProps<typeof connector>\n\nexport const Navbar: React.FC<Props> = (props) => {\n    const {setLanguage, language, findRival, winWidth} = props\n    const isAuth = true\n    const lang = language.slice(0,2)\n    const history = useHistory()\n    const handleLogoClick = (event: React.MouseEvent) => {\n        event.preventDefault()\n        findRival()\n        history.push('/game')\n    }\n    // const i18n = I18n[lang]\n    const [mobile, setMobile] = useState(window?.innerWidth < 500)\n\n    useEffect(() => {\n        setMobile(winWidth < 500)\n    }, [winWidth])\n    const notAuthLogo = mobile ? I18n['en'].mainTitle : I18n['en'].shortMainTitle\n    const isAuthLogo = mobile ? <Logo size={18} /> : I18n['en'].mainTitle\n    let logo: React.ReactNode = !isAuth \n        ? <NavLink title=\"to home\" to={RoutesPath.home} className=\"brand-logo\">{notAuthLogo}</NavLink>\n        : <div title=\"new game\" className=\"brand-logo\" onClick={handleLogoClick}>{isAuthLogo}</div>\n        \n    return (\n        <nav className=\"nav\">\n            <div className=\"nav-wrapper\">\n                {logo}\n                <div className=\"right-nav\">\n                    <DuoLanguageSwitcher lang={lang} langs={['ru', 'en']} setLanguage={setLanguage}/>\n                    <MobileMenu />\n                    <ul className=\"desktop-nav\">\n                        <li title=\"home\">\n                            <NavLink exact={true} className=\"navlink\" to={RoutesPath.home} >\n                                <i className=\"large material-icons\">{RoutesTitle.home}</i>\n                            </NavLink>\n                        </li>\n                        <li title=\"game\">\n                            <NavLink className=\"navlink\" to={RoutesPath.game}>\n                                <i className=\"large material-icons\">{RoutesTitle.game}</i>\n                            </NavLink>\n                        </li>\n                        <li title=\"game analize\">\n                            <NavLink className=\"navlink\" to={RoutesPath.analysis}>\n                                <i className=\"large material-icons\">{RoutesTitle.analyze}</i>\n                            </NavLink>\n                        </li>\n                        <li title=\"settings\">\n                            <NavLink className=\"navlink\" to={RoutesPath.settings}>\n                                <i className=\"large material-icons\">{RoutesTitle.settings}</i>\n                            </NavLink>\n                        </li>\n                    </ul>\n                    {/* <LoginBar /> */}\n                </div>\n            </div>\n        </nav>\n    )\n}\n\nexport interface DouLangProps {\n    langs: string[],\n    setLanguage(l: string): void,\n    lang: string\n}\n\nexport const DuoLanguageSwitcher = (props: DouLangProps) => {\n    const { lang, setLanguage, langs } = props;\n    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {\n        if (lang === langs[0]) {\n            setLanguage(langs[1])\n        } else {\n            setLanguage(langs[0])\n        }\n        (e.target as HTMLButtonElement).blur();\n    };\n    return <button title=\"change language\" className=\"change-lang-button\" onClick={e => handleClick(e)}>\n        <span className={`flag-icon flag-icon-${lang === 'en' ? 'gb' : lang} flag-icon-squared`}></span>\n    </button>\n};\n\nexport default connector(Navbar)\n","import { IUser } from '../app-interface';\nimport {UserActions, UserActionTypes} from './types';\n\nexport  function loginSucceed(payload: IUser): UserActionTypes{\n    return {\n        type: UserActions.LOGIN_SUCCEED,\n        payload,\n    }\n};\n\nexport  function logout(payload = null): UserActionTypes{\n  return {\n      type: UserActions.LOGOUT,\n      payload\n  }\n};\n\nexport function saveUserToStorage(payload: IUser ): UserActionTypes {\n    return {\n      type: UserActions.SAVE_USER_STORAGE,\n      payload\n    }\n}\n\n// export function register(payload = null): UserActionTypes {\n//     return {\n//       type: UserActions.REGISTER_USER,\n//       payload\n//     }\n// }\n\nexport function getUserFromStorage(payload: IUser): UserActionTypes {\n    return {\n      type: UserActions.GET_USER_FROM_STORAGE,\n      payload\n    }\n}\n\nexport  function setLanguage(payload: string): UserActionTypes{\n  return {\n      type: UserActions.SET_PREFERABLE_LANGUAGE,\n      payload,\n  }\n};\n\nexport function deleteUserFromStorage(payload = null): UserActionTypes {\n    return {\n        type: UserActions.DELETE_USER_FROM_STORAGE,\n        payload\n    }\n}\n","import React from 'react'\n\nimport Navbar from './Navbar'\n\nimport './header.scss'\n\nexport const Header: React.FC = () => {\n    return (\n        <header className=\"header\">\n            <Navbar />\n        </header>\n    )\n    \n} ","export default __webpack_public_path__ + \"static/media/icons8-github.164d6380.svg\";","import { IMessage } from \"../app-interface\"\n\nexport const AppActions = {\n    // CHECK_LOCAL_STORAGE: 'CHECK_LOCAL_STORAGE',\n    SET_PORTRAIT: 'SET_PORTRAIT',\n    CLOSE: 'CLOSE',\n    WINDOW_SIZE: 'WINDOW_SIZE',\n    ADD_MESSAGE_TO_GAME_CHAT: 'ADD_MESSAGE_TO_GAME_CHAT',\n    ADD_MESSAGE_TO_COMMON_CHAT: 'ADD_MESSAGE_TO_COMMON_CHAT',\n}\n\nexport interface AddToGameChatAction {\n    type: typeof AppActions.ADD_MESSAGE_TO_GAME_CHAT\n    payload: IMessage\n}\n\nexport interface AddToCommonChatAction {\n    type: typeof AppActions.ADD_MESSAGE_TO_COMMON_CHAT\n    payload: IMessage\n}\n\nexport interface SetWindowSize {\n    type: typeof AppActions.WINDOW_SIZE\n    payload: {width: number, height: number}\n}\n\nexport interface SetPortraitAction {\n    type: typeof AppActions.SET_PORTRAIT,\n    payload: boolean\n}\n\nexport interface CloseAction {\n    type: typeof AppActions.CLOSE,\n    payload: string\n}\n\nexport type AppActionTypes = SetPortraitAction \n| CloseAction \n| SetWindowSize\n| AddToCommonChatAction\n| AddToGameChatAction\n","import React from 'react'\nimport {connect, ConnectedProps} from 'react-redux'\n\n\nimport git from '../assets/icons8-github.svg'\nimport { BaseBoardSize } from '../constants/gameConstants'\nimport { IRootState } from '../store/rootState&Reducer'\nimport {setPortrait, setWindowSize, close} from '../store/app/actions'\n\nimport './footer.scss'\n\nconst mapState = (state: IRootState) => ({\n    token: state.user.token,\n    windowSize: state.app.windowSize,\n    portrait: state.app.portrait,\n    game: state.game.gameMode === 'isPlaying'\n})\nconst mapDispatch = {close, setWindowSize, setPortrait}\n\nconst connector = connect(mapState, mapDispatch)\n\nclass Footer extends React.Component<ConnectedProps<typeof connector>> {\n\n    componentDidMount() {\n        if (!window) return\n        window.addEventListener(\"beforeunload\", this.onClose)\n        window.addEventListener('resize', this.handleResize) \n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"beforeunload\", this.onClose)\n        window.removeEventListener(\"resize\", this.handleResize)\n    }\n\n    handleResize = () => {\n        if (!window) return\n        const {windowSize, setPortrait, setWindowSize, portrait} = this.props\n        const {width, height} = windowSize\n        const {innerHeight, innerWidth} = window\n        if ((Math.abs(width - innerWidth) > BaseBoardSize / 2 || Math.abs(height - innerHeight) > BaseBoardSize / 2)) {\n            setWindowSize({width: innerWidth, height: innerHeight})\n            if (portrait && innerWidth / innerHeight > 1.3) {\n                setPortrait(false)\n            } else if (!portrait && innerWidth / innerHeight <= 1.3) {\n                setPortrait(true)\n            }\n        }\n    }\n\n    onClose = (e: any) => {\n        e.preventDefault();\n        const token = this.props.token\n        if (token) this.props.close(token)\n        \n    }\n\n    render() {\n        return <footer>\n                    <a href=\"https://github.com/evgmsk\" target=\"blanc\" referrerPolicy=\"no-referrer\">\n                        designed by evgmsk&nbsp;&nbsp;\n                        <img height=\"10px\" width=\"10px\" src={git} alt=\"github\"/>\n                    </a>\n                </footer>\n    }\n}\n\nexport default (connector(Footer))\n","import { IMessage } from '../app-interface'\nimport {AppActions, AppActionTypes} from './types'\n\nexport function addMessageToGameChat(payload: IMessage): AppActionTypes {\n    return {\n        type: AppActions.ADD_MESSAGE_TO_GAME_CHAT,\n        payload\n    } \n}\n\nexport function setPortrait(payload: boolean): AppActionTypes {\n    return {\n        type: AppActions.SET_PORTRAIT,\n        payload\n    }\n}\n\nexport function close(payload: string): AppActionTypes {\n    return ({\n        type: AppActions.CLOSE, \n        payload\n    })\n}\n\nexport function startGame(payload: string): AppActionTypes {\n    return ({\n        type: AppActions.CLOSE,\n        payload\n    })\n}\n\nexport function setWindowSize(payload: {width: number, height: number}): AppActionTypes {\n    return {\n        type: AppActions.WINDOW_SIZE,\n        payload\n    }\n}\n","import React from 'react';\nimport {BrowserRouter as Router} from 'react-router-dom'\n\nimport RouterComponent from './AppRoutes';\nimport { Header } from './page-components/Header';\nimport Footer from './page-components/Footer';\n\n\n\nimport './App.scss'\n\nconst App: React.FC  = () => {\n\n    return (\n        <Router> \n            <Header />\n                <RouterComponent />\n            <Footer />\n        </Router>   \n    );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {PieceColor, IGameState, IMoveOrder, IMoveProps, IBoardToGame, IPlayer, IGameMode} from '../app-interface'\nimport { GameActions, GameActions as GM, GameActionTypes} from \"./types\";\n\nexport const InitialGameState: IGameState = {\n    moveOrder: {pieceOrder: PieceColor.w, playerTurn: ''},\n    gameConfirmed: false,\n    gameStarted: false,\n    history: [],\n    playerColor: PieceColor.w,\n    white: {} as IPlayer,\n    black: {} as IPlayer,\n    rivalOfferedDraw: false,\n    ineffectiveMoves: 0,\n    gameMode: 'isPreparing'\n}\n\nexport function gameReducer(state: IGameState = InitialGameState, action: GameActionTypes): IGameState {\n    switch(action.type) {\n        case (GM.CLEAR_HISTORY): {\n            return {...state, history: []}\n        }\n        case(GM.SET_GAME_STARTED):\n            return {...state, gameStarted: action.payload as boolean}\n        case(GM.UPDATE_GAME_STATE):\n            return {...state, ...action.payload as IBoardToGame}  \n        case(GM.SAVE_MOVE_TO_HISTORY):\n            return {...state, history: state.history.concat(action.payload as unknown as string)}\n        case(GM.SET_MOVE_ORDER):\n            return {...state, moveOrder: action.payload as IMoveOrder}\n        case(GM.MAKE_MOVE): {\n            const {moveToSave, moveOrder} = action.payload as IMoveProps\n            const history = state.history.concat(moveToSave.move)\n            return {...state, moveOrder, history}\n        }\n        case(GameActions.CONFIRM_START_GAME):\n            return {...state, gameConfirmed: action.payload as boolean}\n        case(GM.SET_GAME):\n            return {...state,...action.payload as Partial<IGameState>}\n        case(GM.INEFFECTIVE_MOVE): {\n            return {...state, ineffectiveMoves: action.payload as number}\n        }\n        case(GM.RIVAL_OFFER_DRAW):\n            return {...state, rivalOfferedDraw: true}\n        case(GM.DECLINE_DRAW):\n            return {...state, rivalOfferedDraw: false}\n        case(GM.SET_GAME_MODE):\n            return {...state, gameMode: action.payload as IGameMode}\n        default:\n            return state \n    }\n}\n","import {GameOptionActions, GameOptionActionTypes} from './types'\nimport {\n    PieceColor,\n    IGameOptionState,\n    Timing,\n    RivalType,\n    GameVariants,\n    GameType,\n} from '../app-interface'\n\nexport const InitialGameOptionsState: IGameOptionState = {\n    gameVariant: 'towers',\n    timing: {timeToGame: 5, adds: 0},\n    playerColor: 'random',\n    rivalType: 'PC',\n    rivalLevel: 1,\n    gameSetupFinished: false,\n    waitingRival: false,\n    gameType: 'ranked'\n}\n\nexport function gameOptionsReducer(state = InitialGameOptionsState, action: GameOptionActionTypes): IGameOptionState {\n    switch(action.type) {\n        case GameOptionActions.SET_GAME_TYPE: {\n            return {...state, gameType: action.payload as GameType}\n        }    \n        case(GameOptionActions.CHOOSE_COLOR):\n            return {...state, playerColor: action.payload as PieceColor | 'random'}\n        case(GameOptionActions.SET_GAME_TIMING): {\n            return {...state, timing: action.payload as Timing}\n        }\n        case(GameOptionActions.SET_RIVAL_TYPE): {\n            return {...state, rivalType: action.payload as RivalType}\n        }\n        case(GameOptionActions.SET_RIVAL_LEVEL): {\n            return {...state, rivalLevel: action.payload as number}\n        }\n        case(GameOptionActions.FINISH_GAME_SETUP):\n            return {...state, gameSetupFinished: action.payload as boolean}\n        case GameOptionActions.WAIT_RIVAL:\n            return {...state, waitingRival: action.payload as boolean}\n        case GameOptionActions.SET_GAME_VARIANT:\n            return {...state, gameVariant: action.payload as GameVariants}\n        default: \n            return {...state}    \n    }\n}\n","import { IUser } from '../app-interface'\nimport {UserActionTypes, UserActions as UA} from './types'\n\nexport const InitialUserState: IUser = {\n    name: null as string | null,\n    userId: null as string | null,\n    token: null as string | null,\n    rating: 0,\n    language: navigator.language,\n}\n\nexport function userReducer(state = InitialUserState, action: UserActionTypes): IUser {\n    switch(action.type) {\n        case(UA.LOGIN_SUCCEED): {\n            return {...state, ...action.payload as IUser} \n        }\n        case UA.SET_PREFERABLE_LANGUAGE:\n            return {...state, language: action.payload as string}\n        case(UA.LOGOUT):\n            return {...state, ...InitialUserState}\n        case(UA.GET_USER_FROM_STORAGE): {\n            return {...state, ...action.payload as IUser}\n        }\n        default:\n            return state\n    }\n}\n","import { IApp, IMessage } from '../app-interface'\nimport {AppActions, AppActionTypes} from './types'\n\nexport const AppDefaultState: IApp = {\n    windowSize: {width: window?.innerWidth || 100, height: window?.innerHeight || 100},\n    portrait: (window?.innerWidth || 100) / (window?.innerHeight || 100) < 1.3,\n    commonChat: [] as IMessage[],\n    gameChat: [] as IMessage[],\n}\n\n\nexport function appReducer(state = AppDefaultState, action: AppActionTypes): IApp {\n    switch (action.type) {\n        case AppActions.WINDOW_SIZE:\n            return {...state, windowSize: action.payload as {width: number, height: number}}\n        case AppActions.SET_PORTRAIT:\n            return {...state, portrait: action.payload as boolean}\n        default:\n            return state\n    }\n}\n ","import { IClock } from \"../app-interface\";\n\nexport const ClockActions = {\n    WHITE_TICK: 'WHITE_TICK',\n    BLACK_TICK: 'BLACK_TICK',\n    SET_WHITE_CLOCK: 'SET_WHITE_CLOCK',\n    SET_BLACK_CLOCK: 'SET_BLACK_CLOCK',\n    WHITE_PRESTART_TICK: 'WHITE_PRESTART_TICK',\n    BLACK_PRESTART_TICK: 'BLACK_PRESTART_TICK',\n    SET_CLOCK: 'SET_CLOCK'\n}\n\ninterface WhitePrestartTickAction {\n    type: typeof ClockActions.WHITE_PRESTART_TICK,\n    payload: number\n}\n\ninterface BlackPrestartTickAction {\n    type: typeof ClockActions.BLACK_PRESTART_TICK,\n    payload: number\n}\n\ninterface BlackTickAction {\n    type: typeof ClockActions.BLACK_TICK,\n    payload?: number\n}\n\ninterface WhiteTickAction {\n    type: typeof ClockActions.WHITE_TICK,\n    payload?: number\n}\n\n\ninterface SetWhiteClockAction {\n    type: typeof ClockActions.SET_WHITE_CLOCK,\n    payload: IClock\n}\n\ninterface SetBlackClockAction {\n    type: typeof ClockActions.SET_BLACK_CLOCK,\n    payload: IClock\n}\n\ninterface SetClockAction {\n    type: typeof ClockActions.SET_CLOCK,\n    payload: {whiteClock: IClock, blackClock: IClock}\n}\n\n\nexport type ClockActionTypes = WhitePrestartTickAction\n| BlackPrestartTickAction\n| SetWhiteClockAction\n| SetBlackClockAction\n| WhiteTickAction\n| BlackTickAction\n| SetClockAction\n","import { PrestartTimeLimit, DefaultTime } from \"../../constants/gameConstants\"\nimport {  IClock } from \"../app-interface\"\nimport { ClockActionTypes, ClockActions } from \"../clock/types\"\n\nexport interface IClockState  {whiteClock: IClock, blackClock: IClock}\n\nexport const InitialClockState: IClockState = {\n    whiteClock: {\n        timeToFirstMove: PrestartTimeLimit,\n        timeToGame: DefaultTime,\n        adds: 0\n    },\n    blackClock:{\n        timeToFirstMove: PrestartTimeLimit,\n        timeToGame: DefaultTime,\n        adds: 0\n    },\n}\n\nexport function clockReducer(state: IClockState = InitialClockState, action: ClockActionTypes): IClockState {\n    switch(action.type) {\n        case ClockActions.SET_BLACK_CLOCK: {\n            return {...state, blackClock: action.payload as IClock}\n        }\n        case ClockActions.SET_WHITE_CLOCK: {\n            return {...state, whiteClock: action.payload as IClock}\n        }\n        case(ClockActions.BLACK_PRESTART_TICK): {\n            const timeToFirstMove = state.blackClock.timeToFirstMove! - 1\n            return {...state, blackClock: {...state.blackClock, timeToFirstMove}}\n        }   \n        case(ClockActions.WHITE_PRESTART_TICK): {\n            const timeToFirstMove = state.whiteClock.timeToFirstMove! - 1\n            return {...state, whiteClock: {...state.whiteClock, timeToFirstMove}}\n        }\n        case(ClockActions.WHITE_TICK): {\n            const timeToGame = state.whiteClock.timeToGame - 1\n            return {...state, whiteClock: {...state.whiteClock, timeToGame}}\n        }   \n        case(ClockActions.BLACK_TICK): {\n            const timeToGame = state.blackClock.timeToGame - 1\n            return {...state, blackClock: {...state.blackClock, timeToGame}}\n        }\n        case ClockActions.SET_CLOCK: {\n            return {...state, ...action.payload as {whiteClock: IClock, blackClock: IClock}}\n        }\n        default:\n            return state \n    }\n}\n","import { IAnalysisState, IGameResult, PieceColor } from \"../app-interface\"\nimport { GameAnalysisActions, GameAnalysisTypes } from \"./types\"\n\nexport const InitialGameAnalysisState: IAnalysisState = {\n    gameResult: {} as IGameResult,\n    analyzeLastGame: false,\n    settingPosition: true,\n    movesMainLine: [],\n    pieceOrder: PieceColor.w,\n    movesCurrentLine: [],\n    lastMove: {} as {index: -1, move: ''},\n    depth: 5,\n    evaluate: false,\n    removePiece: false,\n    startPosition: false,\n}\n\n export function analyzeReducer(state = InitialGameAnalysisState, action: GameAnalysisTypes): IAnalysisState {\n    switch(action.type) {\n        case GameAnalysisActions.REMOVE_PIECE: {\n            return {...state, removePiece: action.payload as boolean}\n        }\n        case(GameAnalysisActions.SAVE_GAME_RESULT): {\n            const payload =  action.payload as IGameResult\n            return {...state, gameResult: payload, movesMainLine: payload.movesHistory || []}\n        }\n        case(GameAnalysisActions.SET_DEPTH): {        \n            return {...state, depth: action.payload as number}\n        }\n        case(GameAnalysisActions.EVALUATE_POSITION): {        \n            return {...state, evaluate: action.payload as boolean}\n        }\n        case(GameAnalysisActions.SETTING_BOARD): {        \n            return {...state, settingPosition: action.payload as boolean}\n        }\n        case(GameAnalysisActions.ANALYZE_LAST_GAME): {\n            if (action.payload) {\n                return {...state, analyzeLastGame: action.payload as boolean, settingPosition: false}\n            }    \n            return {...state, analyzeLastGame: action.payload as boolean}\n        }\n        case(GameAnalysisActions.DOWNLOAD_GAME): {        \n            return {...state, gameResult: action.payload as IGameResult}\n        }\n        case GameAnalysisActions.UPDATE_ANALYSIS_STATE: {\n            return {...state, ...action.payload as Partial<IAnalysisState>}\n        }\n        default:\n            return {...state}\n    }\n} \n","import { BaseBoardSize, BaseCellSize} from \"../../constants/gameConstants\"\nimport { createStartBoard } from \"../../game-engine/prestart-help-function-constants\"\nimport { \n    IBoardAndTowers, \n    IBoardToGame,\n    TowerTouched \n} from \"../app-interface\"\nimport { BoardActions, BoardActionTypes } from \"./types\"\n\nexport const InitialBoardState: IBoardAndTowers = {\n    lastMoveSquares: [],\n    towerTouched: null as unknown as TowerTouched,\n    cellSize: BaseCellSize,\n    cellsMap: new Map(),\n    currentPosition: createStartBoard(BaseBoardSize),\n    towers: new Map(),\n    mandatoryMoves: [],\n    posibleMoves: new Map(),\n    mouseDown: false,\n    towerView: \"face\",\n    mandatoryMoveStep: 0,\n    animationStarted: false,\n    moveDone: false\n}\n\n export function boardReducer(state = InitialBoardState, action: BoardActionTypes) {\n    switch(action.type) {\n        case BoardActions.UPDATE_POSITION_TREE:\n            return {...state, positionsTree: action.payload as Map<string, IBoardToGame>}\n        case BoardActions.UPDATE_BOARD_STATE:\n            return {...state, ...action.payload as Partial<IBoardAndTowers>}\n        default:\n            return {...state}\n    }\n}\n","import { BaseBoardSize } from \"../../constants/gameConstants\"\nimport {  \n    BoardNotation, \n    IBoardOptions,\n} from \"../app-interface\"\nimport { BoardOptionActions, BoardOptionActionTypes } from \"./types\"\n\n\nexport const InitialBoardOptionsState: IBoardOptions = {\n    boardTheme: 'standart',\n    withOutLegend: false,\n    lengendsInside: false,\n    boardNotation: BoardNotation.r,\n    boardSize: BaseBoardSize,\n    reversedBoard: false,\n}\n\n export function boardOptionsReducer(state = InitialBoardOptionsState, action: BoardOptionActionTypes) {\n    switch(action.type) {\n        case BoardOptionActions.REVERSE_BOARD: {\n            return {...state, reversedBoard: action.payload as boolean}\n        }\n        case BoardOptionActions.SET_BOARD_NOTATION:\n            return {...state, boardNotation: action.payload as BoardNotation}\n        case BoardOptionActions.SET_BOARD_SIZE:\n            return {...state, boardSize: action.payload as number}\n        case BoardOptionActions.SET_BOARD_THEME:\n            return {...state, boardTheme: action.payload as string}\n        case BoardOptionActions.SET_GAME_BOARD_OPTIONS:\n            return {...state, ...action.payload as IBoardOptions}\n        default:\n            return {...state}\n    }\n}\n","import { IAnalysisState, IApp, IBoardAndTowers, IBoardOptions, IGameOptionState, IGameState, IUser } from './app-interface';\nimport {InitialGameState, gameReducer} from './game/reducers'\nimport {InitialGameOptionsState, gameOptionsReducer} from './gameOptions/reducers'\nimport {InitialUserState, userReducer} from './user/reducer'\nimport {GameActionTypes} from './game/types'\nimport {UserActionTypes} from './user/types'\nimport {GameOptionActionTypes} from './gameOptions/types'\nimport {appReducer, AppDefaultState} from './app/reducers'\nimport { AppActionTypes } from './app/types';\nimport { InitialClockState, clockReducer, IClockState } from './clock/reducers';\nimport {ClockActionTypes} from './clock/types'\nimport { analyzeReducer, InitialGameAnalysisState } from './gameAnalysis/reducers';\nimport { GameAnalysisTypes } from './gameAnalysis/types';\nimport { boardReducer, InitialBoardState } from './board/reducers';\nimport { BoardActionTypes } from './board/types';\nimport { boardOptionsReducer, InitialBoardOptionsState } from './boardOptions/reducers';\nimport { BoardOptionActionTypes } from './boardOptions/types';\n\nexport const InitialState: IRootState = {\n  user: InitialUserState,\n  game: InitialGameState,\n  gameOptions: InitialGameOptionsState,\n  app: AppDefaultState,\n  clock: InitialClockState,\n  analyze: InitialGameAnalysisState,\n  board: InitialBoardState,\n  boardOptions: InitialBoardOptionsState\n};\n\nexport interface IRootState {\n  app: IApp\n  user: IUser\n  game: IGameState\n  gameOptions: IGameOptionState\n  clock: IClockState\n  analyze: IAnalysisState\n  board: IBoardAndTowers\n  boardOptions: IBoardOptions\n}\n\nexport const AppReducers = {\n  game: gameReducer,\n  gameOptions: gameOptionsReducer,\n  user: userReducer,\n  app: appReducer,\n  clock: clockReducer,\n  analyze: analyzeReducer,\n  board: boardReducer,\n  boardOptions: boardOptionsReducer\n}; \n\nexport type AppActions = GameActionTypes \n  | GameOptionActionTypes \n  | UserActionTypes \n  | AppActionTypes \n  | ClockActionTypes\n  | GameAnalysisTypes\n  | BoardActionTypes\n  | BoardOptionActionTypes\n\nexport const getUser = (state: IRootState) => state.user\n\nexport const getGameOptions = (state: IRootState) => state.gameOptions\n\nexport const getGame = (state: IRootState) => state.game\n","import { put, takeLatest, select, delay } from 'redux-saga/effects';\nimport {\n    IGameResult,\n    PieceColor,\n    EndGameConditions,\n    IMoveProps,\n    IGameState,\n    IMoveOrder,\n    IPlayer,\n    IClock\n} from '../app-interface';\nimport {GameActions, GameActions as GM, GameActionTypes, GameActionTypes as GMA} from '../game/types'\nimport {ClockActions} from '../clock/types'\n// import {sendMessage} from '../../web-sockets/ws'\n// import { IRootState } from '../rootState&Reducer';\nimport { oppositColor } from '../../game-engine/gameplay-helper-fuctions';\n// import { Axios, setAuthorizationHeader } from '../../common/axios';\nimport { GameAnalysisActions } from '../gameAnalysis/types';\nimport {checkIfNumberOfKingsChanged} from '../../game-engine/gameplay-helper-fuctions'\nimport { InitialGameState } from '../game/reducers';\nimport { AnimationDuration } from '../../constants/gameConstants';\nimport { AppActions } from '../app/types';\nimport { BoardActions } from '../board/types';\nimport {GameOptionActions as GOA} from '../gameOptions/types'\nimport {BoardOptionActions as BOA} from '../boardOptions/types'\nimport mmr from '../../game-engine/mandatory-move-resolver'\nimport tur from '../../game-engine/update-towers-functions'\n\nfunction* workerNewGameVSPlayer(action: GMA) {\n    yield put({type: GOA.WAIT_RIVAL, payload: false})\n    const { \n        game: {gameMode},\n        boardOptions: {boardSize},\n        gameOptions: {gameVariant, timing, playerColor}\n    } = yield select()\n    if (gameMode === 'isPlaying') {\n        yield put({type: GameActions.SET_GAME, payload: InitialGameState})\n    }\n    let color: PieceColor = playerColor\n    if (playerColor === 'random') {\n        color = Math.random() < .5 ? PieceColor.w : PieceColor.b\n    }\n    const {timeToGame, adds, timeToFirstMove = 10} = timing\n    const black = {name: 'Black'}\n    const white = {name: \"White\"}\n    const clock: IClock = {\n        timeToGame: timeToGame * 60,\n        adds,\n        timeToFirstMove\n    }\n    yield put({type: BOA.REVERSE_BOARD, payload: color === PieceColor.b})\n    const gamePayload: Partial<IGameState> = {\n        moveOrder: {pieceOrder: PieceColor.w, playerTurn: 'White'},\n        black,\n        white,\n        gameStarted: true,\n        playerColor: color,\n        history: [],\n        gameConfirmed: true,\n        gameMode: 'isPreparing',\n        portrait: window.innerWidth / window.innerHeight < 1.3,\n        ineffectiveMoves: 0,\n    }\n    tur.setProps({GV: gameVariant, size: boardSize})\n    mmr.setProps({GV: gameVariant, size: boardSize})\n    yield put({type: BoardActions.CREATE_GAME_BOARD})\n    yield put({type: GM.SET_GAME, payload: gamePayload})\n    yield put({type: ClockActions.SET_CLOCK, payload: {blackClock: clock, whiteClock: clock}})\n    yield put({type: GOA.FINISH_GAME_SETUP, payload: true})\n    delay(AnimationDuration*3)\n    yield put({type: GM.SET_GAME_MODE, payload: 'isPlaying'})\n}\n\nfunction* workerNewGameVsPC() {\n    const {\n        gameOptions: {playerColor, rivalLevel = 1, gameVariant},\n        boardOptions: {boardSize},\n        user: {name, rating},\n        game: {gameMode}\n    } = yield select()\n    if (gameMode === 'isPlaying') {\n        yield put({type: GameActions.SET_GAME, payload: InitialGameState})\n    }\n    yield delay(30)\n    let color: PieceColor = playerColor\n    if (playerColor === 'random') {\n        color = Math.random() < .5 ? PieceColor.w : PieceColor.b\n    }\n    const rival = {name: `Bot ${rivalLevel}`}\n    const moveOrder: IMoveOrder = {\n        pieceOrder: PieceColor.w,\n        playerTurn: color === PieceColor.w ? name : rival.name\n    }\n    yield put({type: BOA.REVERSE_BOARD, payload: color === PieceColor.b})\n    const white = color === PieceColor.w ? {name, rating} : {name: rival.name} as IPlayer\n    const black = color === PieceColor.w ? {name: rival.name, rivalLevel} : {name, rating} as IPlayer\n    const gamePayload: Partial<IGameState> = {\n        moveOrder,\n        playerColor: color,\n        white,\n        black,\n        history: [],\n        gameConfirmed: true,\n        gameStarted: true,\n        gameMode: 'isPreparing',\n        portrait: window.innerWidth / window.innerHeight < 1.3,\n        ineffectiveMoves: 0\n    }\n    mmr.setProps({GV: gameVariant, size: boardSize})\n    tur.setProps({GV: gameVariant, size: boardSize})\n    yield put({type: BoardActions.CREATE_GAME_BOARD})\n    yield put({type: GM.SET_GAME, payload: gamePayload})\n    yield put({type: AppActions.SET_PORTRAIT, payload: window.innerWidth / window.innerHeight < 1.3,})\n    yield put({type: GOA.FINISH_GAME_SETUP, payload: true})\n    delay(AnimationDuration*3)\n    yield put({type: GM.SET_GAME_MODE, payload: 'isPlaying'})\n}\n\nfunction* checkDraw (payload: IMoveProps) {\n    const {gameOptions: {gameVariant}, board: {currentPosition}, game: {ineffectiveMoves}} = yield select()\n    const numberOfKingsChanged = checkIfNumberOfKingsChanged(currentPosition, payload.moveToSave.position)\n    if (payload.moveToSave.move.includes(':') || numberOfKingsChanged) {\n        yield put({type: GM.INEFFECTIVE_MOVE, payload: 0})\n    } else if ((gameVariant !== 'international' && ineffectiveMoves < 36) \n        || (gameVariant === 'international' && ineffectiveMoves < 50)) {\n        yield put({type: GM.INEFFECTIVE_MOVE, payload: ineffectiveMoves + 1})\n    } else {\n        yield put({type: GM.END_GAME, payload: 'drawByRules'})\n    }\n}\n\n// function* workerDrawOffer(action: GMA) {\n//     const {gameOptions: {rivalType}, game: {gameKey}} = yield select()\n//     // if (rivalType !== 'PC') sendMessage({message: 'game draw offered', payload: {gameKey}})\n// }\n\n// function* workerDrawRespond(action: GMA) {\n  \n//     yield put({type: GM.RIVAL_OFFER_DRAW, payload: false})\n//     // sendMessage({message: 'game draw rejected', payload: {gameKey}})\n// }\n\nfunction* workerPlayerClockAfterMove(payload: IMoveProps) {\n    const {\n        game: {gameConfirmed, history},\n        clock: {whiteClock, blackClock}\n    } = yield select()\n    if (gameConfirmed) {\n        if (payload.moveOrder.pieceOrder === PieceColor.w) {\n            const payload = {...blackClock, timeToGame: blackClock.timeToGame + blackClock.adds}\n            yield put({type: ClockActions.SET_BLACK_CLOCK, payload})\n            yield put({type: ClockActions.WHITE_TICK})\n        } else {\n            const payload = {...whiteClock, timeToGame: whiteClock.timeToGame + whiteClock.adds}\n            yield put({type: ClockActions.SET_WHITE_CLOCK, payload})\n            yield put({type: ClockActions.BLACK_TICK})\n        }\n    } else if (history.length > 1) {\n        yield put({type: GM.CONFIRM_START_GAME, payload: true})\n        if (payload.moveOrder.pieceOrder === PieceColor.w) {\n            yield put({type: ClockActions.WHITE_TICK})\n        } else {\n            yield put({type: ClockActions.BLACK_TICK})\n        }\n    } else {\n        if (payload.moveOrder.pieceOrder === PieceColor.b) {\n            yield put({type: ClockActions.BLACK_PRESTART_TICK})\n        } else { \n            yield put({type: ClockActions.WHITE_PRESTART_TICK})\n        }\n    }\n}\n\nfunction* workerMove(action: GMA) {\n    const {\n        game: {gameStarted},\n    } = yield select()\n    const payload: IMoveProps = action.payload as IMoveProps\n    if (!gameStarted) return\n    yield checkDraw(payload)\n    workerPlayerClockAfterMove(payload)\n}\n\nfunction* workerGameEnd(action: GMA) {\n    const {game: {moveOrder: {pieceOrder}, gameMode}, clock: {blackClock}} = yield select()\n    if (gameMode === 'isOver') return\n    const draw = action.payload === 'drawByAgreement' || action.payload === 'drawByRules'\n    let winner: PieceColor | 'draw'\n    if (action.payload === 'abandonedByWhite') {\n        winner = PieceColor.b\n    } else if (action.payload === 'abandonedByBlack') {\n        winner = PieceColor.w\n    } else if (action.payload === 'outOfTime') {\n        winner = !blackClock.timeToGame ? PieceColor.w : PieceColor.b\n    } else {\n        winner = draw ? 'draw' : oppositColor(pieceOrder)\n    }\n    yield resolveEndGame(winner, action.payload as EndGameConditions)\n}\n\nfunction* workerSurrender(action: GMA) {\n    const winner = oppositColor(action.payload as PieceColor)\n    yield resolveEndGame(winner, 'surrender')\n}\n\nfunction* resolveEndGame(winner: PieceColor | 'draw', reason: EndGameConditions) {\n    const { \n        game: {history, white, black, playerColor},\n    } = yield select(state => state)\n    const {\n        gameOptions: {gameVariant, timing: {timeToGame, adds}}, \n        boardOptions: {boardSize}\n    } = yield select()\n        // const token: string = yield select((state: IRootState) => state.user.token)\n        const PC = playerColor === PieceColor.w ? black.name : white.name\n        const gameResult: Partial<IGameResult> & {PC: string, playerColor: PieceColor} = {\n            winner,\n            reason,\n            timing: `${timeToGame}/${adds}`,\n            playerColor,\n            PC,\n            gameVariant,\n            movesHistory: history,\n            boardSize,\n            date: new Date()\n        }\n        yield put({type: GameAnalysisActions.SAVE_GAME_RESULT, payload: gameResult})\n        const analysisPayload = {\n            movesMainLine: history,\n            lastMove: {index: history.length - 1, move: history.slice(-1)[0]}\n        }\n        yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload: analysisPayload})\n        const game = {\n            ...InitialGameState, gameMode: 'isOver',\n        } as IGameState\n        yield put({type: GM.SET_GAME, payload: game})    \n}\n\nfunction* cancelGameWorker(action: GameActionTypes) {\n\n    yield put({type: GM.SET_GAME_STARTED, payload: false})\n    yield put({type: GM.SET_GAME_MODE, payload: 'isOver'})\n}\n\nexport default function* watcherGame() {\n    yield takeLatest(GM.END_GAME, workerGameEnd)\n    // yield takeLatest(GM.DECLINE_DRAW, workerDrawRespond)\n    // yield takeLatest(GM.OFFER_DRAW, workerDrawOffer)\n    yield takeLatest(GM.MAKE_MOVE, workerMove)\n    yield takeLatest(GM.SURRENDER, workerSurrender)\n    yield takeLatest(GM.CANCEL_GAME, cancelGameWorker)\n    yield takeLatest(GM.NEW_GAME_VS_PLAYER, workerNewGameVSPlayer)\n    yield takeLatest(GM.NEW_GAME_VS_PC, workerNewGameVsPC)\n}\n","import {put, takeLatest, select } from 'redux-saga/effects';\n\nimport {FindOpponentAction, SetGameVariantAction, GameOptionActions as GOA} from '../gameOptions/types'\n// import { BoardOptionActions as BOA } from '../boardOptions/types';\nimport {GameActions as GA} from '../game/types'\nimport { createEmptyBoard} from '../../game-engine/prestart-help-function-constants';\n// import { sendMessage } from '../../web-sockets/ws';\nimport { GameAnalysisActions } from '../gameAnalysis/types';\nimport { BoardOptionActions } from '../boardOptions/types';\n\n\n \nfunction* findRival(action: FindOpponentAction) {\n    const {gameOptions: {rivalType}} = yield select()\n    if (rivalType === 'PC') {\n        yield put({type: GA.NEW_GAME_VS_PC})\n    } else if (rivalType === 'player') {\n        console.log('player')\n        yield put({type: GA.NEW_GAME_VS_PLAYER})\n    }\n}\n\n// function* lookForRival() {\n//     const {\n//         boardOptions: {boardSize}, \n//         gameOptions: {\n//             playerColor,\n//             timing: {timeToGame, adds}, \n//             gameVariant\n//         },\n//         user: {\n//             rating\n//         }\n//     } = yield select()\n//     const payload = {boardSize, playerColor, timing: `${timeToGame}/${adds}`, gameVariant, rating}\n//     const message = \"rival\"\n//     try {\n//         console.log('send')\n//         // sendMessage({message, payload})\n//     } catch(e) {\n//         console.log(e)\n//         yield put({type: GOA.FINISH_GAME_SETUP, payload: false})\n//         yield put({type: GOA.WAIT_RIVAL, payload: false})\n//     }\n// }\n\n\n// function* cancelRival() {\n//     const {gameOptions: {gameVariant, timing}} = yield select()\n//     yield put({type: GOA.WAIT_RIVAL, payload: false})\n//     // const payload = {waitingListKey: `${gameVariant}${timing.timeToGame}/${timing.adds}`}\n//     // sendMessage({message: 'cancel rival', payload})\n// }\n\nfunction* workerGameVariant(action: SetGameVariantAction) {\n    if (action.payload === 'international') {\n        yield put({type: BoardOptionActions.SET_BOARD_SIZE, payload: 10})\n        yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload: {currentPosition: createEmptyBoard(10)}})\n    } else {\n        yield put({type: BoardOptionActions.SET_BOARD_SIZE, payload: 8})\n        yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload: {currentPosition: createEmptyBoard(8)}})\n    }\n}\n\nexport default function* watcherPreGame() {\n    yield takeLatest(GOA.FIND_RIVAL, findRival);\n    // yield takeLatest(GOA.CANCEL_RIVAL_WAITING, cancelRival)\n    yield takeLatest(GOA.SET_GAME_VARIANT, workerGameVariant)\n}\n","import { put, takeLatest, delay, select} from 'redux-saga/effects';\n\nimport { Interval} from '../../constants/gameConstants';\nimport { PieceColor } from '../app-interface';\nimport { ClockActions, ClockActionTypes } from '../clock/types';\nimport { GameActions, GameActionTypes} from '../game/types'\nimport { GameAnalysisActions } from '../gameAnalysis/types';\n\nfunction* workerGameClock() { \n    const {\n        game: {\n            gameStarted,\n            gameConfirmed,\n            moveOrder\n        },\n        clock: {\n            whiteClock,\n            blackClock,\n        }\n    } = yield select()\n    if (!gameConfirmed || !gameStarted) {\n        return\n    }\n    if (whiteClock.timeToGame <= 0 || blackClock.timeToGame <= 0) {\n        yield put ({type: GameActions.END_GAME, payload: 'outOfTime'})\n        return\n    }\n    yield delay(Interval)\n    if (moveOrder.pieceOrder === PieceColor.w) {\n        yield put({type: ClockActions.WHITE_TICK})\n    } else {\n        yield put({type: ClockActions.BLACK_TICK})\n    }  \n}\n\n\nfunction* workerStartClock(action: GameActionTypes) {\n    const {gameOptions: {rivalType}, game: {gameConfirmed}} = yield select()\n    if (action.payload === 'isPlaying' && rivalType !== 'PC') {\n        if (gameConfirmed) {\n            yield put({type: ClockActions.WHITE_TICK})\n        } else {\n            yield put({type: ClockActions.WHITE_PRESTART_TICK})\n        } \n    }\n}\n\nfunction* workerPreTicks(action: ClockActionTypes) {\n    const {\n        clock: {\n            blackClock,\n            whiteClock,\n        },\n        game: {\n            gameMode,\n            gameConfirmed,\n           \n        },\n    } = yield select()\n    if (gameMode !== 'isPlaying' || gameConfirmed) {\n        return\n    }\n    if (whiteClock.timeToFirstMove <= 0 || blackClock.timeToFirstMove <= 0) {\n        yield put({type: GameActions.CANCEL_GAME})\n        yield put({type: GameAnalysisActions.SAVE_GAME_RESULT, payload: {}})\n        return\n    }\n    yield delay(Interval)\n    const {game: {moveOrder: {pieceOrder}}} = yield select()\n    if (pieceOrder === PieceColor.b) {\n        yield put({type: ClockActions.BLACK_PRESTART_TICK})\n    } else {\n        yield put({type: ClockActions.WHITE_PRESTART_TICK})\n    } \n}\n\nexport default function* watcherTimer() {\n    yield takeLatest(GameActions.SET_GAME_MODE, workerStartClock)\n    yield takeLatest(ClockActions.WHITE_PRESTART_TICK, workerPreTicks)\n    yield takeLatest(ClockActions.BLACK_PRESTART_TICK, workerPreTicks)\n    yield takeLatest(ClockActions.BLACK_TICK, workerGameClock)\n    yield takeLatest(ClockActions.WHITE_TICK, workerGameClock)\n}\n","import { put, takeLatest, select, delay } from 'redux-saga/effects';\n\nimport { PieceColor, IMoveProps, IAnalysisState} from '../app-interface';\n\nimport { copyMap, oppositColor, splitMove } from '../../game-engine/gameplay-helper-fuctions';\n// import { Axios, setAuthorizationHeader } from '../../common/axios';\nimport { GameAnalysisActions, GameAnalysisTypes } from '../gameAnalysis/types';\nimport { createDefaultTowers, createEmptyBoard, createStartBoard} from '../../game-engine/prestart-help-function-constants';\nimport { InitialGameAnalysisState } from '../gameAnalysis/reducers';\nimport { IRootState } from '../rootState&Reducer';\nimport { BoardActions } from '../board/types';\nimport tur from '../../game-engine/update-towers-functions'\nimport { AnimationDuration } from '../../constants/gameConstants';\n\n// function* workerUploadGame(action: GameAnalysisTypes) {\n//     const token: string = yield select((state) => state.user.token)\n//     try {\n//         setAuthorizationHeader(token)\n//         const respond: {[key: string]: any} = yield call(Axios.post, '/api/game/upload', JSON.stringify(action.payload))\n//         console.log(respond.data as IGameResult)\n//     } catch(e) {\n//         console.log(e)\n//     }\n// }\n\nfunction* workerUpdatePosition(action: GameAnalysisTypes) {\n    const {analyze, board: {positionsTree}} = yield select()\n    const {\n        movesCurrentLine,\n        movesMainLine,\n        lastMove,\n    } = analyze as IAnalysisState\n    const {moveToSave: {move, position}} = action.payload as IMoveProps\n    let nextLastMove, nextPositionKey;\n    if (movesMainLine![lastMove.index] === lastMove.move && movesMainLine!.length === lastMove.index + 1) {\n        nextLastMove = {move, index: lastMove.index + 1}\n        nextPositionKey = `${movesMainLine?.join('_')}_${move}`\n        positionsTree!.set(nextPositionKey, position!)\n        yield put({\n            type: GameAnalysisActions.UPDATE_ANALYSIS_STATE,\n            payload: {\n                ...analyze,\n                lastMove: nextLastMove,\n                positionsTree,\n                movesMainLine: movesMainLine?.push(move)\n            }\n        })\n    } else if (movesMainLine![lastMove.index] === lastMove.move && movesMainLine!.length > lastMove.index + 1) {\n        nextLastMove = {move, index: lastMove.index + 1}\n        nextPositionKey = `${movesMainLine?.join('_')}_${move}`\n        positionsTree!.set(nextPositionKey, position!)\n        const newCurrentLine = [...movesMainLine!.slice(0, lastMove.index + 1), lastMove.move]\n        yield put({\n            type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n            payload: {...analyze, lastMove: nextLastMove, movesCurrentLine: newCurrentLine}\n        })\n        yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {positionsTree}})\n    } else if (movesCurrentLine!.slice(-1)[0] === lastMove.move) {\n        nextLastMove = {move, index: lastMove.index + 1}\n        nextPositionKey = `${movesCurrentLine?.join('_')}_${move}`\n        positionsTree!.set(nextPositionKey, position!)\n        yield put({\n            type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n            payload: {...analyze, lastMove: nextLastMove, movesCurrentLine: movesCurrentLine?.push(move)}\n        })\n        yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {positionsTree}})\n    }\n}\n\nfunction* workerStepForward(action: GameAnalysisTypes) {\n    const {analyze, board: {positionsTree}} = yield select()\n    const {\n        movesCurrentLine,\n        movesMainLine,\n        lastMove,\n        pieceOrder\n    } = analyze as IAnalysisState\n    let nextLastMove, currentPosition;\n    if (lastMove.index < 0) {\n        const move = movesMainLine![0]\n        nextLastMove = {index: 0, move}\n        currentPosition = positionsTree?.get(move)\n    } else if (movesMainLine![lastMove.index] === lastMove.move \n        && lastMove.index < movesMainLine!.length - 1) {\n            nextLastMove = {move: movesMainLine![lastMove.index + 1], index: lastMove.index + 1}\n            currentPosition = positionsTree!.get(movesMainLine!.slice(0, nextLastMove.index + 1).join('_'))\n    } else if (movesCurrentLine![lastMove.index] === lastMove.move \n        && lastMove.index < movesCurrentLine!.length - 1) {\n            nextLastMove = {move: movesCurrentLine![lastMove.index + 1], index: lastMove.index + 1}\n            currentPosition = positionsTree!.get(movesCurrentLine!.slice(0, nextLastMove.index + 1).join('_'))\n    }\n    yield put({\n        type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n        payload: {...analyze, lastMove: nextLastMove, pieceOrder: oppositColor(pieceOrder)}\n    })\n    yield put({\n        type: BoardActions.UPDATE_BOARD_STATE,\n        payload: {currentPosition}\n    })\n}\n\nfunction* workerGoToPosition(action: GameAnalysisTypes) {\n    // console.log(action)\n    const {analyze, boardOptions, board: {positionsTree, cellsMap, cellSize}} = yield select()\n    const {\n        movesCurrentLine,\n        movesMainLine,\n    } = analyze as IAnalysisState\n    const {index, move} = action.payload as {index: number, move: string}\n    let currentPosition, lastMove, pieceOrder\n    if (index < 0) {\n        currentPosition = createStartBoard(boardOptions.boardSize)\n    } else if (movesMainLine![index] === move) {\n        currentPosition = positionsTree!.get(movesMainLine!.slice(0, index + 1).join('_'))\n        console.log(positionsTree, movesMainLine!.slice(0, index + 1).join('_'), currentPosition)\n    } else if (movesCurrentLine![index] === move) {\n        currentPosition = positionsTree!.get(movesCurrentLine!.slice(0, index + 1).join('_'))\n    }\n    let towers  = tur.updateTowersToBoard(currentPosition)\n    towers = tur.updateTowersPosition(cellSize, towers, cellsMap, boardOptions.reversedBoard)\n    pieceOrder = index % 2 ? PieceColor.w : PieceColor.b\n    lastMove = action.payload\n    const payload = { lastMove, pieceOrder}\n    yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload})\n    yield put({\n        type: BoardActions.UPDATE_BOARD_STATE,\n        payload: {currentPosition, towers}\n    })\n}\n\nfunction* workerPlayMoves(action: GameAnalysisTypes) {\n    \n    const {analyze, board: {positionsTree, cellSize, cellsMap}, boardOptions: {reversedBoard}} = yield select()\n    const {\n        movesCurrentLine,\n        movesMainLine,\n        lastMove,\n        pieceOrder,\n    } = analyze as IAnalysisState\n    let nextLastMove, currentPosition;\n    const nextIndex = lastMove.index + 1\n    if (lastMove.index < 0) {\n        nextLastMove = {move: movesMainLine![0], index: 0}\n        currentPosition = positionsTree!.get(movesMainLine![0])\n    } else if (movesMainLine![lastMove.index] === lastMove.move) {\n        nextLastMove = {move: movesMainLine![lastMove.index + 1], index: lastMove.index + 1}\n        currentPosition = positionsTree!.get(movesMainLine!.slice(0, nextLastMove.index + 1).join('_'))\n    } else if (movesCurrentLine![lastMove.index] === lastMove.move) {\n        nextLastMove = {move: movesCurrentLine![lastMove.index + 1], index: lastMove.index + 1}\n        currentPosition = positionsTree!.get(movesCurrentLine!.slice(0, nextLastMove.index + 1).join('_'))\n    } else {\n        console.error(analyze, action)\n    }\n    \n    let towers = tur.updateTowersToBoard(currentPosition)\n    towers = tur.updateTowersPosition(cellSize, towers, cellsMap, reversedBoard)\n    const lastMoveSquares = splitMove((nextLastMove)!.move)\n    yield put({\n        type: BoardActions.UPDATE_BOARD_STATE,\n        payload: {currentPosition, towers, lastMoveSquares}\n    })\n    yield put({\n        type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n        payload: {\n            ...analyze,\n            lastMove: nextLastMove,\n            pieceOrder: oppositColor(pieceOrder),\n        }\n    })\n    if (nextIndex < movesMainLine!.length - 1 || nextIndex < movesCurrentLine!.length -1) {\n        yield delay(AnimationDuration)\n        yield put({type: GameAnalysisActions.PLAY_MOVES})\n    }\n}\n\nfunction* workerStepBack(action: GameAnalysisTypes) {\n    const {analyze, board: {positionsTree}} = yield select()\n    const {\n        movesCurrentLine,\n        movesMainLine,\n        lastMove,\n        pieceOrder\n    } = analyze as IAnalysisState\n    let nextLastMove, currentPosition;\n    if (lastMove.index < 0) return\n    if (movesMainLine![lastMove.index] === lastMove.move && lastMove.index > 0) {\n        nextLastMove = {move: movesMainLine![lastMove.index - 1], index: lastMove.index - 1}\n        currentPosition = positionsTree!.get(movesMainLine!.slice(0, nextLastMove.index + 1).join('_'))\n    } else if (movesCurrentLine![lastMove.index] === lastMove.move && lastMove.index > 0) {\n        nextLastMove = {move: movesCurrentLine![lastMove.index - 1], index: lastMove.index - 1}\n        currentPosition = positionsTree!.get(movesCurrentLine!.slice(0, nextLastMove.index + 1).join('_'))\n    }\n    const lastMoveSquares = splitMove((nextLastMove)!.move)\n    yield put({\n        type: BoardActions.UPDATE_BOARD_STATE,\n        payload: {currentPosition, lastMoveSquares}\n    })\n    yield put({\n        type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n        payload: {\n            ...analyze,\n            lastMove: nextLastMove,\n            pieceOrder: oppositColor(pieceOrder),\n        }\n    })\n}\n\nfunction* workerSettingBoard(action: GameAnalysisTypes) {\n    const {boardOptions:{boardSize}} = yield select(state => state)\n    if (action.payload) {\n        const board = createEmptyBoard(boardSize)\n        yield put({\n            type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, \n            payload: {...InitialGameAnalysisState, board, currentPosition: board }\n        })\n    }\n}\n\nfunction* workerGameAnalysis(action: GameAnalysisTypes) {\n    const {analyze: {settingPosition}} = yield select(state => state)\n    if (settingPosition && action.payload) {\n        yield put({\n            type: GameAnalysisActions.SETTING_BOARD, \n            payload: false\n        })\n    }\n}\n\nfunction* workerCurrentLine(action: GameAnalysisTypes) {\n    const {\n        analyze:{\n            lastMove: {index},\n            movesCurrentLine,\n            pieceOrder,\n        },\n        board: {positionsTree}      \n    } = yield select()\n    const {moveToSave: {move, position}} = action.payload as IMoveProps\n    let payload: Partial<IAnalysisState> = {}\n    if (movesCurrentLine[index + 1] === move) {\n        yield put({\n            type: BoardActions.UPDATE_BOARD_STATE,\n            payload: {currentPosition: position}\n        })\n        payload = {\n            lastMove: {move, index: index + 1},\n            pieceOrder: oppositColor(pieceOrder),\n        }\n    } else {\n        const movesLine = [...movesCurrentLine.slice(0, index + 1), move]\n        const _positionsTree = copyMap(positionsTree!)\n        const newKey = movesLine.join('_')\n        _positionsTree.set(newKey, position)\n        yield put({\n            type: BoardActions.UPDATE_BOARD_STATE, \n            payload: {positionsTree: _positionsTree, currentPositoin: position}\n        })\n        payload = { \n            lastMove: {move, index: index + 1},\n            pieceOrder: oppositColor(pieceOrder),\n            movesCurrentLine: movesLine,\n        }\n    }\n    return payload\n}\n\nfunction* workerMainLine(action: GameAnalysisTypes) {\n    const {\n        analyze: {\n            lastMove: {index},\n            movesMainLine,\n            pieceOrder,\n        },\n        board: {positionsTree}\n    } = yield select()\n    const {moveToSave: {move, position}} = action.payload as IMoveProps\n    let payload: Partial<IAnalysisState> = {}\n    yield put({\n        type: BoardActions.UPDATE_BOARD_STATE,\n        payload: {currentPosition: position}\n    })\n    if (!movesMainLine.length) {\n        payload = {\n            lastMove: {move, index: 0},\n            pieceOrder: oppositColor(pieceOrder),\n            movesMainLine: [move]\n        }\n        const _positionsTree = copyMap(positionsTree!)\n        _positionsTree.set(move, position)\n        yield put({\n            type: BoardActions.UPDATE_BOARD_STATE,\n            payload: {positionsTree: _positionsTree, history: [move], currentPosition: position}\n        })\n    } else if (movesMainLine[index + 1] === move) {\n        payload = { \n            lastMove: {move, index: index + 1},\n            pieceOrder: oppositColor(pieceOrder),\n        }\n    } else {\n        const movesLine = movesMainLine.slice(0, index + 1).concat(move)\n        const _positionTree = copyMap(positionsTree!)\n        const newKey = movesLine.join('_')\n        _positionTree.set(newKey, position)\n        payload = {\n            lastMove: {move, index: index + 1},\n            pieceOrder: oppositColor(pieceOrder),\n            movesMainLine: [...movesMainLine, move]\n        }\n        yield put({\n            type: BoardActions.UPDATE_BOARD_STATE,\n            payload: {positionsTree: _positionTree, currentPosition: position, history: movesLine}\n        })\n    }\n    return payload\n}\n\nfunction* workerNewMove(action: GameAnalysisTypes) {\n    const {\n        lastMove: {move, index},\n        movesCurrentLine,\n    } = yield select((state: IRootState) => state.analyze)\n    let payload: Partial<IAnalysisState> = {}\n    if (movesCurrentLine.length && movesCurrentLine[index] === move) {\n        payload = yield workerCurrentLine(action)\n    } else {\n        payload = yield workerMainLine(action)\n    } \n    if (payload.lastMove) {\n        yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload})\n    }\n}\n\nfunction* workerStartPosition(action: GameAnalysisTypes) {\n    const {\n        boardOptions: {boardSize},\n        board: {positionsTree}\n    } = yield select((state: IRootState) => state)\n    yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload: {startPosition: false}})\n    const currentPosition = createStartBoard(boardSize)\n    positionsTree.clear()\n    positionsTree.set('sp', currentPosition)\n    const towers = createDefaultTowers(boardSize)\n    yield put ({type: BoardActions.UPDATE_BOARD_STATE, paylaod: {currentPosition, positionsTree, towers}})\n    const payload: Partial<IAnalysisState> = {\n        ...InitialGameAnalysisState,\n        startPosition: true,\n    }\n    yield delay(100)\n    yield put({type: GameAnalysisActions.UPDATE_ANALYSIS_STATE, payload})\n}\n\nexport default function* watcherAnalysis() {    \n    yield takeLatest(GameAnalysisActions.STEP_BACK, workerStepBack)\n    yield takeLatest(GameAnalysisActions.STEP_FORWARD, workerStepForward)\n    yield takeLatest(GameAnalysisActions.GO_TO_POSITION, workerGoToPosition)\n    yield takeLatest(GameAnalysisActions.UPDATE_POSITION, workerUpdatePosition)\n    // yield takeLatest(GameAnalysisActions.DOWNLOAD_GAME, workerUploadGame)\n    yield takeLatest(GameAnalysisActions.PLAY_MOVES, workerPlayMoves)\n    yield takeLatest(GameAnalysisActions.SETTING_BOARD, workerSettingBoard)\n    yield takeLatest(GameAnalysisActions.ANALYZE_LAST_GAME, workerGameAnalysis)\n    yield takeLatest(GameAnalysisActions.MAKE_NEW_MOVE, workerNewMove)\n    yield takeLatest(GameAnalysisActions.SET_START_POSITION, workerStartPosition)\n}\n ","import { put, takeLatest, select, delay } from 'redux-saga/effects';\n\nimport {BoardActionTypes, BoardActions as BA, BoardActions} from '../board/types'\nimport { GameVariants, IGameBoard, IGameState, IMoveProps, TowerConstructor } from '../app-interface';\nimport { \n    createEmptyBoardForCustomPosition,\n    createStartBoardToDraw,\n    createAnalysisBoard,\n    oppositColor\n} from '../../game-engine/prestart-help-function-constants';\nimport { GameOptionActions,  GameOptionActionTypes} from '../gameOptions/types';\nimport tur from '../../game-engine/update-towers-functions'\nimport { GameActions } from '../game/types';\nimport { IRootState } from '../rootState&Reducer';\nimport { copyMap, splitMove } from '../../game-engine/gameplay-helper-fuctions';\nimport { AnimationDuration } from '../../constants/gameConstants';\n\n \nfunction* workerGameBoard(action: BoardActionTypes) {\n    const {boardOptions} = yield select()\n    const payload = createStartBoardToDraw({boardOptions})\n    yield put({type: BA.UPDATE_BOARD_STATE, payload})\n}\n\nfunction* workerSetupBoard() {\n    const {boardOptions} = yield select()\n    const payload = createEmptyBoardForCustomPosition({boardOptions})\n    yield put({type: BA.UPDATE_BOARD_STATE, payload})\n}\n\nfunction* workerBoardSize(action: GameOptionActionTypes) {\n    const {boardOptions} = yield select()\n    const boardSize = action.payload as GameVariants === 'international' ? 10 : 8\n    if (boardOptions.boardSize !== boardSize) {\n        yield put({type: BA.UPDATE_BOARD_SIZE, payload: boardSize})\n    }\n}\n\nfunction* workerAnalysisBoard(action: BoardActionTypes) {\n    const {boardOptions} = yield select()\n    const payload = {\n        ...createAnalysisBoard({boardOptions}),\n    }\n    yield put({type: BA.UPDATE_BOARD_STATE, payload})\n}\n\nfunction* animateFreeMove(move: IMoveProps) {\n    const {board, boardOptions: {reversedBoard}} = yield select()\n    const {moveToSave} = move as IMoveProps\n    const [from, to] = moveToSave.move.split('-')\n    tur.relocateTower(from, to, board, reversedBoard)\n    yield delay(AnimationDuration)\n    const newState: IRootState = yield select()\n    tur.finalizeSimpleMove(from, to, newState.board, reversedBoard)\n}\n\nfunction* animateMandatoryTowerStep(props: Partial<IMoveProps>, step = 0) {\n    const {gameOptions: { reversedBoard}, board} = yield select()\n    const {moveToSave: {move, position, takenPieces}} = props as IMoveProps\n    const [from, to] = move.split(':').slice(step)\n    const totalSteps = takenPieces!.length \n    const capturedTowerKey = takenPieces![step]\n        let tower = position[capturedTowerKey].tower as TowerConstructor\n        tur.relocateTower(from, to, board, reversedBoard)\n        yield delay(AnimationDuration / totalSteps / 2)\n        let state: IRootState = yield select()\n        let towers = copyMap(state.board.towers)\n        if (tower) {\n            tower =  new TowerConstructor(tower)\n            tower.onBoardPosition = capturedTowerKey\n            tower.positionInDOM = tur.calcTowerPosition(capturedTowerKey, board.cellsMap, board.cellSize, reversedBoard)\n            towers.set(capturedTowerKey, tower)\n        } else {\n            towers.delete(capturedTowerKey)\n        }\n        yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {towers}})\n        yield delay(AnimationDuration / totalSteps / 2)\n        state = yield select()\n        towers = tur.finalizeMandatoryMoveStep(from, to, state.board, reversedBoard)\n        yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {towers}})\n}\n\nfunction* animateMandatoryStep(props: Partial<IMoveProps>, step = 0) {\n    const {gameOptions: {gameVariant, reversedBoard}, board} = yield select()\n    if (gameVariant === 'towers') {\n        yield animateMandatoryTowerStep(props, step)\n    } else {\n        const {moveToSave: {move, takenPieces}} = props as IMoveProps\n        const [from, to] = move.split(':').slice(step)\n        const totalSteps = takenPieces!.length \n        const isLast = totalSteps === step + 1\n        tur.relocateTower(from, to, board, reversedBoard)\n        yield delay(AnimationDuration / totalSteps)\n        let state: IRootState = yield select()\n        const towers = tur.finalizeMandatoryMoveStep(from, to, state.board, reversedBoard, isLast)\n        yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {towers}})\n        if (isLast) {\n            state = yield select()\n            const towers = copyMap(state.board.towers)\n            takenPieces!.forEach(pKey => {\n                towers.delete(pKey)\n            })\n            yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: {towers}})\n        }\n    }\n}\n\nfunction* animateMandatoryMove(props: Partial<IMoveProps>, step = 0): any {\n    const {moveToSave: {takenPieces}} = props as IMoveProps\n    if (takenPieces?.length === 1 || takenPieces?.length === step + 1) {\n        yield animateMandatoryStep(props, step) \n    } else {\n        yield animateMandatoryStep(props, step)\n        yield animateMandatoryMove(props, step + 1)\n    }\n}\n\nfunction* workerTurn(action: BoardActionTypes) {\n    const payload = action.payload as IMoveProps\n    const {game: {history}, user: {name}, board} = yield select()\n    const {moveToSave: {move, position}, moveOrder} = payload\n    const key = history.length ? `${history.join('_')}_${move}` : move\n    const positionsTree = copyMap(board.positionsTree)\n    positionsTree.set(key, position)\n    let lastMoveSquares = board.lastMoveSquares\n    if (moveOrder.playerTurn === name) {\n        if (move.includes(':')) {\n            lastMoveSquares = move.split(':')\n            yield animateMandatoryMove(payload)\n        } else {\n            lastMoveSquares = move.split('-')\n            yield animateFreeMove(payload)\n        }\n    }\n    const boardProps = {currentPosition: position, positionsTree, lastMoveSquares}\n    yield put ({type: BoardActions.UPDATE_BOARD_STATE, payload: boardProps})\n    yield put({type: GameActions.MAKE_MOVE, payload})\n}\n\nfunction* workerUndo() {\n    const {\n        board: {positionsTree, cellSize, cellsMap},\n        game: {history, moveOrder: {pieceOrder}, playerColor},\n        user: {name},\n        boardOptions: {reversedBoard}\n    } = yield select()\n    if (!history.length) return\n    let gamePayload: Partial<IGameState>, boardPayload: Partial<IGameBoard>\n    if (pieceOrder === playerColor) {\n        gamePayload = {\n            history: history.slice(0, -2)\n        }\n        const currentPosition = positionsTree.get(gamePayload.history!.join('_'))\n        const _towers = tur.updateTowersToBoard(currentPosition)\n        const towers = tur.updateTowersPosition(cellSize, _towers, cellsMap, reversedBoard)\n        boardPayload = {\n            lastMoveSquares: splitMove(gamePayload.history?.slice(-1)[0] || ''),\n            currentPosition,\n            towers,\n            animationStarted: false,\n        }\n    } else {\n        gamePayload = {\n            history: history.slice(0, -1),\n            moveOrder: {pieceOrder: oppositColor(pieceOrder), playerTurn: name}\n        }\n        const currentPosition = positionsTree.get(gamePayload.history!.join('_'))\n        const _towers = tur.updateTowersToBoard(currentPosition)\n        const towers = tur.updateTowersPosition(cellSize, _towers, cellsMap, reversedBoard)\n        boardPayload = {\n            lastMoveSquares: splitMove(gamePayload.history?.slice(-1)[0] || ''),\n            currentPosition: positionsTree.get(gamePayload.history!.join('_')),\n            towers,\n            animationStarted: false,\n        }\n    }\n    yield put({type: GameActions.UPDATE_GAME_STATE, payload: gamePayload})\n    yield put({type: BoardActions.UPDATE_BOARD_STATE, payload: boardPayload})\n}\n\nexport default function* watcherBoard() {\n    yield takeLatest(BA.CREATE_SETUP_BOARD, workerSetupBoard);\n    yield takeLatest(BA.CREATE_GAME_BOARD, workerGameBoard)\n    yield takeLatest(BA.CREATE_ANALYSIS_BOARD, workerAnalysisBoard)\n    yield takeLatest(GameOptionActions.SET_GAME_VARIANT, workerBoardSize)\n    yield takeLatest(BoardActions.TURN, workerTurn)\n    yield takeLatest(BoardActions.UNDO_LAST_MOVE, workerUndo)\n}\n","import { all } from 'redux-saga/effects';\nimport watcherGame from './watcherGame';\n// import watcherUser from './watcherUser';\nimport watcherPreGame from './watcherGamePresets';\nimport watcherTimer from './watcherTimer';\n// import watcherApp from './watcherApp';\nimport watcherAnalsis from './watcherGameAnalysis'\nimport watcherBoard from './watcherBoard';\n\nexport default function* sagaRoot() {\n    yield all([\n        watcherPreGame(),\n        // watcherUser(),\n        watcherGame(),\n        watcherTimer(),\n        // watcherApp(),\n        watcherAnalsis(),\n        watcherBoard(),\n    ]);\n}\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport { composeWithDevTools } from 'redux-devtools-extension'\n\nimport {InitialState, AppReducers} from './rootState&Reducer';\nimport sagaRoot from './sagas/sagaRoot';\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst storeFactory = (data = InitialState) => {\n    const middleware = composeWithDevTools(applyMiddleware(sagaMiddleware));\n    const rootReducer = combineReducers(AppReducers)\n    const store = createStore(rootReducer, data, middleware)\n    sagaMiddleware.run(sagaRoot);\n    return store;\n};\n\nexport default storeFactory;\n\nexport type Store = ReturnType<typeof storeFactory>\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport {Provider} from 'react-redux'\nimport storeFactory from './store'\nimport {InitialState} from './store/rootState&Reducer'\nimport { UserActions } from './store/user/types';\n// import {GameActions} from './store/game/types';\n// import {wsOnError, wsOnMessage} from './web-sockets/ws'\n// import {errorHandler} from './web-sockets/event-handlers/ws-error-handler'\n// import {messageHandler} from './web-sockets/event-handlers/ws-message-handler'\n\nimport './assets/scss/style.scss'\nimport { AppActions } from './store/app/types';\n\n\nconst store = storeFactory(InitialState)\n\n// wsOnError(errorHandler, store)\n\n// wsOnMessage(messageHandler, store)\n\n\nReactDOM.render(\n  <Provider store={store}>\n      <React.StrictMode>\n        <App />\n      </React.StrictMode>\n  </Provider>,\n  document.getElementById('root') \n);\n\nstore.dispatch({type: UserActions.CHECK_STORAGE})\n\nif (window) {\n  const payload = window.innerWidth / window.innerHeight < 1.3\n  store.dispatch({type: AppActions.SET_PORTRAIT, payload})\n}\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}