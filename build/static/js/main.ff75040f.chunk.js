(this["webpackJsonptowers-draughts-client"]=this["webpackJsonptowers-draughts-client"]||[]).push([[1],[,,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r,a,o,c=n(23);!function(e){e.m="man",e.k="king"}(r||(r={})),function(e){e.b="black",e.w="white"}(a||(a={})),function(e){e.r="chess",e.i="international"}(o||(o={}));var i,s=function e(t){Object(c.a)(this,e),this.onBoardPosition=void 0,this.currentColor=void 0,this.wPiecesQuantity=void 0,this.bPiecesQuantity=void 0,this.positionInDOM=void 0,this.currentType=void 0,this.veiw=void 0,this.mandatoryMove=void 0,this.currentType=t.currentType||r.m,this.currentColor=t.currentColor,this.wPiecesQuantity=t.wPiecesQuantity||(t.currentColor===a.w?1:0),this.bPiecesQuantity=t.bPiecesQuantity||(t.currentColor===a.b?1:0),this.positionInDOM=t.positionInDOM||{x:0,y:0},this.onBoardPosition=t.onBoardPosition,this.veiw=t.veiw||"face",this.mandatoryMove=t.mandatoryMove||!1};!function(e){e[e.online=0]="online",e[e.offline=1]="offline",e[e.reconnecting=2]="reconnecting"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"l",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"k",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"o",(function(){return O})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"n",(function(){return _}));var r=["a","b","c","d","e","f","g","h","i","k","l","m"],a=new Array(12).fill(0).map((function(e,t){return t+1})),o=300,c=8,i=[[1,0],[2,1],[3,0],[3,1],[5,0],[5,3],[10,0],[10,3],[15,0]],s=10,u=1e3,l=50,d=300,b=.7,O="https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D1%88%D0%BA%D0%B8#%D0%A1%D1%82%D0%BE%D0%BB%D0%B1%D0%BE%D0%B2%D1%8B%D0%B5",p={home:"/",game:"/game",settings:"/settings",analysis:"/analysis",stats:"/stats",rules:"/rules",auth:"/auth",profile:"/profile"},v={home:"home",game:"apps",analyze:"zoom_in",rules:"import_contacts",stats:"insert_chart",settings:"settings",profile:"person",auth:"login"},f=["a1","a3","b2","c1","c3","d2","e1","e3","f2","g1","g3","h2"],j=["a7","b8","b6","c7","d8","d6","e7","f8","f6","g7","h8","h6"],h=["b4","d4","f4","h4","a5","c5","e5","g5"],T=(h.concat(["k4","i5"]),f.concat(["i1","i3","k2","b4","d4","f4","h4","k4"])),E=j.filter((function(e){return!e.includes("6")})).concat(["i7","k10","k8","i9","a9","c9","e9","g9","b10","d10","f10","h10"]),m=h.concat(["k4","i5"]),y=function(e){return 8===e?j:E},_=function(e){return 8===e?f:T};E.concat(T).concat(m)},,function(e,t,n){"use strict";n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return f})),n.d(t,"i",(function(){return j}));var r=n(0),a=n(17),o=n(6),c=function(e){return e.includes(":")?e.split(":"):e.split("-")},i=function(e){return e===o.b.w?o.b.b:o.b.w},s=function(e){var t=new Map;return e.forEach((function(e,n){"object"===typeof e?Array.isArray(e)?t.set(n,Object(a.a)(e)):t.set(n,Object(r.a)({},e)):t.set(n,e)})),t},u=function(e){return Object.keys(e).reduce((function(t,n){var o=e[n];return"object"===typeof o?Array.isArray(o)?t[n]=Object(a.a)(o):t[n]=Object(r.a)({},o):t[n]=o,t}),{})},l=function(e,t){var n=new Map,r=e.mandatoryMoveStep,a=e.mandatoryMoves,o=e.cellsMap;return a.filter((function(e){return e.move.includes(t)})).map((function(e){return e.move.split(":")[r+1]})).forEach((function(e){n.set(e,o.get(e))})),n},d=function(e,t){return JSON.stringify(Object(a.a)(e.entries()))!==JSON.stringify(Object(a.a)(t.entries()))},b=function(e){var t=e.reduce((function(e,t){return e>t.move.length?e:t.move.length}),0);return e.reduce((function(e,n){return n.move.length===t?e.cont.push(n):e.ended.push(n),e}),{ended:[],cont:[]})},O=function(e){var t={};return t["".concat(e.includes("left")?"left":"right").concat(e.includes("Up")?"Down":"Up")]=!0,t["".concat(e.includes("left")?"right":"left").concat(e.includes("Up")?"Up":"Down")]=!0,t};function p(e,t,n,r){var o=t.entries(),c=n,i=r.current.querySelector(".board__body").getBoundingClientRect(),s=[e.x-i.x,e.y-i.y],u=s[0],l=s[1];if(u<0||l<0)return null;var d=Object(a.a)(o).filter((function(e){var t=e[1].x+c/4,n=e[1].y+c/4;return Math.sqrt(Math.pow(t-u,2)+Math.pow(n-l,2))<c}))[0];return d?d[0]:null}var v=function(e,t){var n=function(e){return Object.values(e).filter((function(e){var t;return(null===(t=e.tower)||void 0===t?void 0:t.currentType)===o.d.k})).length};return n(e)!==n(t)},f=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push({white:e[n],black:e[n+1]||""});return t};function j(e,t){var n=e.querySelector(".board__body").getBoundingClientRect(),r=n.width,a=n.left,o=n.right,c=(r||a-o)/t;return Math.round(c)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={SET_MOVE_ORDER:"SET_MOVE_ORDER",SET_GAME_STARTED:"SET_GAME_STARTED",MAKE_MOVE:"MAKE_MOVE",CONFIRM_START_GAME:"CONFIRM_START_GAME",UPDATE_GAME_STATE:"UPDATE_GAME_STATE",INEFFECTIVE_MOVE:"INEFFECTIVE_MOVE",SAVE_MOVE_TO_HISTORY:"SAVE_HISTORY",SET_PLAYER_MOVE_ORDER:"SET_PLAYER_MOVE_ORDER",SET_GAME:"SET_GAME",END_GAME:"END_GAME",OFFER_DRAW:"OFFER_DRAW",DECLINE_DRAW:"DECLINE_DRAW",RIVAL_OFFER_DRAW:"RIVAL_OFFER_DRAW",SURRENDER:"SURRENDER",SET_PORTRAIT:"SET_PORTRAIT",SET_GAME_MODE:"SET_GAME_MODE",CANCEL_GAME:"CANCEL_GAME",NEW_GAME_VS_PC:"NEW_GAME_VS_PC",NEW_GAME_VS_PLAYER:"NEW_GAME_VS_PLAYER",CLEAR_HISTORY:"CLEAR_HISTORY"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={ANALYZE_LAST_GAME:"ANALYZE_LAST_GAME",DOWNLOAD_GAME:"DOWNLOAD_GAME",SAVE_GAME_RESULT:"SAVE_GAME_RESULT",SETTING_BOARD:"SETTING_BOARD",UPDATE_POSITION:"UPDATE_POSITION",STEP_FORWARD:"STEP_FORWARD",STEP_BACK:"STEP_BACK",SAVE_POSITION:"SAVE_POSITION",GO_TO_POSITION:"GO_TO_POSITION",CREATE_POSITION_TREE:"CREATE_POSITION_TREE",UPDATE_ANALYSIS_STATE:"UPDATE_ANALYSIS_STATE",EVALUATE_POSITION:"EVALUATE_POSITION",SET_DEPTH:"SET_DEPTH",PLAY_MOVES:"PLAY_MOVES",SET_START_POSITION:"SET_START_POSITION",REMOVE_PIECE:"REMOVE_PIECE",START_NEW_LINE:"START_NEW_LINE",MAKE_NEW_MOVE:"MAKE_NEW_MOVE"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={CREATE_GAME_BOARD:"CREATE_GAME_BOARD",CREATE_SETUP_BOARD:"CREATE_SETUP_BOARD",CREATE_ANALYSIS_BOARD:"CREATE_ANALYSIS_BOARD",UPDATE_BOARD_STATE:"UPDATE_BOARD_STATE",UPDATE_BOARD_SIZE:"UPDATE_BOARD_SIZE",UPDATE_BOARD_MAP:"UPDATE_BOARD_MAP",TURN:"TURN",UPDATE_POSITION_TREE:"CREATE_POSITION_TREE",UNDO_LAST_MOVE:"UNDO_LAST_MOVE"}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={CHOOSE_COLOR:"CHOOSE_COLOR",SET_TIME_LIMIT:"SET_TIME_LIMIT",SET_TIME_ADDS:"SET_TIME_ADDS",SET_GAME_TIMING:"SET_GAME_TIMING",SET_RIVAL:"SET_RIVAL",SET_PLAYER:"SET_PLAYER",SET_GAME_VARIANT:"SET_GAME_VARIANT",SET_RIVAL_ONLINE_STATUS:"SET_RIVAL_ONLINE_STATUS",SET_PLAYER_ONLINE_STATUS:"SET_PLAYER_ONLINE_STATUS",SET_GAME_TYPE:"SET_GAME_TYPE",SET_RIVAL_LEVEL:"SET_RIVAL_LEVEL",FIND_RIVAL:"FIND_RIVAL",SET_RIVAL_TYPE:"SET_RIVAL_TYPE",FINISH_GAME_SETUP:"FINISH_GAME_SETUP",WAIT_RIVAL:"WAIT_RIVAL",CANCEL_RIVAL_WAITING:"CANCEL_RIVAL_WAITING",REMATCH_REQUEST:"REMATCH_REQUEST"}},function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"i",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return v})),n.d(t,"b",(function(){return j}));var r=n(6),a=n(7),o=function(e){return e===r.b.w?r.b.b:r.b.w},c=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t={},n=0;n<e;n++)for(var r=0;r<e;r++)if((n+r+1)%2){var o="".concat(a.l[n]).concat(a.j[r]);t[o]={boardKey:o,tower:null,neighbors:O(n,r,e)}}return t},i=function(e){var t=e.boardOptions,n=t.boardSize,r=t.reversedBoard,o=v(n),c=new Map;return c.set("sp",o),{towers:j(n),cellSize:a.c,cellsMap:d(n,a.c,r),animationStarted:!1,mandatoryMoves:[],moveDone:!1,mandatoryMoveStep:0,currentPosition:o,mouseDown:!1,lastMoveSquares:[],positionsTree:c}},s=function(e){var t=e.boardOptions,n=t.boardSize,r=t.reversedBoard,o=c(n),i=new Map;return i.set("sp",o),{towers:h(n),cellSize:a.c,cellsMap:d(n,a.c,r),currentPosition:o,positionsTree:i,mandatoryMoves:[],mandatoryMoveStep:0,mouseDown:!1,lastMoveSquares:[]}},u=function(e){var t=e.boardOptions,n=t.boardSize,r=t.reversedBoard;return{cellSize:a.c,cellsMap:d(n,a.c,r),mandatoryMoves:[],mandatoryMoveStep:0,mouseDown:!1,lastMoveSquares:[]}},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,o=n?a.l.slice(0,r).reverse():a.l.slice(0,r),c=n?a.j.slice(0,r):a.j.slice(0,r).reverse(),i=c.indexOf(parseInt(e.slice(1)))*t,s=o.indexOf(e[0])*t;return{x:s,y:i}},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.c,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new Map;return Object.keys(c(e)).forEach((function(a){r.set(a,l(a,t,n,e))})),r},b=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=50===e.size?10:8,a=new Map;return e.forEach((function(e,o){a.set(o,l(o,t,n,r))})),a};function O(e,t,n){var r=a.l.slice(0,n),o=a.j.slice(0,n),c={};return e&&(t<n-1&&(c.leftUp="".concat(r[e-1]).concat(o[t+1])),t&&(c.leftDown="".concat(r[e-1]).concat(o[t-1]))),e<n-1&&(t<n-1&&(c.rightUp="".concat(r[e+1]).concat(o[t+1])),t&&(c.rightDown="".concat(r[e+1]).concat(o[t-1]))),c}var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.d.m,n=e===r.b.w?1:0,a=e===r.b.b?1:0;return{currentColor:e,currentType:t,wPiecesQuantity:n,bPiecesQuantity:a}};function v(e){for(var t=c(e),n=Object(a.m)(e),o=Object(a.n)(e),i=0,s=Object.keys(t);i<s.length;i++){var u=s[i];t[u].tower=n.includes(u)&&p(r.b.b)||(o.includes(u)?p(r.b.w):null)}return t}var f=function(e,t){return{currentType:r.d.m,currentColor:t,onBoardPosition:e,bPiecesQuantity:t===r.b.w?0:1,wPiecesQuantity:t===r.b.w?1:0}},j=function(e){var t=new Map;return Object(a.m)(e).forEach((function(e){t.set(e,new r.c(f(e,r.b.b)))})),Object(a.n)(e).forEach((function(e){t.set(e,new r.c(f(e,r.b.w)))})),t},h=function(e){var t=new Map;return Object(a.m)(e).forEach((function(e,n){var a="oB b".concat(n);t.set(a,new r.c(f(a,r.b.b)))})),Object(a.n)(e).forEach((function(e,n){var a="oW w".concat(n);t.set(a,new r.c(f(a,r.b.w)))})),t}},,,function(e,t,n){"use strict";var r=n(0),a=n(23),o=n(28),c=n(30),i=n(29),s=n(7),u=n(6),l=n(41),d=n(9),b=n(16),O=new(function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var o=arguments.length,c=new Array(o),i=0;i<o;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).currentPosition=Object(b.e)(e.size),e.previousPosition=Object(b.e)(e.size),e.callBack=function(){},e.setCalBack=function(t){e.callBack=t},e.calcPositionOutboardTowers=function(e,t,n){var r=document.querySelector(".board__body"),a=Math.round(r.getBoundingClientRect().height),o=s.d*t,c=Math.round(t/2-o/2),i=Math.round(a-t/2-o/2),u=Math.round(-5-t+c);return n&&e.includes("oB")||!n&&e.includes("oW")?{x:u,y:i}:{x:u,y:c}},e.calcTowerPosition=function(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.includes("oB")||t.includes("oW"))return e.calcPositionOutboardTowers(t,r,a);var o=n.get(t);if(!o)return{x:0,y:0};var c=o.x,i=o.y,s=document.querySelector(".checker-tower");s||console.error(s);var u=s.getBoundingClientRect(),l=u.width;return{x:Math.round(c-l/2+r/2),y:Math.round(i-l/2+r/2)}},e.updateTowersPosition=function(t,n,a){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(d.e)(n);return n.forEach((function(n,i){var s=e.calcTowerPosition(i,a,t,o),u=Object(r.a)(Object(r.a)({},n),{},{positionInDOM:s,onBoardPosition:i});c.set(i,u)})),c},e.updateCellsPosition=function(t,n,r){var a=t.cellsMap,o=t.cellSize,c=t.towers,i=n.reversedBoard,s=n.boardSize,u=Object(d.i)(r,s);if(o!==u){var l=Object(b.i)(a,u,i),O=e.updateTowersPosition(u,c,l,i);e.callBack({towers:O,cellsMap:l,cellSize:u})}},e}return Object(o.a)(n,[{key:"animateMadatoryMove",value:function(e){}},{key:"animateSimpleMove",value:function(e,t,n){}},{key:"relocateTower",value:function(e,t,n,r){var a=n.cellSize,o=n.cellsMap,c=Object(d.e)(n.towers),i=c.get(e);i.positionInDOM=this.calcTowerPosition(t,o,a,r),c.set(e,i),console.log(i),this.callBack({towers:c})}},{key:"finalizeSimpleMove",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=n.cellSize,o=n.cellsMap,c=Object(d.e)(n.towers),i=c.get(e);i.onBoardPosition=t,i.currentType=this.checkTowerTypeChanging(t,this.size,i.currentColor,i.currentType),i.positionInDOM=this.calcTowerPosition(t,o,a,r),c.set(t,i),c.delete(e);var s=null,u=[e,t];this.callBack({towers:c,towerTouched:s,lastMoveSquares:u,mouseDown:!1,moveDone:!0})}},{key:"finalizeMandatoryMoveStep",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Object(d.e)(n.towers),c=n.cellSize,i=n.cellsMap,s=o.get(e);return s.onBoardPosition=t,"towers"===this.GV&&(s.currentColor===u.b.w?s.bPiecesQuantity=s.bPiecesQuantity+1:s.wPiecesQuantity=s.wPiecesQuantity+1),("international"!==this.GV||a)&&(s.currentType=this.checkTowerTypeChanging(t,this.size,s.currentColor,s.currentType)),s.positionInDOM=this.calcTowerPosition(t,i,c,r),o.set(t,s),o.delete(e),console.log(s),o}},{key:"setPositions",value:function(e,t){var n;n=t.join("_");var a=null===e||void 0===e?void 0:e.get(n);this.previousPosition=Object(r.a)({},this.currentPosition),this.currentPosition=a}},{key:"updateTowersOnMandatoryMoveStep",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o="towers"===this.GV,c=this.updateTowersAfterMoveAnimation(e,t,n,o,a);if(o){var i=r[0],s=c.get(i),u=this.cuptureTower(s);return u?c.set(i,u):c.delete(i),c}return a?(console.log(c,r),r.forEach((function(e){c.delete(e)})),c):c}},{key:"updateTowersToBoard",value:function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r=e[n].tower;if(r){var a=new u.c(r);a.onBoardPosition=n,t.set(n,a)}})),t}},{key:"updateMiddleTowerOnOpponentMove",value:function(e,t,n){var a=Object(d.e)(t.towers),o=n[e].tower;if(o){var c=Object(r.a)(Object(r.a)({},a.get(e)),o);a.set(e,c)}else a.delete(e);return console.log("middle update",e,a,n,o),a}},{key:"updateTowersAfterMoveAnimation",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=n.cellSize,c=n.cellsMap,i=Object(d.e)(n.towers),s=i.get(e);return r&&(s.currentColor===u.b.w?s.bPiecesQuantity=s.bPiecesQuantity+1:s.wPiecesQuantity=s.wPiecesQuantity+1),s.onBoardPosition=t,s.positionInDOM=this.calcTowerPosition(t,c,o),("international"!==this.GV||a)&&(s.currentType=this.checkTowerTypeChanging(t,this.size,s.currentColor,s.currentType)),i.set(t,s),i.delete(e),i}},{key:"animateRivalTowerMove",value:function(e,t,n){var a=n.cellsMap,o=n.cellSize,c=Object(d.e)(n.towers);return c.get(e).positionInDOM=this.calcTowerPosition(t,a,o),Object(r.a)(Object(r.a)({},n),{},{towers:c})}},{key:"cancelTowerTransition",value:function(e){var t=e.towerTouched.key,n=e.cellSize,a=e.cellsMap,o=e.reversed,c=void 0!==o&&o,i=Object(d.e)(e.towers),s=i.get(t);s.positionInDOM=this.calcTowerPosition(t,a,n,c),i.set(t,s),this.callBack(Object(r.a)(Object(r.a)({},e),{},{towers:i,towerTouched:null,mouseDown:!1}))}}]),n}(l.a));t.a=O},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={SET_GAME_BOARD_OPTIONS:"SET_GAME_BOARD_OPTIONS",REVERSE_BOARD:"REVERSE_BOARD",SET_BOARD_THEME:"SET_BOARD_THEME",SET_BOARD_NOTATION:"SET_BOARD_NOTATION",SET_BOARD_SIZE:"SET_BOARD_SIZE"}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={en:{shortMainTitle:"Draughts",mainTitle:"Tower Draughts",newGame:"New game",submitLog:"Login",submitReg:"Registration",logTitle:"Login",regTitle:"Registration in",logMess:"Please enter Nikname or email and password",regMess:"Please fiil registration form",modeButtonLog:"Do not have registred yet?",modeButtonReg:"Login",labelPassword:"Password",labelNickname:"Nickname or email",submitButton:"Submit",about:"Welcom to Tower-Draughts where, in addition to the classic Russian and international draughts, for the first time, the opportunity to play tower draughts has been implemented - one of the most interesting variants of the checkers game.",about_continue:"The rules of tower's draughts coincide in many respects with the rules of the Russians. The most important difference is that the knocked down checker is not removed from the board but is covered with a hitting checker (a tower of checkers) .In the case when a tower is under attack, one return checker is removed from its top and, if it is the only one of its color, the tower changes color and becomes the enemy's tower. In case of turning into a king, only the top man becomes the king. Another important difference from Russian draughts is the lack of restrictions on capture on previously passed fields (Turkish strike). You can find more information about the game on Wikipedia by clicking on the picture above.",play:"Play"},ru:{shortMainTitle:"\u0428\u0430\u0448\u043a\u0438",mainTitle:"\u0421\u0442\u043e\u043b\u0431\u043e\u0432\u044b\u0435 \u0428\u0430\u0448\u043a\u0438",newGame:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430",submitLog:"\u0412\u043e\u0439\u0442\u0438",submitReg:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",logTitle:"\u0414\u043b\u044f \u0432\u0445\u043e\u0434\u0430 \u0432",regTitle:"\u0414\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0432",logMess:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0432\u043e\u0439 \u043d\u0438\u043a \u0438\u043b\u0438 email \u0438 \u043f\u043e\u0440\u043e\u043b\u044c",regMess:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u043e\u043d\u043d\u0443\u044e \u0444\u043e\u0440\u043c\u0443",modeButtonLog:"\u0415\u0449\u0435 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",modeButtonReg:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442",labelPassword:"\u041f\u0430\u0440\u043e\u043b\u044c",labelNickname:"\u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u043d\u0438\u043a \u0438\u043b\u0438 email",submitButton:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",about:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u043d\u0430 Tower Draughts, \u0433\u0434\u0435 \u043f\u043e\u043c\u0438\u043c\u043e \u043a\u043b\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0445: \u0440\u0443\u0441\u0441\u043a\u0438\u0445 \u0438 \u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u044b\u0445 \u0448\u0430\u0448\u0435\u043a, \u0432\u043f\u0435\u0440\u0432\u044b\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0438\u0433\u0440\u0430\u0442\u044c \u043e\u043d\u043b\u0430\u0439\u043d \u0432 \u0441\u0442\u043e\u043b\u0431\u043e\u0432\u044b\u0435 \u0448\u0430\u0448\u043a\u0438 - \u043e\u0434\u043d\u0443 \u0438\u0437 \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u044b\u0445 \u0432\u0430\u0440\u0438\u0430\u0446\u0438\u0439 \u0448\u0430\u0448\u0435\u0447\u043d\u043e\u0439 \u0438\u0433\u0440\u044b.",about_continue:"\u041f\u0440\u0430\u0432\u0438\u043b\u0430 \u0441\u0442\u043e\u043b\u0431\u043e\u0432\u044b\u0445 \u0448\u0430\u0448\u0435\u043a \u0432\u043e \u043c\u043d\u043e\u0433\u043e\u043c \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442 \u0441 \u043f\u0440\u0430\u0432\u0438\u043b\u0430\u043c\u0438 \u0440\u0443\u0441\u0441\u043a\u0438\u0445. \u0421\u0430\u043c\u043e\u0435 \u0433\u043b\u0430\u0432\u043d\u043e\u0435 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0441\u0431\u0438\u0442\u0430\u044f \u0448\u0430\u0448\u043a\u0430 \u043d\u0435 \u0441\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u0441 \u0434\u043e\u0441\u043a\u0438, \u0430 \u043d\u0430\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0431\u044a\u044e\u0449\u0435\u0439 \u0448\u0430\u0448\u043a\u043e\u0439 (\u0431\u0430\u0448\u043d\u0435\u0439 \u0438\u0437 \u0448\u0430\u0448\u0435\u043a) \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u043a\u043e\u0433\u0434\u0430 \u043f\u043e\u0434 \u0431\u043e\u0435\u043c \u043e\u043a\u0430\u0437\u0430\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0431\u0430\u0448\u043d\u044f, \u0441 \u0435\u0435 \u0432\u0435\u0440\u0448\u0438\u043d\u044b \u0441\u043d\u0438\u043c\u0430\u0435\u0442\u0441\u044f \u043e\u0434\u043d\u0430 \u0448\u0430\u0448\u043a\u0430 \u0438, \u0435\u0441\u043b\u0438 \u043e\u043d\u0430 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u0430\u044f \u0441\u0432\u043e\u0435\u0433\u043e \u0446\u0432\u0435\u0442\u0430, \u0442\u043e \u0431\u0430\u0448\u043d\u044f \u043c\u0435\u043d\u044f\u0435\u0442 \u0446\u0432\u0435\u0442 \u0438 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u0441\u044c\u044f \u0431\u0430\u0448\u043d\u0435\u0439 \u043f\u0440\u043e\u0442\u0438\u0432\u043d\u0438\u043a\u0430. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u0432 \u0434\u0430\u043c\u043a\u0443, \u0434\u0430\u043c\u043a\u043e\u0439 \u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0432\u0435\u0440\u0445\u043d\u044f\u044f \u0448\u0430\u0448\u043a\u0430. \u0415\u0449\u0435 \u043e\u0434\u043d\u0438\u043c \u0432\u0430\u0436\u043d\u044b\u043c \u043e\u0442\u043b\u0438\u0447\u0438\u0435\u043c \u043e\u0442 \u0440\u0443\u0441\u0441\u043a\u0438\u0445 \u0448\u0430\u0448\u0435\u043a \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043e\u0442\u0441\u0443\u0442\u0441\u0432\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 \u043d\u0430 \u0432\u0437\u044f\u0442\u0438\u0435 \u043f\u043e \u0440\u0430\u043d\u0435\u0435 \u043f\u0440\u043e\u0439\u0434\u0435\u043d\u043d\u044b\u043c \u043f\u043e\u043b\u044f\u043c (\u0442\u0443\u0440\u0435\u0446\u043a\u0438\u0439 \u0443\u0434\u0430\u0440). \u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0438\u0433\u0440\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043d\u0430\u0439\u0442\u0438 \u043d\u0430 \u0412\u0438\u043a\u0438\u043f\u0435\u0434\u0438\u0438 \u043a\u043b\u0438\u043a\u043d\u0443\u0432 \u043f\u043e \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0435 \u0432\u044b\u0448\u0435.",play:"\u0418\u0433\u0440\u0430\u0442\u044c"}}},,,,function(e,t,n){"use strict";n(3),n(57);var r=n(4);t.a=function(e){return Object(r.jsx)("div",{className:"waiting-rival-spinner",onClick:function(){return e.cancelRivalWaiting()},children:Object(r.jsx)("div",{title:"cancel",className:"logo"})})}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f}));var r=n(51),a=n(17),o=n(30),c=n(29),i=n(20),s=n(0),u=n(23),l=n(28),d=n(7),b=n(6),O=n(9),p=n(16),v=function(){function e(){var t=this;Object(u.a)(this,e),this.GV="towers",this.size=d.b,this.setProps=function(e){t.GV=e.GV,t.size=e.size},this.getCapturedPieceKey=function(e,n,r){var a=t.getInterval(e,n,r).filter((function(e){return e.tower}))[0];return a?a.boardKey:(console.error("invalid rivalMove - tower to take did not find ".concat(e,":").concat(n),r),"")},this.cuptureTower=function(e){if("towers"!==t.GV)return null;var n=e.currentColor,r=e.bPiecesQuantity,a=e.wPiecesQuantity,o=n===b.b.w,c=Object(s.a)(Object(s.a)({},e),{},{currentType:b.d.m,wPiecesQuantity:o?a-1:a,bPiecesQuantity:o?r:r-1});return c.bPiecesQuantity||c.wPiecesQuantity?(o&&!c.wPiecesQuantity?c.currentColor=b.b.b:o||c.bPiecesQuantity||(c.currentColor=b.b.w),c):null}}return Object(l.a)(e,[{key:"checkTowerTypeChanging",value:function(e,t,n,r){return parseInt(e.slice(1))===t&&n===b.b.w||1===parseInt(e.slice(1))&&n===b.b.b?b.d.k:r}},{key:"getInterval",value:function(e,t,n){n[t].tower&&console.error("board",n,e,t);for(var r=this.getMoveDirection([e,t]),a=n[e],o=[];;){var c=a.neighbors[r];if(!c||c===t)break;a=n[c],o.push(a)}return o}},{key:"getDiagonal",value:function(e,t,n){for(var r=n[t],a=[r];r;){var o=r.neighbors[e];if(!o)break;var c=n[o];a.push(c),r=c}return a}},{key:"getDiagonals",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=t[e].neighbors,o={},c=function(e){return!r||Object(O.g)(r)[e]};return Object.keys(a).filter((function(e){return c(e)})).forEach((function(r){o[r]=n.getDiagonal(r,e,t)})),o}},{key:"getMoveDirection",value:function(e){var t=Object(i.a)(e,2),n=t[0],r=t[1];return n[0]>r[0]?parseInt(n.slice(1))>parseInt(r.slice(1))?"leftDown":"leftUp":parseInt(n.slice(1))>parseInt(r.slice(1))?"rightDown":"rightUp"}}]),e}(),f=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).lookForTowerFreeMoves=function(t,n,r){return n[t].tower.currentType===b.d.m?e.checkNeighborsIsEmpty(t,n,r):e.lookForKingFreeMoves(t,n)},e.lookForAllPosibleMoves=function(t,n){for(var r=[],o=0,c=Object.keys(n);o<c.length;o++){var i,s=c[o];if((null===(i=n[s].tower)||void 0===i?void 0:i.currentColor)===t){var u=e.lookForTowerFreeMoves(s,n,t);u.length&&(r=[].concat(Object(a.a)(r),Object(a.a)(u)))}}return r},e.getFromToKeys=function(e,t){for(var n=0;n<e.length;){if(t[e[n]].tower){var r=e.lastIndexOf(e[n]);return r<0?e.slice(n):e.slice(r).length>1?e.slice(r):[]}n++}throw Error("start tower in rivalMove not found")},e.makeMoveWithoutTakingPieces=function(t,n){var r,a,o=Object(O.f)(n),c=e.getFromToKeys(t,n),i=[c[0],c.slice(-1)[0]],u=i[0],l=i[1];if(u!==l){var d=Object(s.a)({},o[u].tower),p=d.currentColor===b.b.w;e.checkLastLine(l,p)&&"international"!==e.GV&&(d.currentType=b.d.k),o[l].tower=d,o[u].tower=null}return(null===(r=o[l])||void 0===r?void 0:r.tower)||console.error("error on board",t,o,n),o[u].tower&&!(null===(a=o[l].tower)||void 0===a?void 0:a.currentColor)&&console.error("board was updated incorrectly whithout taken",t,o,n),o},e.getBoardFromTowers=function(t){var n=Object(p.c)(e.size);return t.forEach((function(e,t){var r=e.wPiecesQuantity,a=e.bPiecesQuantity,o=e.currentColor,c=e.currentType;t.includes(" ")||(n[t].tower={wPiecesQuantity:r,bPiecesQuantity:a,currentColor:o,currentType:c})})),n},e.getNewOrder=function(e){var t=Object(O.j)(e.moveOrder.pieceOrder);return{pieceOrder:t,playerTurn:e[t].name}},e.getPropsToMakeFreeMove=function(t,n,r){var a=Object(O.j)(r.moveOrder.pieceOrder),o={pieceOrder:a,playerTurn:r[a].name},c=e.makeFreeMove(t,n,r.currentPosition);return{moveOrder:o,moveToSave:{move:"".concat(t,"-").concat(n),position:c}}},e.manTowerFreeMoves=function(e,t,n){var r=e.onBoardPosition,a=e.currentColor,o=new Map,c=t[r].neighbors;return Object.values(c).forEach((function(e){var c=t[e],i=[parseInt(r.slice(1)),parseInt(e.slice(1))],s=i[0],u=i[1];(a===b.b.b&&!c.tower&&s>u||a===b.b.w&&!c.tower&&s<u)&&o.set(e,n.get(e))})),o},e.kingTowerFreeMoves=function(t,n,r){var a=e.lookForKingFreeMoves(t,n),o=new Map;return a.forEach((function(e){var t=e.split("-"),n=t[t.length-1];o.set(n,r.get(n))})),o},e.makeMandatoryMove=function(t,n){t.length<2&&console.error("makeObligatedMove: incorrect rivalMove length");var r=e.getFromToKeys(t,n);if(!r.length)return n;if(2===r.length)return e.makeMandatoryMoveStep(r,n,!0);var a=e.makeMandatoryMoveStep(r,n);return e.makeMandatoryMove(r.slice(1),a)},e.updateBoardOnMandatoryMoveStep=function(t,n){return"towers"===e.GV?e.makeMandatoryMove(t,n):e.makeMoveWithoutTakingPieces(t,n)},e.makeMandatoryMoveStep=function(t,n){var r,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(O.f)(n),c=Object(i.a)(t,2),s=c[0],u=c[1];s!==u&&u&&s||console.error("error in step",t,n);var l=Object(O.f)(n[s]).tower,d=e.getCapturedPieceKey(s,u,n),p=e.cuptureTower(o[d].tower);return l&&d?("towers"===e.GV&&(l.currentColor===b.b.w?l.bPiecesQuantity+=1:l.wPiecesQuantity+=1),o[s].tower=null,o[d].tower=p,("international"!==e.GV||a)&&(l.currentType=e.checkTowerTypeChanging(u,e.size,l.currentColor,l.currentType)),o[u].tower=l,!o[t[0]].tower&&(null===(r=o[t[1]].tower)||void 0===r?void 0:r.currentColor)||console.error("board was updated incorrectly",t,o,n),o):(console.error("invalid board:",JSON.stringify(n),"rivalMove:",t),n)},e}return Object(l.a)(n,[{key:"checkNeighborsIsEmpty",value:function(e,t,n){return Object.values(t[e].neighbors).filter((function(r){return(n===b.b.w?parseInt(e.slice(1))<parseInt(r.slice(1)):parseInt(e.slice(1))>parseInt(r.slice(1)))&&!t[r].tower})).map((function(t){return"".concat(e,"-").concat(t)}))}},{key:"getCapturedTowers",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.length;return a<2?n:(n.push(this.getCapturedPieceKey(e[r],e[r+1],t)),2===a||r===a-2?n:(r+=1,this.getCapturedTowers(e,t,n,r)))}},{key:"makeFreeMove",value:function(e,t,n){var r=Object(O.f)(n);r[e]||console.error("makeFreeMove invalid props",e,t,n);var a=Object(s.a)({},r[e].tower),o=Math.sqrt(2*Object.keys(n).length);return a.currentType=this.checkTowerTypeChanging(t,o,a.currentColor,a.currentType),r[t].tower=a,r[e].tower=null,r}},{key:"checkDiagonalForKingMove",value:function(e){var t,n=e[0].boardKey,a=[],o=Object(r.a)(e.slice(1));try{for(o.s();!(t=o.n()).done;){var c=t.value;if(c.tower)break;a.push("".concat(n,"-").concat(c.boardKey))}}catch(i){o.e(i)}finally{o.f()}return a}},{key:"checkLastLine",value:function(e,t){var n=parseInt(e.slice(1));return t&&n===this.size||!t&&0===n}},{key:"lookForKingFreeMoves",value:function(e,t){var n=this,r=this.getDiagonals(e,t),a=[];return Object.values(r).forEach((function(e){a=a.concat(n.checkDiagonalForKingMove(e))})),a}}]),n}(v)},function(e,t,n){"use strict";var r=n(17),a=n(0),o=n(20),c=n(23),i=n(28),s=n(30),u=n(29),l=n(6),d=n(9),b=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"checkKingMandatoryMoves",value:function(e,t){var n;return(n=this.checkFirstKingDiagonals(e,t)).length?this.checkKingNextSteps(n):n}},{key:"checkFirstKingDiagonals",value:function(e,t){var n=this,a=[],o=this.getDiagonals(e.boardKey,t);return Object.values(o).forEach((function(o){var c={move:"".concat(e.boardKey),position:t,takenPieces:[]},i=n.checkDiagonalToMadatoryMove(o,c);i.length&&(a=[].concat(Object(r.a)(a),Object(r.a)(i)))})),a}},{key:"checkKingNextSteps",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],a=n;return e.forEach((function(n){var o=t.checkNextMoveStepDirections(n);o.length?r=r.concat(o):1===e.filter((function(e){return e.move.startsWith(n.move)})).length&&(a=a.concat(n))})),r.length?this.checkKingNextSteps(r,a):a}},{key:"checkIfDiagonalNotFit",value:function(e,t){var n,r;return e.length<3||!e.filter((function(e){var n;return(null===(n=e.tower)||void 0===n?void 0:n.currentColor)!==t})).length||(null===(n=e[1].tower)||void 0===n?void 0:n.currentColor)===t||(null===(r=e[2].tower)||void 0===r?void 0:r.currentColor)===t}},{key:"checkDiagonalToMadatoryMove",value:function(e,t){var n=e[0].tower.currentColor,a=[];if(this.checkIfDiagonalNotFit(e,n))return a;for(var o=1;o<e.length-1;){var c,i=e[o].tower,s=e[o+1];if((null===i||void 0===i?void 0:i.currentColor)===n||i&&s.tower)break;var u=e[o].boardKey,l=s.boardKey,d=!(null===(c=t.takenPieces)||void 0===c?void 0:c.includes(u));if(i&&!s.tower&&i.currentColor!==n&&d){if(a.length){var b=a.slice(-1)[0],O=[].concat(Object(r.a)(b.takenPieces),[u]),p="".concat(b.move,":").concat(l),v=this.updateBoardOnMandatoryMoveStep(p.split(":"),b.position);a.push({move:p,position:v,takenPieces:O})}else{var f="".concat(t.move,":").concat(l),j=this.updateBoardOnMandatoryMoveStep(f.split(":"),t.position),h=[].concat(Object(r.a)(t.takenPieces),[u]);a.push({move:f,position:j,takenPieces:h})}o+=2}else{if(!i&&a.length){var T=a[0].move.split(":").slice(0,-1).join(":"),E=a[0].takenPieces,m="".concat(T,":").concat(e[o].boardKey),y=this.updateBoardOnMandatoryMoveStep(m.split(":"),t.position);a.push({move:m,position:y,takenPieces:E})}o+=1}}var _=e[o];if(o===e.length-1&&!_.tower&&a.length&&!a.filter((function(e){return e.move.includes(_.boardKey)})).length){var g=a[0].move.split(":").slice(0,-1).join(":"),A=a[0].takenPieces,w="".concat(g,":").concat(_.boardKey),x=this.updateBoardOnMandatoryMoveStep(w.split(":"),t.position);a.push({move:w,position:x,takenPieces:A})}return a}},{key:"checkNextMoveStepDirections",value:function(e){var t=this,n=e.move.split(":").slice(-2),a=n[1],o=this.getMoveDirection(n),c=e.position;c&&c[e.move.split(":").slice(-1)[0]].tower||console.error("error in rivalMove",e);var i=this.getDiagonals(a,c,o),s=[];return Object.values(i).forEach((function(n){n[0].tower||console.error("invalid diagonal",n,e);var a=t.checkDiagonalToMadatoryMove(n,e);a.length&&(s=[].concat(Object(r.a)(s),Object(r.a)(a)))})),s}}]),n}(n(41).b),O=(new b,n(16)),p=new(function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).lookForAllMoves=function(t,n){var r=e.lookForMandatoryMoves(t,n);return r.length?r:e.lookForAllPosibleMoves(t,n).map((function(t){var r=t.split("-"),a=Object(o.a)(r,2),c=a[0],i=a[1];return{move:t,position:e.makeFreeMove(c,i,n)}}))},e.checkMandatoryMoveNextStep=function(t){var n=t.move.split(":"),r=n.slice(n.length-2),a=Object(o.a)(r,2),c=a[0],i=a[1],s=t.position,u=s[i],l=u.neighbors,d=[],b=e.getMoveDirection([i,c]);return Object.keys(l).filter((function(e){return e!==b})).forEach((function(n){u.tower||console.error("checkManMoveNextStep invalid start cell",t,s,u,n);var r=e.checkManDirection(u,n,t);r&&d.push(r)})),d},e.checkMandatoryMoveNextSteps=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=n,a=[];return t.forEach((function(t){var n;if((null===(n=t.position[t.move.split(":").slice(-1)[0]].tower)||void 0===n?void 0:n.currentType)===l.d.k&&e.gameVariantMoveContinueRestriction()){var o=e.checkKingNextSteps([t]);o.length?r=r.concat(o):r.push(t)}else{var c=e.checkMandatoryMoveNextStep(t);c.length?a=a.concat(c):"international"!==e.GV&&(r.filter((function(e){return e.move.startsWith(t.move)})).length||r.push(t))}})),a.length?e.checkMandatoryMoveNextSteps(a,r):r},e.removeTakenPieces=function(e){var t=e.takenPieces,n=Object(d.f)(e.position);return t.forEach((function(e){n[e].tower=null})),Object(a.a)(Object(a.a)({},e),{},{position:n})},e.lookForMandatoryMoves=function(t,n){for(var r=[],a=0,o=Object.values(n);a<o.length;a++){var c,i,s=o[a];if((null===(c=s.tower)||void 0===c?void 0:c.currentColor)===t)if((null===(i=s.tower)||void 0===i?void 0:i.currentType)===l.d.k){var u=e.checkKingMandatoryMoves(s,n);u.length&&(r=r.concat(u))}else{var b=e.checkManMandatoryMoves(s,n);b.length&&(r=r.concat(b))}}return r="towers"===e.GV?r:r.map((function(t){return e.removeTakenPieces(t)})),"international"===e.GV?Object(d.h)(r).cont:r},e}return Object(i.a)(n,[{key:"gameVariantMoveContinueRestriction",value:function(){return"international"!==this.GV}},{key:"makeMoves",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(O.e)(this.size),n=Object(d.f)(t),r=0;r<e.length;){var a=e[r];if(a.includes("-")){var c=a.split("-"),i=Object(o.a)(c,2),s=i[0],u=i[1];n[u].tower=t[s].tower,n[s].tower=null}else a.includes(":")&&(n=this.makeMandatoryMove(a.split(":"),t));r+=1}return n}},{key:"checkManFristMandatoryStep",value:function(e,t){var n=this,r=[];return Object.keys(e.neighbors).forEach((function(a){var o={move:"",position:t,takenPieces:[],currentPosition:e.boardKey},c=n.checkManDirection(e,a,o);c&&r.push(c)})),r}},{key:"checkManMandatoryMoves",value:function(e,t){var n;return(n=this.checkManFristMandatoryStep(e,t)).length?this.checkMandatoryMoveNextSteps(n):n}},{key:"checkManDirection",value:function(e,t,n){var a;e.tower||console.error("cod invalid start cell",e,n,t);var o=n.position,c=o[e.neighbors[t]],i=c.boardKey;if("towers"!==this.GV&&n.move.length&&n.takenPieces.includes(i))return null;if((null===c||void 0===c||null===(a=c.tower)||void 0===a?void 0:a.currentColor)===Object(d.j)(e.tower.currentColor)){var s=c.neighbors[t];if(s&&!o[s].tower){var u=n.move.length?"".concat(n.move,":").concat(s):"".concat(null===e||void 0===e?void 0:e.boardKey,":").concat(s);u.split(":").length<2&&console.error("rivalMove too short",u);var l=this.updateBoardOnMandatoryMoveStep(u.split(":"),o);return{move:u,takenPieces:[].concat(Object(r.a)(n.takenPieces),[i]),position:l}}}return null}}]),n}(b));t.a=p},,,,,function(e,t,n){"use strict";n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"j",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return O}));var r=n(15);function a(e){return{type:r.a.SET_RIVAL_LEVEL,payload:e}}function o(e){return{type:r.a.CHOOSE_COLOR,payload:e}}function c(e){return{type:r.a.SET_RIVAL_TYPE,payload:e}}function i(e){return{type:r.a.SET_GAME_TIMING,payload:e}}function s(){return{type:r.a.FIND_RIVAL}}function u(e){return{type:r.a.FINISH_GAME_SETUP,payload:e}}function l(e){return{type:r.a.SET_GAME_VARIANT,payload:e}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:r.a.CANCEL_RIVAL_WAITING,payload:e}}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:r.a.REMATCH_REQUEST,payload:e}}function O(e){return{type:r.a.SET_GAME_TYPE,payload:e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(3),n(70);var r=n(4),a=function(e){var t=e.size,n=void 0===t?16:t;return Object(r.jsx)("i",{className:"logo s-".concat(n)})}},,,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),o=n(39),c=n.n(o),i=n(22),s=n(18),u=n(38),l=n.p+"static/media/game-example.329613c8.gif",d=(n(59),n(4)),b=function(){var e=[1,2,3,4,5,6,7,8].map((function(e,t){return[1,2,3,4,5,6,7,8].map((function(e,n){var r=(t+n)%2?"dark-cell":"light-cell";return Object(d.jsx)("div",{className:r},t+"-"+n)}))}));return Object(d.jsx)("div",{className:"bg-board",children:e})},O=n(7),p=n(34),v=(n(60),n(31)),f=function(){var e=Object(v.c)((function(e){return e.user.language})),t=Object(s.f)(),n=p.a[e.slice(0,2)],a=O.o;return Object(d.jsx)(r.Suspense,{fallback:Object(d.jsx)(u.a,{}),children:Object(d.jsxs)("div",{className:"page home-page",children:[Object(d.jsx)("div",{className:"bg-board"}),Object(d.jsx)(b,{}),Object(d.jsxs)("section",{className:"home-page_content",children:[Object(d.jsx)("span",{children:n.about}),Object(d.jsx)("figure",{className:"game-example-wrapper",children:Object(d.jsxs)("a",{href:a,target:"_blank",rel:"author noreferrer",children:[Object(d.jsxs)("figcaption",{children:[Object(d.jsx)("p",{children:"Tower's draughts game example."}),Object(d.jsx)("p",{children:"Created by Sergey Ivanov."})]}),Object(d.jsx)("img",{width:"200px",src:l,alt:"Tower's Checkers game example"})]})}),Object(d.jsxs)("span",{children:["\xa0",n.about_continue]}),Object(d.jsx)("p",{className:"home-page_to-game_button",children:Object(d.jsx)("button",{className:"new-game",onClick:function(){t.push("game")},type:"button",children:n.play})})]})]})})},j=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,98))})),h=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,97))})),T=function(){return Object(d.jsx)(r.Suspense,{fallback:Object(d.jsx)(u.a,{}),children:Object(d.jsxs)(s.c,{children:[Object(d.jsx)(s.a,{path:O.h.home,exact:!0,children:Object(d.jsx)(f,{})}),Object(d.jsx)(s.a,{path:O.h.game,children:Object(d.jsx)(h,{})}),Object(d.jsx)(s.a,{path:O.h.analysis,children:Object(d.jsx)(j,{})})]})})},E=a.a.memo(T),m=n(20),y=n(47),_="LOGIN_SUCCEED",g="GET_USER_FROM_STORAGE",A="LOGOUT",w="SET_PREFERABLE_LANGUAGE",x="CHECK_STORAGE";var S=function(){var e=Object(r.useState)(!1),t=Object(m.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(!1),s=Object(m.a)(c,2),u=s[0],l=s[1],b="mobile-nav".concat(u?" visible":" hidden").concat(n?" display":" display-none"),p=a.a.createRef(),v=function(e){e.stopPropagation();var t=p.current;if(n&&t){var r=e.target;t.contains(r)||o(!1)}};return Object(r.useEffect)((function(){if(window)return window.addEventListener("click",v),n?void 0:window.removeEventListener("click",v)})),Object(d.jsxs)("div",{onClick:function(e){e.preventDefault(),n?(l(!1),setTimeout((function(){return o(!1)}),300)):(o(!0),setTimeout((function(){return l(!0)}),300))},children:[Object(d.jsx)("button",{className:"mobile-nav-dropdown-btn",children:Object(d.jsx)("i",{className:"material-icons",children:"menu"})}),Object(d.jsxs)("ul",{className:b,ref:p,children:[Object(d.jsx)("li",{children:Object(d.jsx)(i.b,{exact:!0,className:"navlink mobile",to:O.h.home,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.home})})}),Object(d.jsx)("li",{children:Object(d.jsx)(i.b,{className:"navlink mobile",to:O.h.game,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.game})})}),Object(d.jsx)("li",{title:"game analize",children:Object(d.jsx)(i.b,{className:"navlink",to:O.h.analysis,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.analyze})})}),Object(d.jsx)("li",{title:"settings",children:Object(d.jsx)(i.b,{className:"navlink",to:O.h.settings,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.settings})})})]})]})},M=n(48),k={setLanguage:function(e){return{type:w,payload:e}},findRival:y.b},P=Object(v.b)((function(e){return{language:e.user.language,winWidth:e.app.windowSize.width}}),k),R=function(e){var t=e.lang,n=e.setLanguage,r=e.langs;return Object(d.jsx)("button",{title:"change language",className:"change-lang-button",onClick:function(e){return function(e){t===r[0]?n(r[1]):n(r[0]),e.target.blur()}(e)},children:Object(d.jsx)("span",{className:"flag-icon flag-icon-".concat("en"===t?"gb":t," flag-icon-squared")})})},D=P((function(e){var t,n=e.setLanguage,a=e.language,o=e.findRival,c=e.winWidth,u=a.slice(0,2),l=Object(s.f)(),b=Object(r.useState)((null===(t=window)||void 0===t?void 0:t.innerWidth)<500),v=Object(m.a)(b,2),f=v[0],j=v[1];Object(r.useEffect)((function(){j(c<500)}),[c]);f?p.a.en.mainTitle:p.a.en.shortMainTitle;var h=f?Object(d.jsx)(M.a,{size:18}):p.a.en.mainTitle,T=Object(d.jsx)("div",{title:"new game",className:"brand-logo",onClick:function(e){e.preventDefault(),o(),l.push("/game")},children:h});return Object(d.jsx)("nav",{className:"nav",children:Object(d.jsxs)("div",{className:"nav-wrapper",children:[T,Object(d.jsxs)("div",{className:"right-nav",children:[Object(d.jsx)(R,{lang:u,langs:["ru","en"],setLanguage:n}),Object(d.jsx)(S,{}),Object(d.jsxs)("ul",{className:"desktop-nav",children:[Object(d.jsx)("li",{title:"home",children:Object(d.jsx)(i.b,{exact:!0,className:"navlink",to:O.h.home,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.home})})}),Object(d.jsx)("li",{title:"game",children:Object(d.jsx)(i.b,{className:"navlink",to:O.h.game,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.game})})}),Object(d.jsx)("li",{title:"game analize",children:Object(d.jsx)(i.b,{className:"navlink",to:O.h.analysis,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.analyze})})}),Object(d.jsx)("li",{title:"settings",children:Object(d.jsx)(i.b,{className:"navlink",to:O.h.settings,children:Object(d.jsx)("i",{className:"large material-icons",children:O.i.settings})})})]})]})]})})})),I=(n(71),function(){return Object(d.jsx)("header",{className:"header",children:Object(d.jsx)(D,{})})}),C=n(23),N=n(28),L=n(30),G=n(29),B=n.p+"static/media/icons8-github.164d6380.svg",V="SET_PORTRAIT",U="CLOSE",z="WINDOW_SIZE";n(72);var F={close:function(e){return{type:U,payload:e}},setWindowSize:function(e){return{type:z,payload:e}},setPortrait:function(e){return{type:V,payload:e}}},W=Object(v.b)((function(e){return{token:e.user.token,windowSize:e.app.windowSize,portrait:e.app.portrait,game:"isPlaying"===e.game.gameMode}}),F)(function(e){Object(L.a)(n,e);var t=Object(G.a)(n);function n(){var e;Object(C.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).handleResize=function(){if(window){var t=e.props,n=t.windowSize,r=t.setPortrait,a=t.setWindowSize,o=t.portrait,c=n.width,i=n.height,s=window,u=s.innerHeight,l=s.innerWidth;(Math.abs(c-l)>O.b/2||Math.abs(i-u)>O.b/2)&&(a({width:l,height:u}),o&&l/u>1.3?r(!1):!o&&l/u<=1.3&&r(!0))}},e.onClose=function(t){t.preventDefault();var n=e.props.token;n&&e.props.close(n)},e}return Object(N.a)(n,[{key:"componentDidMount",value:function(){window&&(window.addEventListener("beforeunload",this.onClose),window.addEventListener("resize",this.handleResize))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.onClose),window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return Object(d.jsx)("footer",{children:Object(d.jsxs)("a",{href:"https://github.com/evgmsk",target:"blanc",referrerPolicy:"no-referrer",children:["designed by evgmsk\xa0\xa0",Object(d.jsx)("img",{height:"10px",width:"10px",src:B,alt:"github"})]})})}}]),n}(a.a.Component)),K=(n(73),function(){return Object(d.jsxs)(i.a,{children:[Object(d.jsx)(I,{}),Object(d.jsx)(E,{}),Object(d.jsx)(W,{})]})}),Y=function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,96)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))},H=n(32),Q=n(52),q=n(50),Z=n(0),J=n(6),X=n(10),$={moveOrder:{pieceOrder:J.b.w,playerTurn:""},gameConfirmed:!1,gameStarted:!1,history:[],playerColor:J.b.w,white:{},black:{},rivalOfferedDraw:!1,ineffectiveMoves:0,gameMode:"isPreparing"};var ee=n(15),te={gameVariant:"towers",timing:{timeToGame:5,adds:0},playerColor:"random",rivalType:"PC",rivalLevel:1,gameSetupFinished:!1,waitingRival:!1,gameType:"ranked"};var ne,re,ae,oe,ce={name:null,userId:null,token:null,rating:0,language:navigator.language};var ie={windowSize:{width:(null===(ne=window)||void 0===ne?void 0:ne.innerWidth)||100,height:(null===(re=window)||void 0===re?void 0:re.innerHeight)||100},portrait:((null===(ae=window)||void 0===ae?void 0:ae.innerWidth)||100)/((null===(oe=window)||void 0===oe?void 0:oe.innerHeight)||100)<1.3,commonChat:[],gameChat:[]};var se="WHITE_TICK",ue="BLACK_TICK",le="SET_WHITE_CLOCK",de="SET_BLACK_CLOCK",be="WHITE_PRESTART_TICK",Oe="BLACK_PRESTART_TICK",pe="SET_CLOCK",ve={whiteClock:{timeToFirstMove:O.g,timeToGame:O.e,adds:0},blackClock:{timeToFirstMove:O.g,timeToGame:O.e,adds:0}};var fe=n(11),je={gameResult:{},analyzeLastGame:!1,settingPosition:!0,movesMainLine:[],pieceOrder:J.b.w,movesCurrentLine:[],lastMove:{},depth:5,evaluate:!1,removePiece:!1,startPosition:!1};var he=n(16),Te=n(13),Ee={lastMoveSquares:[],towerTouched:null,cellSize:O.c,cellsMap:new Map,currentPosition:Object(he.e)(O.b),towers:new Map,mandatoryMoves:[],posibleMoves:new Map,mouseDown:!1,towerView:"face",mandatoryMoveStep:0,animationStarted:!1,moveDone:!1};var me=n(26),ye={boardTheme:"standart",withOutLegend:!1,lengendsInside:!1,boardNotation:J.a.r,boardSize:O.b,reversedBoard:!1};var _e={user:ce,game:$,gameOptions:te,app:ie,clock:ve,analyze:je,board:Ee,boardOptions:ye},ge={game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X.a.CLEAR_HISTORY:return Object(Z.a)(Object(Z.a)({},e),{},{history:[]});case X.a.SET_GAME_STARTED:return Object(Z.a)(Object(Z.a)({},e),{},{gameStarted:t.payload});case X.a.UPDATE_GAME_STATE:return Object(Z.a)(Object(Z.a)({},e),t.payload);case X.a.SAVE_MOVE_TO_HISTORY:return Object(Z.a)(Object(Z.a)({},e),{},{history:e.history.concat(t.payload)});case X.a.SET_MOVE_ORDER:return Object(Z.a)(Object(Z.a)({},e),{},{moveOrder:t.payload});case X.a.MAKE_MOVE:var n=t.payload,r=n.moveToSave,a=n.moveOrder,o=e.history.concat(r.move);return Object(Z.a)(Object(Z.a)({},e),{},{moveOrder:a,history:o});case X.a.CONFIRM_START_GAME:return Object(Z.a)(Object(Z.a)({},e),{},{gameConfirmed:t.payload});case X.a.SET_GAME:return Object(Z.a)(Object(Z.a)({},e),t.payload);case X.a.INEFFECTIVE_MOVE:return Object(Z.a)(Object(Z.a)({},e),{},{ineffectiveMoves:t.payload});case X.a.RIVAL_OFFER_DRAW:return Object(Z.a)(Object(Z.a)({},e),{},{rivalOfferedDraw:!0});case X.a.DECLINE_DRAW:return Object(Z.a)(Object(Z.a)({},e),{},{rivalOfferedDraw:!1});case X.a.SET_GAME_MODE:return Object(Z.a)(Object(Z.a)({},e),{},{gameMode:t.payload});default:return e}},gameOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee.a.SET_GAME_TYPE:return Object(Z.a)(Object(Z.a)({},e),{},{gameType:t.payload});case ee.a.CHOOSE_COLOR:return Object(Z.a)(Object(Z.a)({},e),{},{playerColor:t.payload});case ee.a.SET_GAME_TIMING:return Object(Z.a)(Object(Z.a)({},e),{},{timing:t.payload});case ee.a.SET_RIVAL_TYPE:return Object(Z.a)(Object(Z.a)({},e),{},{rivalType:t.payload});case ee.a.SET_RIVAL_LEVEL:return Object(Z.a)(Object(Z.a)({},e),{},{rivalLevel:t.payload});case ee.a.FINISH_GAME_SETUP:return Object(Z.a)(Object(Z.a)({},e),{},{gameSetupFinished:t.payload});case ee.a.WAIT_RIVAL:return Object(Z.a)(Object(Z.a)({},e),{},{waitingRival:t.payload});case ee.a.SET_GAME_VARIANT:return Object(Z.a)(Object(Z.a)({},e),{},{gameVariant:t.payload});default:return Object(Z.a)({},e)}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(Z.a)(Object(Z.a)({},e),t.payload);case w:return Object(Z.a)(Object(Z.a)({},e),{},{language:t.payload});case A:return Object(Z.a)(Object(Z.a)({},e),ce);case g:return Object(Z.a)(Object(Z.a)({},e),t.payload);default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(Z.a)(Object(Z.a)({},e),{},{windowSize:t.payload});case V:return Object(Z.a)(Object(Z.a)({},e),{},{portrait:t.payload});default:return e}},clock:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case de:return Object(Z.a)(Object(Z.a)({},e),{},{blackClock:t.payload});case le:return Object(Z.a)(Object(Z.a)({},e),{},{whiteClock:t.payload});case Oe:var n=e.blackClock.timeToFirstMove-1;return Object(Z.a)(Object(Z.a)({},e),{},{blackClock:Object(Z.a)(Object(Z.a)({},e.blackClock),{},{timeToFirstMove:n})});case be:var r=e.whiteClock.timeToFirstMove-1;return Object(Z.a)(Object(Z.a)({},e),{},{whiteClock:Object(Z.a)(Object(Z.a)({},e.whiteClock),{},{timeToFirstMove:r})});case se:var a=e.whiteClock.timeToGame-1;return Object(Z.a)(Object(Z.a)({},e),{},{whiteClock:Object(Z.a)(Object(Z.a)({},e.whiteClock),{},{timeToGame:a})});case ue:var o=e.blackClock.timeToGame-1;return Object(Z.a)(Object(Z.a)({},e),{},{blackClock:Object(Z.a)(Object(Z.a)({},e.blackClock),{},{timeToGame:o})});case pe:return Object(Z.a)(Object(Z.a)({},e),t.payload);default:return e}},analyze:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:je,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe.a.REMOVE_PIECE:return Object(Z.a)(Object(Z.a)({},e),{},{removePiece:t.payload});case fe.a.SAVE_GAME_RESULT:var n=t.payload;return Object(Z.a)(Object(Z.a)({},e),{},{gameResult:n,movesMainLine:n.movesHistory||[]});case fe.a.SET_DEPTH:return Object(Z.a)(Object(Z.a)({},e),{},{depth:t.payload});case fe.a.EVALUATE_POSITION:return Object(Z.a)(Object(Z.a)({},e),{},{evaluate:t.payload});case fe.a.SETTING_BOARD:return Object(Z.a)(Object(Z.a)({},e),{},{settingPosition:t.payload});case fe.a.ANALYZE_LAST_GAME:return t.payload?Object(Z.a)(Object(Z.a)({},e),{},{analyzeLastGame:t.payload,settingPosition:!1}):Object(Z.a)(Object(Z.a)({},e),{},{analyzeLastGame:t.payload});case fe.a.DOWNLOAD_GAME:return Object(Z.a)(Object(Z.a)({},e),{},{gameResult:t.payload});case fe.a.UPDATE_ANALYSIS_STATE:return Object(Z.a)(Object(Z.a)({},e),t.payload);default:return Object(Z.a)({},e)}},board:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Te.a.UPDATE_POSITION_TREE:return Object(Z.a)(Object(Z.a)({},e),{},{positionsTree:t.payload});case Te.a.UPDATE_BOARD_STATE:return Object(Z.a)(Object(Z.a)({},e),t.payload);default:return Object(Z.a)({},e)}},boardOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case me.a.REVERSE_BOARD:return Object(Z.a)(Object(Z.a)({},e),{},{reversedBoard:t.payload});case me.a.SET_BOARD_NOTATION:return Object(Z.a)(Object(Z.a)({},e),{},{boardNotation:t.payload});case me.a.SET_BOARD_SIZE:return Object(Z.a)(Object(Z.a)({},e),{},{boardSize:t.payload});case me.a.SET_BOARD_THEME:return Object(Z.a)(Object(Z.a)({},e),{},{boardTheme:t.payload});case me.a.SET_GAME_BOARD_OPTIONS:return Object(Z.a)(Object(Z.a)({},e),t.payload);default:return Object(Z.a)({},e)}}},Ae=n(5),we=n.n(Ae),xe=n(1),Se=n(9),Me=n(42),ke=n(19),Pe=we.a.mark(Ue),Re=we.a.mark(ze),De=we.a.mark(Fe),Ie=we.a.mark(We),Ce=we.a.mark(Ke),Ne=we.a.mark(Ye),Le=we.a.mark(He),Ge=we.a.mark(Qe),Be=we.a.mark(qe),Ve=we.a.mark(Ze);function Ue(e){var t,n,r,a,o,c,i,s,u,l,d,b,p,v,f;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.c)({type:ee.a.WAIT_RIVAL,payload:!1});case 2:return e.next=4,Object(xe.d)();case 4:if(t=e.sent,n=t.game.gameMode,r=t.boardOptions.boardSize,a=t.gameOptions,o=a.gameVariant,c=a.timing,i=a.playerColor,"isPlaying"!==n){e.next=14;break}return e.next=14,Object(xe.c)({type:X.a.SET_GAME,payload:$});case 14:return s=i,"random"===i&&(s=Math.random()<.5?J.b.w:J.b.b),u=c.timeToGame,l=c.adds,d=c.timeToFirstMove,b={name:"Black"},p={name:"White"},v={timeToGame:60*u,adds:l,timeToFirstMove:void 0===d?10:d},e.next=22,Object(xe.c)({type:me.a.REVERSE_BOARD,payload:s===J.b.b});case 22:return f={moveOrder:{pieceOrder:J.b.w,playerTurn:"White"},black:b,white:p,gameStarted:!0,playerColor:s,history:[],gameConfirmed:!0,gameMode:"isPreparing",portrait:window.innerWidth/window.innerHeight<1.3,ineffectiveMoves:0},ke.a.setProps({GV:o,size:r}),Me.a.setProps({GV:o,size:r}),e.next=27,Object(xe.c)({type:Te.a.CREATE_GAME_BOARD});case 27:return e.next=29,Object(xe.c)({type:X.a.SET_GAME,payload:f});case 29:return e.next=31,Object(xe.c)({type:pe,payload:{blackClock:v,whiteClock:v}});case 31:return e.next=33,Object(xe.c)({type:ee.a.FINISH_GAME_SETUP,payload:!0});case 33:return Object(xe.b)(3*O.a),e.next=36,Object(xe.c)({type:X.a.SET_GAME_MODE,payload:"isPlaying"});case 36:case"end":return e.stop()}}),Pe)}function ze(){var e,t,n,r,a,o,c,i,s,u,l,d,b,p,v,f;return we.a.wrap((function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,Object(xe.d)();case 2:if(e=j.sent,t=e.gameOptions,n=t.playerColor,r=t.rivalLevel,a=void 0===r?1:r,o=t.gameVariant,c=e.boardOptions.boardSize,i=e.user,s=i.name,u=i.rating,"isPlaying"!==e.game.gameMode){j.next=16;break}return j.next=16,Object(xe.c)({type:X.a.SET_GAME,payload:$});case 16:return j.next=18,Object(xe.b)(30);case 18:return l=n,"random"===n&&(l=Math.random()<.5?J.b.w:J.b.b),d={name:"Bot ".concat(a)},b={pieceOrder:J.b.w,playerTurn:l===J.b.w?s:d.name},j.next=24,Object(xe.c)({type:me.a.REVERSE_BOARD,payload:l===J.b.b});case 24:return p=l===J.b.w?{name:s,rating:u}:{name:d.name},v=l===J.b.w?{name:d.name,rivalLevel:a}:{name:s,rating:u},f={moveOrder:b,playerColor:l,white:p,black:v,history:[],gameConfirmed:!0,gameStarted:!0,gameMode:"isPreparing",portrait:window.innerWidth/window.innerHeight<1.3,ineffectiveMoves:0},Me.a.setProps({GV:o,size:c}),ke.a.setProps({GV:o,size:c}),j.next=31,Object(xe.c)({type:Te.a.CREATE_GAME_BOARD});case 31:return j.next=33,Object(xe.c)({type:X.a.SET_GAME,payload:f});case 33:return j.next=35,Object(xe.c)({type:V,payload:window.innerWidth/window.innerHeight<1.3});case 35:return j.next=37,Object(xe.c)({type:ee.a.FINISH_GAME_SETUP,payload:!0});case 37:return Object(xe.b)(3*O.a),j.next=40,Object(xe.c)({type:X.a.SET_GAME_MODE,payload:"isPlaying"});case 40:case"end":return j.stop()}}),Re)}function Fe(e){var t,n,r,a,o;return we.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(xe.d)();case 2:if(t=c.sent,n=t.gameOptions.gameVariant,r=t.board.currentPosition,a=t.game.ineffectiveMoves,o=Object(Se.a)(r,e.moveToSave.position),!e.moveToSave.move.includes(":")&&!o){c.next=12;break}return c.next=10,Object(xe.c)({type:X.a.INEFFECTIVE_MOVE,payload:0});case 10:c.next=19;break;case 12:if(!("international"!==n&&a<36||"international"===n&&a<50)){c.next=17;break}return c.next=15,Object(xe.c)({type:X.a.INEFFECTIVE_MOVE,payload:a+1});case 15:c.next=19;break;case 17:return c.next=19,Object(xe.c)({type:X.a.END_GAME,payload:"drawByRules"});case 19:case"end":return c.stop()}}),De)}function We(e){var t,n,r,a,o,c,i,s,u;return we.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Object(xe.d)();case 2:if(t=l.sent,n=t.game,r=n.gameConfirmed,a=n.history,o=t.clock,c=o.whiteClock,i=o.blackClock,!r){l.next=25;break}if(e.moveOrder.pieceOrder!==J.b.w){l.next=18;break}return s=Object(Z.a)(Object(Z.a)({},i),{},{timeToGame:i.timeToGame+i.adds}),l.next=14,Object(xe.c)({type:de,payload:s});case 14:return l.next=16,Object(xe.c)({type:se});case 16:l.next=23;break;case 18:return u=Object(Z.a)(Object(Z.a)({},c),{},{timeToGame:c.timeToGame+c.adds}),l.next=21,Object(xe.c)({type:le,payload:u});case 21:return l.next=23,Object(xe.c)({type:ue});case 23:l.next=44;break;case 25:if(!(a.length>1)){l.next=37;break}return l.next=28,Object(xe.c)({type:X.a.CONFIRM_START_GAME,payload:!0});case 28:if(e.moveOrder.pieceOrder!==J.b.w){l.next=33;break}return l.next=31,Object(xe.c)({type:se});case 31:l.next=35;break;case 33:return l.next=35,Object(xe.c)({type:ue});case 35:l.next=44;break;case 37:if(e.moveOrder.pieceOrder!==J.b.b){l.next=42;break}return l.next=40,Object(xe.c)({type:Oe});case 40:l.next=44;break;case 42:return l.next=44,Object(xe.c)({type:be});case 44:case"end":return l.stop()}}),Ie)}function Ke(e){var t,n,r;return we.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(xe.d)();case 2:if(t=a.sent,n=t.game.gameStarted,r=e.payload,n){a.next=7;break}return a.abrupt("return");case 7:return a.next=9,Fe(r);case 9:We(r);case 10:case"end":return a.stop()}}),Ce)}function Ye(e){var t,n,r,a,o,c,i;return we.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(xe.d)();case 2:if(t=s.sent,n=t.game,r=n.moveOrder.pieceOrder,a=n.gameMode,o=t.clock.blackClock,"isOver"!==a){s.next=9;break}return s.abrupt("return");case 9:return c="drawByAgreement"===e.payload||"drawByRules"===e.payload,i="abandonedByWhite"===e.payload?J.b.b:"abandonedByBlack"===e.payload?J.b.w:"outOfTime"===e.payload?o.timeToGame?J.b.b:J.b.w:c?"draw":Object(Se.j)(r),s.next=13,Qe(i,e.payload);case 13:case"end":return s.stop()}}),Ne)}function He(e){var t;return we.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=Object(Se.j)(e.payload),n.next=3,Qe(t,"surrender");case 3:case"end":return n.stop()}}),Le)}function Qe(e,t){var n,r,a,o,c,i,s,u,l,d,b,O,p,v,f,j,h;return we.a.wrap((function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,Object(xe.d)((function(e){return e}));case 2:return n=T.sent,r=n.game,a=r.history,o=r.white,c=r.black,i=r.playerColor,T.next=10,Object(xe.d)();case 10:return s=T.sent,u=s.gameOptions,l=u.gameVariant,d=u.timing,b=d.timeToGame,O=d.adds,p=s.boardOptions.boardSize,v=i===J.b.w?c.name:o.name,f={winner:e,reason:t,timing:"".concat(b,"/").concat(O),playerColor:i,PC:v,gameVariant:l,movesHistory:a,boardSize:p,date:new Date},T.next=21,Object(xe.c)({type:fe.a.SAVE_GAME_RESULT,payload:f});case 21:return j={movesMainLine:a,lastMove:{index:a.length-1,move:a.slice(-1)[0]}},T.next=24,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:j});case 24:return h=Object(Z.a)(Object(Z.a)({},$),{},{gameMode:"isOver"}),T.next=27,Object(xe.c)({type:X.a.SET_GAME,payload:h});case 27:case"end":return T.stop()}}),Ge)}function qe(e){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.c)({type:X.a.SET_GAME_STARTED,payload:!1});case 2:return e.next=4,Object(xe.c)({type:X.a.SET_GAME_MODE,payload:"isOver"});case 4:case"end":return e.stop()}}),Be)}function Ze(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.e)(X.a.END_GAME,Ye);case 2:return e.next=4,Object(xe.e)(X.a.MAKE_MOVE,Ke);case 4:return e.next=6,Object(xe.e)(X.a.SURRENDER,He);case 6:return e.next=8,Object(xe.e)(X.a.CANCEL_GAME,qe);case 8:return e.next=10,Object(xe.e)(X.a.NEW_GAME_VS_PLAYER,Ue);case 10:return e.next=12,Object(xe.e)(X.a.NEW_GAME_VS_PC,ze);case 12:case"end":return e.stop()}}),Ve)}var Je=we.a.mark(et),Xe=we.a.mark(tt),$e=we.a.mark(nt);function et(e){var t,n;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:if(t=e.sent,"PC"!==(n=t.gameOptions.rivalType)){e.next=9;break}return e.next=7,Object(xe.c)({type:X.a.NEW_GAME_VS_PC});case 7:e.next=13;break;case 9:if("player"!==n){e.next=13;break}return console.log("player"),e.next=13,Object(xe.c)({type:X.a.NEW_GAME_VS_PLAYER});case 13:case"end":return e.stop()}}),Je)}function tt(e){return we.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("international"!==e.payload){t.next=7;break}return t.next=3,Object(xe.c)({type:me.a.SET_BOARD_SIZE,payload:10});case 3:return t.next=5,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:{currentPosition:Object(he.c)(10)}});case 5:t.next=11;break;case 7:return t.next=9,Object(xe.c)({type:me.a.SET_BOARD_SIZE,payload:8});case 9:return t.next=11,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:{currentPosition:Object(he.c)(8)}});case 11:case"end":return t.stop()}}),Xe)}function nt(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.e)(ee.a.FIND_RIVAL,et);case 2:return e.next=4,Object(xe.e)(ee.a.SET_GAME_VARIANT,tt);case 4:case"end":return e.stop()}}),$e)}var rt=we.a.mark(it),at=we.a.mark(st),ot=we.a.mark(ut),ct=we.a.mark(lt);function it(){var e,t,n,r,a,o,c,i;return we.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(xe.d)();case 2:if(e=s.sent,t=e.game,n=t.gameStarted,r=t.gameConfirmed,a=t.moveOrder,o=e.clock,c=o.whiteClock,i=o.blackClock,r&&n){s.next=12;break}return s.abrupt("return");case 12:if(!(c.timeToGame<=0||i.timeToGame<=0)){s.next=16;break}return s.next=15,Object(xe.c)({type:X.a.END_GAME,payload:"outOfTime"});case 15:return s.abrupt("return");case 16:return s.next=18,Object(xe.b)(O.f);case 18:if(a.pieceOrder!==J.b.w){s.next=23;break}return s.next=21,Object(xe.c)({type:se});case 21:s.next=25;break;case 23:return s.next=25,Object(xe.c)({type:ue});case 25:case"end":return s.stop()}}),rt)}function st(e){var t,n,r;return we.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(xe.d)();case 2:if(t=a.sent,n=t.gameOptions.rivalType,r=t.game.gameConfirmed,"isPlaying"!==e.payload||"PC"===n){a.next=13;break}if(!r){a.next=11;break}return a.next=9,Object(xe.c)({type:se});case 9:a.next=13;break;case 11:return a.next=13,Object(xe.c)({type:be});case 13:case"end":return a.stop()}}),at)}function ut(e){var t,n,r,a,o,c,i,s;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:if(t=e.sent,n=t.clock,r=n.blackClock,a=n.whiteClock,o=t.game,c=o.gameMode,i=o.gameConfirmed,"isPlaying"===c&&!i){e.next=11;break}return e.abrupt("return");case 11:if(!(a.timeToFirstMove<=0||r.timeToFirstMove<=0)){e.next=17;break}return e.next=14,Object(xe.c)({type:X.a.CANCEL_GAME});case 14:return e.next=16,Object(xe.c)({type:fe.a.SAVE_GAME_RESULT,payload:{}});case 16:return e.abrupt("return");case 17:return e.next=19,Object(xe.b)(O.f);case 19:return e.next=21,Object(xe.d)();case 21:if(s=e.sent,s.game.moveOrder.pieceOrder!==J.b.b){e.next=28;break}return e.next=26,Object(xe.c)({type:Oe});case 26:e.next=30;break;case 28:return e.next=30,Object(xe.c)({type:be});case 30:case"end":return e.stop()}}),ot)}function lt(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.e)(X.a.SET_GAME_MODE,st);case 2:return e.next=4,Object(xe.e)(be,ut);case 4:return e.next=6,Object(xe.e)(Oe,ut);case 6:return e.next=8,Object(xe.e)(ue,it);case 8:return e.next=10,Object(xe.e)(se,it);case 10:case"end":return e.stop()}}),ct)}var dt=n(17),bt=we.a.mark(gt),Ot=we.a.mark(At),pt=we.a.mark(wt),vt=we.a.mark(xt),ft=we.a.mark(St),jt=we.a.mark(Mt),ht=we.a.mark(kt),Tt=we.a.mark(Pt),Et=we.a.mark(Rt),mt=we.a.mark(Dt),yt=we.a.mark(It),_t=we.a.mark(Ct);function gt(e){var t,n,r,a,o,c,i,s,u,l,d,b,O,p;return we.a.wrap((function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,Object(xe.d)();case 2:if(t=v.sent,n=t.analyze,r=t.board.positionsTree,o=(a=n).movesCurrentLine,c=a.movesMainLine,i=a.lastMove,s=e.payload,u=s.moveToSave,l=u.move,d=u.position,c[i.index]!==i.move||c.length!==i.index+1){v.next=15;break}return b={move:l,index:i.index+1},O="".concat(null===c||void 0===c?void 0:c.join("_"),"_").concat(l),r.set(O,d),v.next=13,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:b,positionsTree:r,movesMainLine:null===c||void 0===c?void 0:c.push(l)})});case 13:v.next=34;break;case 15:if(!(c[i.index]===i.move&&c.length>i.index+1)){v.next=26;break}return b={move:l,index:i.index+1},O="".concat(null===c||void 0===c?void 0:c.join("_"),"_").concat(l),r.set(O,d),p=[].concat(Object(dt.a)(c.slice(0,i.index+1)),[i.move]),v.next=22,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:b,movesCurrentLine:p})});case 22:return v.next=24,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{positionsTree:r}});case 24:v.next=34;break;case 26:if(o.slice(-1)[0]!==i.move){v.next=34;break}return b={move:l,index:i.index+1},O="".concat(null===o||void 0===o?void 0:o.join("_"),"_").concat(l),r.set(O,d),v.next=32,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:b,movesCurrentLine:null===o||void 0===o?void 0:o.push(l)})});case 32:return v.next=34,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{positionsTree:r}});case 34:case"end":return v.stop()}}),bt)}function At(e){var t,n,r,a,o,c,i,s,u,l,d;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:return t=e.sent,n=t.analyze,r=t.board.positionsTree,o=(a=n).movesCurrentLine,c=a.movesMainLine,i=a.lastMove,s=a.pieceOrder,i.index<0?(d=c[0],u={index:0,move:d},l=null===r||void 0===r?void 0:r.get(d)):c[i.index]===i.move&&i.index<c.length-1?(u={move:c[i.index+1],index:i.index+1},l=r.get(c.slice(0,u.index+1).join("_"))):o[i.index]===i.move&&i.index<o.length-1&&(u={move:o[i.index+1],index:i.index+1},l=r.get(o.slice(0,u.index+1).join("_"))),e.next=9,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:u,pieceOrder:Object(Se.j)(s)})});case 9:return e.next=11,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:l}});case 11:case"end":return e.stop()}}),Ot)}function wt(e){var t,n,r,a,o,c,i,s,u,l,d,b,O,p,v,f,j,h;return we.a.wrap((function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,Object(xe.d)();case 2:return t=T.sent,n=t.analyze,r=t.boardOptions,a=t.board,o=a.positionsTree,c=a.cellsMap,i=a.cellSize,u=(s=n).movesCurrentLine,l=s.movesMainLine,d=e.payload,b=d.index,O=d.move,b<0?p=Object(he.e)(r.boardSize):l[b]===O?(p=o.get(l.slice(0,b+1).join("_")),console.log(o,l.slice(0,b+1).join("_"),p)):u[b]===O&&(p=o.get(u.slice(0,b+1).join("_"))),j=ke.a.updateTowersToBoard(p),j=ke.a.updateTowersPosition(i,j,c,r.reversedBoard),f=b%2?J.b.w:J.b.b,v=e.payload,h={lastMove:v,pieceOrder:f},T.next=19,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:h});case 19:return T.next=21,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:p,towers:j}});case 21:case"end":return T.stop()}}),pt)}function xt(e){var t,n,r,a,o,c,i,s,u,l,d,b,p,v,f,j,h;return we.a.wrap((function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,Object(xe.d)();case 2:return t=T.sent,n=t.analyze,r=t.board,a=r.positionsTree,o=r.cellSize,c=r.cellsMap,i=t.boardOptions.reversedBoard,u=(s=n).movesCurrentLine,l=s.movesMainLine,d=s.lastMove,b=s.pieceOrder,f=d.index+1,d.index<0?(p={move:l[0],index:0},v=a.get(l[0])):l[d.index]===d.move?(p={move:l[d.index+1],index:d.index+1},v=a.get(l.slice(0,p.index+1).join("_"))):u[d.index]===d.move?(p={move:u[d.index+1],index:d.index+1},v=a.get(u.slice(0,p.index+1).join("_"))):console.error(n,e),j=ke.a.updateTowersToBoard(v),j=ke.a.updateTowersPosition(o,j,c,i),h=Object(Se.l)(p.move),T.next=17,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:v,towers:j,lastMoveSquares:h}});case 17:return T.next=19,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:p,pieceOrder:Object(Se.j)(b)})});case 19:if(!(f<l.length-1||f<u.length-1)){T.next=24;break}return T.next=22,Object(xe.b)(O.a);case 22:return T.next=24,Object(xe.c)({type:fe.a.PLAY_MOVES});case 24:case"end":return T.stop()}}),vt)}function St(e){var t,n,r,a,o,c,i,s,u,l,d;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:if(t=e.sent,n=t.analyze,r=t.board.positionsTree,o=(a=n).movesCurrentLine,c=a.movesMainLine,i=a.lastMove,s=a.pieceOrder,!(i.index<0)){e.next=8;break}return e.abrupt("return");case 8:return c[i.index]===i.move&&i.index>0?(u={move:c[i.index-1],index:i.index-1},l=r.get(c.slice(0,u.index+1).join("_"))):o[i.index]===i.move&&i.index>0&&(u={move:o[i.index-1],index:i.index-1},l=r.get(o.slice(0,u.index+1).join("_"))),d=Object(Se.l)(u.move),e.next=12,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:l,lastMoveSquares:d}});case 12:return e.next=14,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},n),{},{lastMove:u,pieceOrder:Object(Se.j)(s)})});case 14:case"end":return e.stop()}}),ft)}function Mt(e){var t,n,r;return we.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(xe.d)((function(e){return e}));case 2:if(t=a.sent,n=t.boardOptions.boardSize,!e.payload){a.next=8;break}return r=Object(he.c)(n),a.next=8,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:Object(Z.a)(Object(Z.a)({},je),{},{board:r,currentPosition:r})});case 8:case"end":return a.stop()}}),jt)}function kt(e){var t;return we.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(xe.d)((function(e){return e}));case 2:if(t=n.sent,!t.analyze.settingPosition||!e.payload){n.next=7;break}return n.next=7,Object(xe.c)({type:fe.a.SETTING_BOARD,payload:!1});case 7:case"end":return n.stop()}}),ht)}function Pt(e){var t,n,r,a,o,c,i,s,u,l,d,b,O,p;return we.a.wrap((function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,Object(xe.d)();case 2:if(t=v.sent,n=t.analyze,r=n.lastMove.index,a=n.movesCurrentLine,o=n.pieceOrder,c=t.board.positionsTree,i=e.payload,s=i.moveToSave,u=s.move,l=s.position,d={},a[r+1]!==u){v.next=16;break}return v.next=13,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:l}});case 13:d={lastMove:{move:u,index:r+1},pieceOrder:Object(Se.j)(o)},v.next=23;break;case 16:return b=[].concat(Object(dt.a)(a.slice(0,r+1)),[u]),O=Object(Se.e)(c),p=b.join("_"),O.set(p,l),v.next=22,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{positionsTree:O,currentPositoin:l}});case 22:d={lastMove:{move:u,index:r+1},pieceOrder:Object(Se.j)(o),movesCurrentLine:b};case 23:return v.abrupt("return",d);case 24:case"end":return v.stop()}}),Tt)}function Rt(e){var t,n,r,a,o,c,i,s,u,l,d,b,O,p,v;return we.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,Object(xe.d)();case 2:return t=f.sent,n=t.analyze,r=n.lastMove.index,a=n.movesMainLine,o=n.pieceOrder,c=t.board.positionsTree,i=e.payload,s=i.moveToSave,u=s.move,l=s.position,d={},f.next=12,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{currentPosition:l}});case 12:if(a.length){f.next=20;break}return d={lastMove:{move:u,index:0},pieceOrder:Object(Se.j)(o),movesMainLine:[u]},(b=Object(Se.e)(c)).set(u,l),f.next=18,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{positionsTree:b,history:[u],currentPosition:l}});case 18:f.next=31;break;case 20:if(a[r+1]!==u){f.next=24;break}d={lastMove:{move:u,index:r+1},pieceOrder:Object(Se.j)(o)},f.next=31;break;case 24:return O=a.slice(0,r+1).concat(u),p=Object(Se.e)(c),v=O.join("_"),p.set(v,l),d={lastMove:{move:u,index:r+1},pieceOrder:Object(Se.j)(o),movesMainLine:[].concat(Object(dt.a)(a),[u])},f.next=31,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{positionsTree:p,currentPosition:l,history:O}});case 31:return f.abrupt("return",d);case 32:case"end":return f.stop()}}),Et)}function Dt(e){var t,n,r,a,o,c;return we.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(xe.d)((function(e){return e.analyze}));case 2:if(t=i.sent,n=t.lastMove,r=n.move,a=n.index,o=t.movesCurrentLine,c={},!o.length||o[a]!==r){i.next=14;break}return i.next=11,Pt(e);case 11:c=i.sent,i.next=17;break;case 14:return i.next=16,Rt(e);case 16:c=i.sent;case 17:if(!c.lastMove){i.next=20;break}return i.next=20,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:c});case 20:case"end":return i.stop()}}),mt)}function It(e){var t,n,r,a,o,c;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)((function(e){return e}));case 2:return t=e.sent,n=t.boardOptions.boardSize,r=t.board.positionsTree,e.next=7,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:{startPosition:!1}});case 7:return a=Object(he.e)(n),r.clear(),r.set("sp",a),o=Object(he.b)(n),e.next=13,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,paylaod:{currentPosition:a,positionsTree:r,towers:o}});case 13:return c=Object(Z.a)(Object(Z.a)({},je),{},{startPosition:!0}),e.next=16,Object(xe.b)(100);case 16:return e.next=18,Object(xe.c)({type:fe.a.UPDATE_ANALYSIS_STATE,payload:c});case 18:case"end":return e.stop()}}),yt)}function Ct(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.e)(fe.a.STEP_BACK,St);case 2:return e.next=4,Object(xe.e)(fe.a.STEP_FORWARD,At);case 4:return e.next=6,Object(xe.e)(fe.a.GO_TO_POSITION,wt);case 6:return e.next=8,Object(xe.e)(fe.a.UPDATE_POSITION,gt);case 8:return e.next=10,Object(xe.e)(fe.a.PLAY_MOVES,xt);case 10:return e.next=12,Object(xe.e)(fe.a.SETTING_BOARD,Mt);case 12:return e.next=14,Object(xe.e)(fe.a.ANALYZE_LAST_GAME,kt);case 14:return e.next=16,Object(xe.e)(fe.a.MAKE_NEW_MOVE,Dt);case 16:return e.next=18,Object(xe.e)(fe.a.SET_START_POSITION,It);case 18:case"end":return e.stop()}}),_t)}var Nt=we.a.mark(Ht),Lt=we.a.mark(Qt),Gt=we.a.mark(qt),Bt=we.a.mark(Zt),Vt=we.a.mark(Jt),Ut=we.a.mark(Xt),zt=we.a.mark($t),Ft=we.a.mark(en),Wt=we.a.mark(tn),Kt=we.a.mark(nn),Yt=we.a.mark(rn);function Ht(e){var t,n,r;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:return t=e.sent,n=t.boardOptions,r=Object(he.f)({boardOptions:n}),e.next=7,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:r});case 7:case"end":return e.stop()}}),Nt)}function Qt(){var e,t,n;return we.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(xe.d)();case 2:return e=r.sent,t=e.boardOptions,n=Object(he.d)({boardOptions:t}),r.next=7,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:n});case 7:case"end":return r.stop()}}),Lt)}function qt(e){var t,n,r;return we.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(xe.d)();case 2:if(t=a.sent,n=t.boardOptions,r="international"===e.payload?10:8,n.boardSize===r){a.next=8;break}return a.next=8,Object(xe.c)({type:Te.a.UPDATE_BOARD_SIZE,payload:r});case 8:case"end":return a.stop()}}),Gt)}function Zt(e){var t,n,r;return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.d)();case 2:return t=e.sent,n=t.boardOptions,r=Object(Z.a)({},Object(he.a)({boardOptions:n})),e.next=7,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:r});case 7:case"end":return e.stop()}}),Bt)}function Jt(e){var t,n,r,a,o,c,i,s,u;return we.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Object(xe.d)();case 2:return t=l.sent,n=t.board,r=t.boardOptions.reversedBoard,a=e.moveToSave,o=a.move.split("-"),c=Object(m.a)(o,2),i=c[0],s=c[1],ke.a.relocateTower(i,s,n,r),l.next=10,Object(xe.b)(O.a);case 10:return l.next=12,Object(xe.d)();case 12:u=l.sent,ke.a.finalizeSimpleMove(i,s,u.board,r);case 14:case"end":return l.stop()}}),Vt)}function Xt(e){var t,n,r,a,o,c,i,s,u,l,d,b,p,v,f,j,h,T=arguments;return we.a.wrap((function(E){for(;;)switch(E.prev=E.next){case 0:return t=T.length>1&&void 0!==T[1]?T[1]:0,E.next=3,Object(xe.d)();case 3:return n=E.sent,r=n.gameOptions.reversedBoard,a=n.board,o=e.moveToSave,c=o.move,i=o.position,s=o.takenPieces,u=c.split(":").slice(t),l=Object(m.a)(u,2),d=l[0],b=l[1],p=s.length,v=s[t],f=i[v].tower,ke.a.relocateTower(d,b,a,r),E.next=14,Object(xe.b)(O.a/p/2);case 14:return E.next=16,Object(xe.d)();case 16:return j=E.sent,h=Object(Se.e)(j.board.towers),f?((f=new J.c(f)).onBoardPosition=v,f.positionInDOM=ke.a.calcTowerPosition(v,a.cellsMap,a.cellSize,r),h.set(v,f)):h.delete(v),E.next=21,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{towers:h}});case 21:return E.next=23,Object(xe.b)(O.a/p/2);case 23:return E.next=25,Object(xe.d)();case 25:return j=E.sent,h=ke.a.finalizeMandatoryMoveStep(d,b,j.board,r),E.next=29,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{towers:h}});case 29:case"end":return E.stop()}}),Ut)}function $t(e){var t,n,r,a,o,c,i,s,u,l,d,b,p,v,f,j,h,T,E=arguments;return we.a.wrap((function(y){for(;;)switch(y.prev=y.next){case 0:return t=E.length>1&&void 0!==E[1]?E[1]:0,y.next=3,Object(xe.d)();case 3:if(n=y.sent,r=n.gameOptions,a=r.gameVariant,o=r.reversedBoard,c=n.board,"towers"!==a){y.next=13;break}return y.next=11,Xt(e,t);case 11:y.next=34;break;case 13:return i=e.moveToSave,s=i.move,u=i.takenPieces,l=s.split(":").slice(t),d=Object(m.a)(l,2),b=d[0],p=d[1],v=u.length,f=v===t+1,ke.a.relocateTower(b,p,c,o),y.next=20,Object(xe.b)(O.a/v);case 20:return y.next=22,Object(xe.d)();case 22:return j=y.sent,h=ke.a.finalizeMandatoryMoveStep(b,p,j.board,o,f),y.next=26,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{towers:h}});case 26:if(!f){y.next=34;break}return y.next=29,Object(xe.d)();case 29:return j=y.sent,T=Object(Se.e)(j.board.towers),u.forEach((function(e){T.delete(e)})),y.next=34,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:{towers:T}});case 34:case"end":return y.stop()}}),zt)}function en(e){var t,n,r=arguments;return we.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.length>1&&void 0!==r[1]?r[1]:0,1!==(null===(n=e.moveToSave.takenPieces)||void 0===n?void 0:n.length)&&(null===n||void 0===n?void 0:n.length)!==t+1){a.next=7;break}return a.next=5,$t(e,t);case 5:a.next=11;break;case 7:return a.next=9,$t(e,t);case 9:return a.next=11,en(e,t+1);case 11:case"end":return a.stop()}}),Ft)}function tn(e){var t,n,r,a,o,c,i,s,u,l,d,b,O;return we.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.payload,p.next=3,Object(xe.d)();case 3:if(n=p.sent,r=n.game.history,a=n.user.name,o=n.board,c=t.moveToSave,i=c.move,s=c.position,u=t.moveOrder,l=r.length?"".concat(r.join("_"),"_").concat(i):i,(d=Object(Se.e)(o.positionsTree)).set(l,s),b=o.lastMoveSquares,u.playerTurn!==a){p.next=22;break}if(!i.includes(":")){p.next=19;break}return b=i.split(":"),p.next=17,en(t);case 17:p.next=22;break;case 19:return b=i.split("-"),p.next=22,Jt(t);case 22:return O={currentPosition:s,positionsTree:d,lastMoveSquares:b},p.next=25,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:O});case 25:return p.next=27,Object(xe.c)({type:X.a.MAKE_MOVE,payload:t});case 27:case"end":return p.stop()}}),Wt)}function nn(){var e,t,n,r,a,o,c,i,s,u,l,d,b,O,p,v,f,j,h,T,E;return we.a.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Object(xe.d)();case 2:if(e=m.sent,t=e.board,n=t.positionsTree,r=t.cellSize,a=t.cellsMap,o=e.game,c=o.history,i=o.moveOrder.pieceOrder,s=o.playerColor,u=e.user.name,l=e.boardOptions.reversedBoard,c.length){m.next=15;break}return m.abrupt("return");case 15:return i===s?(d={history:c.slice(0,-2)},p=n.get(d.history.join("_")),v=ke.a.updateTowersToBoard(p),f=ke.a.updateTowersPosition(r,v,a,l),b={lastMoveSquares:Object(Se.l)((null===(O=d.history)||void 0===O?void 0:O.slice(-1)[0])||""),currentPosition:p,towers:f,animationStarted:!1}):(d={history:c.slice(0,-1),moveOrder:{pieceOrder:Object(he.h)(i),playerTurn:u}},h=n.get(d.history.join("_")),T=ke.a.updateTowersToBoard(h),E=ke.a.updateTowersPosition(r,T,a,l),b={lastMoveSquares:Object(Se.l)((null===(j=d.history)||void 0===j?void 0:j.slice(-1)[0])||""),currentPosition:n.get(d.history.join("_")),towers:E,animationStarted:!1}),m.next=18,Object(xe.c)({type:X.a.UPDATE_GAME_STATE,payload:d});case 18:return m.next=20,Object(xe.c)({type:Te.a.UPDATE_BOARD_STATE,payload:b});case 20:case"end":return m.stop()}}),Kt)}function rn(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.e)(Te.a.CREATE_SETUP_BOARD,Qt);case 2:return e.next=4,Object(xe.e)(Te.a.CREATE_GAME_BOARD,Ht);case 4:return e.next=6,Object(xe.e)(Te.a.CREATE_ANALYSIS_BOARD,Zt);case 6:return e.next=8,Object(xe.e)(ee.a.SET_GAME_VARIANT,qt);case 8:return e.next=10,Object(xe.e)(Te.a.TURN,tn);case 10:return e.next=12,Object(xe.e)(Te.a.UNDO_LAST_MOVE,nn);case 12:case"end":return e.stop()}}),Yt)}var an=we.a.mark(on);function on(){return we.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(xe.a)([nt(),Ze(),lt(),Ct(),rn()]);case 2:case"end":return e.stop()}}),an)}var cn=Object(Q.a)(),sn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=Object(q.composeWithDevTools)(Object(H.applyMiddleware)(cn)),n=Object(H.combineReducers)(ge),r=Object(H.createStore)(n,e,t);return cn.run(on),r},un=(n(75),sn(_e));if(c.a.render(Object(d.jsx)(v.a,{store:un,children:Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(K,{})})}),document.getElementById("root")),un.dispatch({type:x}),window){var ln=window.innerWidth/window.innerHeight<1.3;un.dispatch({type:V,payload:ln})}Y()}],[[76,2,3]]]);
//# sourceMappingURL=main.ff75040f.chunk.js.map
